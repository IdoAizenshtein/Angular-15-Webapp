<section class="header">
    <!--    <div class="company_name">-->

    <!--        <div>-->
    <!--            <h3 class="titlePage">{{userService.appData?.userData?.companySelect?.companyName}}</h3>-->
    <!--        </div>-->
    <!--    </div>-->
    <div class="other_titles">
        <div [class.showSplit]="showSplit" class="fixed-part">
            <mat-icon
                    (click)="
          goToRow.emit({
            refresh: fileChange,
            response: _fileScanView?.fileId
          })
        "
                    *ngIf="!showSplit"
                    style="
          margin-right: 15px;
          margin-left: 16px;
          cursor: pointer;
          width: 18px;
          height: 18px;
          display: block;
          transform: rotate(180deg);
          align-self: center;
          margin-top: 0px;
        "
                    svgIcon="arrowBack"
            ></mat-icon>

            <div *ngIf="!showSplit" class="showEmptyFields">
                <p>הצגת שדות לטיפול</p>

                <label class="switchBtn">
                    <input [formControl]="showEmptyFields" type="checkbox"/>
                    <span class="slider round"></span>
                </label>
            </div>
            <!--            <div *ngIf="!showSplit"-->
            <!--                 style="margin-right: 15px;-->
            <!--    margin-left: 16px;-->
            <!--    width: 18px;-->
            <!--    height: 18px;-->
            <!--    align-self: flex-start;-->
            <!--"></div>-->
            <!--        <div>-->
            <!--&lt;!&ndash;            <mat-icon [class.error]="true"&ndash;&gt;-->
            <!--&lt;!&ndash;                      style="    display: block;&ndash;&gt;-->
            <!--&lt;!&ndash;    color: #df0000;&ndash;&gt;-->
            <!--&lt;!&ndash;    font-size: 20px;&ndash;&gt;-->
            <!--&lt;!&ndash;    margin-bottom: 2px;&ndash;&gt;-->
            <!--&lt;!&ndash;    cursor: pointer;&ndash;&gt;-->
            <!--&lt;!&ndash;    width: auto;&ndash;&gt;-->
            <!--&lt;!&ndash;    height: auto;&ndash;&gt;-->
            <!--&lt;!&ndash;    margin-left: 5px;&ndash;&gt;-->
            <!--&lt;!&ndash;    line-height: normal;"&ndash;&gt;-->
            <!--                      [matTooltip]="'ח.פ של החברה לא נמצא בחשבונית'"-->
            <!--                      matTooltipPosition="below">report_problem-->
            <!--&lt;!&ndash;            </mat-icon>&ndash;&gt;-->
            <!--        </div>-->

            <!--            <div>-->
            <!--                <h4 class="titlePage">-->
            <!--                    ח.פ./ע.מ. {{userService.appData?.userData?.companySelect?.companyHp}}</h4>-->
            <!--            </div>-->
            <ng-container *ngIf="userService.appData?.isAdmin">
                <ng-container *ngIf="fileDetailsSave?.jobExecutionId">
                    <a
                            [href]="'/ocr-docs/' + fileDetailsSave.jobExecutionId | toEtlUrl"
                            mat-icon-button
                            target="_blank"
                    >
                        <mat-icon>open_in_new</mat-icon>
                    </a>
                </ng-container>
            </ng-container>
        </div>

        <ng-container
                *ngIf="{
        currentPage: (currentPage | async),
        pages: (fileDetails$ | async)?.pages
      } as pagesNavData"
        >
            <div
                    *ngIf="pagesNavData.pages?.length"
                    [class.isShowSplit]="showSplit"
                    class="pages-navigator header-nav-pages"
            >
                <!--      {{pagesNavData.currentPage}} / {{pagesNavData.pages?.length}}-->
                <label style="padding-left: 5px"><b>דף:</b></label>
                <label class="forceLTR" style="padding-left: 7px"
                ><b>{{ pagesNavData.currentPage }}</b
                >/{{ pagesNavData.pages.length }}</label
                >
                <button
                        (click)="navigateToDocumentPage(pagesNavData.currentPage + 1)"
                        [disabled]="pagesNavData.currentPage >= pagesNavData.pages.length"
                        mat-icon-button
                >
                    <mat-icon>expand_more</mat-icon>
                </button>
                <button
                        (click)="navigateToDocumentPage(pagesNavData.currentPage - 1)"
                        [disabled]="pagesNavData.currentPage < 2"
                        mat-icon-button
                >
                    <mat-icon>expand_less</mat-icon>
                </button>
            </div>
        </ng-container>
    </div>
</section>

<section #content class="content" style="position: relative">
    <div *ngIf="!showSplit" class="fixed-part">
        <div class="wrap-scroll">
            <ng-scrollbar
                #scrollbarCompanies
                (updated)="onScroll(scrollbarCompanies, false)"
                [ngStyle]="{'height': (window.innerHeight - ( content.getBoundingClientRect().top + footer.getBoundingClientRect().height)) +'px'}"
                class="custom-scrollbar"
                thumbClass="scrollbar-thumb"
                trackClass="scrollbar">
                <div
                    #fieldsList
                >
                    <ng-container *ngIf="showDoubleSuspect && !showSplit">
                        <div (click)="doubleSuspect()" class="doubleSuspect">
                            <div>
                                <img fill ngSrc="/assets/images/doubleSuspect.png"
                                     style="height: auto; width: auto; position: relative;"/>
                                <p>לחצו להשוואת חשבוניות</p>
                            </div>
                        </div>
                    </ng-container>

                    <div *ngIf="showAlertHideAllFields" class="showAlertHideAllFields">
                        אין שדות לטיפול
                    </div>

                    <mat-list *ngIf="fileDetailsSave && fileDetailsSave.fieldsHierarchy; else loaderPercent">
                        <ng-container
                                *ngFor="
              let cat of fileDetailsSave.fieldsHierarchy;
              first as isFirst;
              index as i;
              trackBy: trackCategory
            "
                        >
                            <div
                                    *ngIf="
                !cat.hide &&
                ((cat.category !== 'נתוני קבלה' &&
                  cat.category !== 'נתוני קבלה (זיכוי כספי)') ||
                  ((cat.category === 'נתוני קבלה' ||
                    cat.category === 'נתוני קבלה (זיכוי כספי)') &&
                    fileDetailsSave.invoicePayment !== null))
              "
                                    [class.optional-category-header]="cat.category === 'שדות נוספים'"
                                    class="category-header"
                                    matSubheader
                                    style="display: block"
                            >
                                <div
                                        *ngIf="!isFirst"
                                        style="
                  height: 1px;
                  background: #dadada;
                  width: 100%;
                  margin-bottom: 15px;
                "
                                ></div>
                                {{ cat.category }}
                                <ng-container *ngIf="cat.category === 'נתוני מסמך'">
                                    <ng-container
                                            *ngIf="
                    fileFieldsForm
                      .get('8')
                      ?.get('effectiveValue') as ocrAccuracyCntrl
                  "
                                    >
                                        <small
                                                *ngIf="ocrAccuracyCntrl.valid && ocrAccuracyCntrl.value"
                                        >>דיוק סריקה {{ ocrAccuracyCntrl.value }}%</small
                                        >
                                    </ng-container>
                                </ng-container>
                                <ng-container *ngIf="cat.category === 'שדות נוספים'">
                                    <button
                                            (click)="
                    cat.collapsed = !cat.collapsed; scrollToBottom(fieldsList)
                  "
                                            mat-icon-button
                                    >
                                        <mat-icon>{{
                                            'keyboard_arrow_' + (cat.collapsed ? 'down' : 'up')
                                            }}</mat-icon>
                                    </button>
                                </ng-container>
                            </div>
                            <mat-list-item
                                    *ngIf="
                !cat.hide &&
                !showAlertHideAllFields &&
                (cat.category === 'נתוני קבלה' ||
                  cat.category === 'נתוני קבלה (זיכוי כספי)') &&
                fileDetailsSave.invoicePayment !== null
              "
                                    class="doc-field-form"
                            >
                                <div matLine>
                                    <i
                                            style="
                    width: 1em;
                    height: 1em;
                    margin-left: 0.45em;
                    cursor: pointer;
                  "
                                    ></i>
                                    <span style="display: inline-block">כולל קבלה</span>

                                    <p-checkbox [binary]="true"
                                                [formControl]="invoicePayment"
                                                checkboxIcon="fa fa-check"
                                    ></p-checkbox>
                                </div>
                            </mat-list-item>
                            <ng-container
                                    *ngIf="
                !cat.hide &&
                (cat.category !== 'שדות נוספים' || !cat.collapsed) &&
                ((cat.category !== 'נתוני קבלה' &&
                  cat.category !== 'נתוני קבלה (זיכוי כספי)') ||
                  ((cat.category === 'נתוני קבלה' ||
                    cat.category === 'נתוני קבלה (זיכוי כספי)') &&
                    fileDetailsSave.invoicePayment !== null &&
                    invoicePayment.value))
              "
                            >
                                <ng-container
                                        *ngFor="
                  let fld of cat.fields;
                  first as isFirst;
                  last as isLast;
                  let idxFl = index;
                  trackBy: trackField
                "
                                >
                                    <ng-container
                                            *ngIf="
                    !fld.hide &&
                    fld.fieldId !== 24 &&
                    fld.fieldId !== 26 &&
                    fld.fieldId !== 27 &&
                    fld.fieldId !== 29
                  "
                                    >
                                        <mat-list-item
                                            #fieldListItem
                                            (click)="(fileDetailsSave.matahSums && fld.fieldId === 16) ? null :
                      setActiveField(
                        fld,
                        fieldListItem._getHostElement(),
                        fileFieldsForm.get(fld.fieldId + '')
                      )
                    "
                                            (keydown.Tab)="onKey($event, fld.fieldId)"
                                            [class.active]="
                      (fld.fieldId !== 1 &&
                        (activeField?.field?.fieldId === fld.fieldId ||
                          (activeField?.field?.fieldId === 24 &&
                            fld.fieldId === 17) ||
                                   (activeField?.field?.fieldId === 27 &&
                            fld.fieldId === 16) ||
                          (activeField?.field?.fieldId === 29 &&
                            fld.fieldId === 18))) ||
                      (fld.fieldId === 1 && activeFieldName)
                    "
                                            [class.alertExist]="
                      fld?.fileFldInfo ||
                      (fileFieldsForm.get(fld.fieldId + '') &&
                        fileFieldsForm
                          .get(fld.fieldId + '')
                          .get('effectiveValue').invalid) ||
                      fld.transTypeOv ||
                      (fld.fieldId !== 31 &&
                        fileFieldsForm.get(fld.fieldId + '').invalid &&
                        fileFieldsForm.get(fld.fieldId + '') &&
                        !fileFieldsForm
                          .get(fld.fieldId + '')
                          .get('effectiveValue').value &&
                        !fileFieldsForm.get(fld.fieldId + '').disabled)
                    "
                                            [class.asmachtaRow]="
                      fld.fieldId === 11 ||
                      ((fld.fieldId === 2 ||
                        fld.fieldId === 6 ||
                        fld.fieldId === 30 ||
                        fld.fieldId === 40 ||
                        fld.fieldId === 41 ||
                        fld.fieldId === 21) &&
                        fileDetailsSave.userApproveFieldsType &&
                        !fld.approveUserValue &&
                        fld.fieldValue !== null)
                    "
                                            [class.clean33]="
                      fld.fieldId === 33 &&
                      fileFieldsForm.get('33').get('effectiveValue').value ===
                        null &&
                      fileDetailsSave?.report856
                    "
                                            [class.disabled]="
                      fileFieldsForm.get(fld.fieldId + '')?.disabled &&
                      fld.fieldId !== 28
                    "
                                            [id]="'fieldListItem_' + fld.fieldId"
                                            [tabindex]="
                      fileFieldsForm.get(fld.fieldId + '')?.disabled &&
                      fld.fieldId !== 28
                        ? -1
                        : i
                        ? i + '' + (idxFl + 1)
                        : idxFl
                    "
                                            class="doc-field-form"
                                        >
                                            <div matLine>
                                                <ng-container
                                                        *ngIf="
                          fileFieldsForm.get(
                            fld.fieldId + ''
                          ) as fieldFormGroup;
                          else matDef
                        "
                                                >
                                                    <ng-container [ngSwitch]="fld.fieldId">
                                                        <mat-icon
                                                                *ngSwitchDefault
                                                                [ngClass]="
                              fld?.fileFldInfo
                                ? fld?.fileFldInfo.indBlockAprrove
                                  ? 'error'
                                  : 'warn'
                                : fieldFormGroup.get('effectiveValue').invalid
                                ? 'error'
                                : null
                            "
                                                        >
                                                            report_problem
                                                        </mat-icon>
                                                    </ng-container>
                                                </ng-container>
                                                <ng-template #matDef>
                                                    <mat-icon> report_problem</mat-icon>
                                                </ng-template>

                                                <span
                                                        [class.boldText]="fld.fieldId === 21"
                                                        [class.greenText]="fld.fieldId === 28"
                                                        class="fieldName"
                                                        style="display: inline-block"
                                                >{{ fld.fieldName }}</span
                                                >
                                                <ng-container
                                                        *ngIf="
                          fileFieldsForm.get(fld.fieldId + '') as fieldFormGroup
                        "
                                                >
                                                    <ng-container *ngIf="fld.valueTypeOv; else allRegLogic">
                                                        <div style="margin-right: auto; color: #9e9f9f">
                                                            {{ fld.valueTypeOv }}
                                                        </div>
                                                    </ng-container>
                                                    <ng-template #allRegLogic>
                                                        <ng-template
                                                                [ngTemplateOutletContext]="{
                              field: fld,
                              formControl: fieldFormGroup.get('effectiveValue')
                            }"
                                                                [ngTemplateOutlet]="
                              fieldsWithPredefinedEditData.has(fld.fieldId + '')
                                ? byFieldIdWithPredefined
                                : byFieldType
                            "
                                                        ></ng-template>
                                                    </ng-template>
                                                </ng-container>
                                            </div>

                                            <div
                                                    [ngStyle]="{
                        'justify-content':
                          fld.fieldId === 11 ||
                          fld.fieldId === 28 ||
                          (fld.fieldId === 17 &&
                            fileDetailsSave.matahSums &&
                            fileFieldsForm.get('24') &&
                            !fileFieldsForm.get('24').get('effectiveValue')
                              .value &&
                            !fileFieldsForm.get('24')?.disabled) ||
                          (fld.fieldId === 18 &&
                            fileDetailsSave.matahSums &&
                            fileFieldsForm.get('29') &&
                            !fileFieldsForm.get('29').get('effectiveValue')
                              .value &&
                            !fileFieldsForm.get('29')?.disabled) ||
                          ((fld.fieldId === 2 ||
                            fld.fieldId === 6 ||
                            fld.fieldId === 30 ||
                            fld.fieldId === 40 ||
                            fld.fieldId === 41 ||
                            fld.fieldId === 21) &&
                            fileDetailsSave.userApproveFieldsType &&
                            fld.approveUserValue === null &&
                            fld.fieldValue !== null) ||
                          fld.transTypeOv
                            ? 'space-between'
                            : 'flex-end'
                      }"
                                                    matLine
                                            >
                                                <div
                                                        *ngIf="fld.transTypeOv"
                                                        [class.whiteText]="
                          activeField?.field?.fieldId === fld.fieldId
                        "
                                                        class="alertLine"
                                                        style="
                          margin-right: 22px;
                          text-align: right;
                          color: #022258;
                        "
                                                >
                        <span style="font-weight: 700">
                          נעול בהתאם לסוג תנועה
                        </span>
                                                </div>

                                                <ng-container
                                                        *ngIf="
                          !fld.transTypeOv &&
                          fileFieldsForm.get(fld.fieldId + '') as fieldFormGroup
                        "
                                                >
                                                    <ng-container [ngSwitch]="fld.fieldId">
                                                        <ng-container
                                                                *ngSwitchCase="
                              fld.fieldId === 15 &&
                              ((!fileFieldsForm.get('40') &&
                                fileFieldsForm.get('4') &&
                                (fileFieldsForm.get('4').get('effectiveValue')
                                  .value === 'TWO_THIRD' ||
                                  fileFieldsForm.get('4').get('effectiveValue')
                                    .value === 'QUARTER' ||
                                  fileFieldsForm.get('4').get('effectiveValue')
                                    .value === 'NONE')) ||
                                (fileFieldsForm.get('40') && checkType40()))
                                ? fld.fieldId
                                : false
                            "
                                                        >
                                                            <div
                                                                    [class.whiteText]="
                                activeField?.field?.fieldId === fld.fieldId
                              "
                                                                    class="alertLine"
                                                                    style="padding-right: 21px"
                                                            >
                              <span>
                                בפקודה יופיע

                                <ng-container *ngIf="!fileFieldsForm.get('40')">
                                  <ng-container
                                          *ngIf="
                                      fileFieldsForm
                                        .get('4')
                                        .get('effectiveValue').value ===
                                      'TWO_THIRD'
                                    "
                                  >
                                    מע”מ 2/3
                                  </ng-container>
                                  <ng-container
                                          *ngIf="
                                      fileFieldsForm
                                        .get('4')
                                        .get('effectiveValue').value ===
                                      'QUARTER'
                                    "
                                  >
                                    מע”מ 1/4
                                  </ng-container>
                                  <ng-container
                                          *ngIf="
                                      fileFieldsForm
                                        .get('4')
                                        .get('effectiveValue').value === 'NONE'
                                    "
                                  >
                                    ללא מע”מ
                                  </ng-container>
                                </ng-container>

                                <ng-container *ngIf="fileFieldsForm.get('40')">
                                  <ng-container
                                          *ngIf="
                                      fileFieldsForm
                                        .get('40')
                                        .get('effectiveValue').value ===
                                        'BIZ_TWO_THIRD' ||
                                        fileFieldsForm
                                          .get('40')
                                          .get('effectiveValue').value ===
                                          'BIZ_QUARTER' ||
                                        fileFieldsForm
                                          .get('40')
                                          .get('effectiveValue').value ===
                                          'BIZ_NONE_EXPENSE' ||
                                        fileFieldsForm
                                          .get('40')
                                          .get('effectiveValue').value ===
                                          'BIZ_NONE_INCOME';
                                      else defVal
                                    "
                                  >
                                    <ng-container
                                            *ngIf="
                                        fileFieldsForm
                                          .get('40')
                                          .get('effectiveValue').value ===
                                        'BIZ_TWO_THIRD'
                                      "
                                    >
                                      מע”מ 2/3
                                    </ng-container>
                                    <ng-container
                                            *ngIf="
                                        fileFieldsForm
                                          .get('40')
                                          .get('effectiveValue').value ===
                                        'BIZ_QUARTER'
                                      "
                                    >
                                      מע”מ 1/4
                                    </ng-container>
                                    <ng-container
                                            *ngIf="
                                        fileFieldsForm
                                          .get('40')
                                          .get('effectiveValue').value ===
                                          'BIZ_NONE_EXPENSE' ||
                                        fileFieldsForm
                                          .get('40')
                                          .get('effectiveValue').value ===
                                          'BIZ_NONE_INCOME'
                                      "
                                    >
                                      ללא מע”מ
                                    </ng-container>
                                  </ng-container>
                                  <ng-template #defVal>
                                    <ng-container
                                            *ngIf="checkType40() === 'TWO_THIRD'"
                                    >
                                      מע”מ 2/3
                                    </ng-container>
                                    <ng-container
                                            *ngIf="checkType40() === 'QUARTER'"
                                    >
                                      מע”מ 1/4
                                    </ng-container>
                                    <ng-container
                                            *ngIf="checkType40() === 'NONE'"
                                    >
                                      ללא מע”מ
                                    </ng-container>
                                  </ng-template>
                                </ng-container>
                              </span>
                                                            </div>
                                                            <div
                                                                    *ngIf="
                                fld?.fileFldInfo
                                  ? fld?.fileFldInfo.indBlockAprrove
                                    ? 'error'
                                    : 'warn'
                                  : fieldFormGroup.get('effectiveValue').invalid
                                  ? 'error'
                                  : fld.fieldId !== 31 &&
                                    !fileFieldsForm
                                      .get(fld.fieldId + '')
                                      .get('effectiveValue').value &&
                                    !fileFieldsForm.get(fld.fieldId + '')
                                      ?.disabled
                                  ? true
                                  : null
                              "
                                                                    [class.red]="
                                (fld?.fileFldInfo &&
                                  fld?.fileFldInfo.indBlockAprrove) ||
                                (!fld?.fileFldInfo &&
                                  fieldFormGroup.get('effectiveValue').invalid)
                              "
                                                                    [class.whiteText]="
                                activeField?.field?.fieldId === fld.fieldId ||
                                (activeField?.field?.fieldId === 24 &&
                                  fld.fieldId === 17) ||
                                (activeField?.field?.fieldId === 29 &&
                                  fld.fieldId === 18)
                              "
                                                                    class="alertLine"
                                                            >
                                                                <div class="lineBorder"></div>
                                                                <span
                                                                        *ngIf="
                                  fld?.fileFldInfo
                                    ? fld?.fileFldInfo.indBlockAprrove
                                      ? 'error'
                                      : 'warn'
                                    : fieldFormGroup.get('effectiveValue')
                                        .invalid
                                    ? 'error'
                                    : null
                                "
                                                                        [innerHTML]="
                                  fld?.fileFldInfo
                                    ? fld?.fileFldInfo.alertMessage
                                    : (fieldFormGroup.get('effectiveValue')
                                        .errors | ocrFieldErrorTranslate)
                                "
                                                                ></span>
                                                            </div>
                                                        </ng-container>

                                                        <ng-container
                                                                *ngSwitchCase="
                              fld.fieldId === 11 ? fld.fieldId : false
                            "
                                                        >
                                                            <div
                                                                    [class.whiteText]="
                                activeField?.field?.fieldId === fld.fieldId ||
                                (activeField?.field?.fieldId === 24 &&
                                  fld.fieldId === 17) ||
                                (activeField?.field?.fieldId === 29 &&
                                  fld.fieldId === 18)
                              "
                                                                    class="alertLine"
                                                                    style="padding-right: 21px"
                                                            >
                              <span>
                                לפקודה יעברו
                                  {{
                                  returnAsmachtaDigits(
                                      fileFieldsForm
                                          .get('11')
                                          .get('effectiveValue').value
                                  )
                                  }}
                              </span>
                                                            </div>
                                                            <div
                                                                    *ngIf="
                                fld?.fileFldInfo
                                  ? fld?.fileFldInfo.indBlockAprrove
                                    ? 'error'
                                    : 'warn'
                                  : fieldFormGroup.get('effectiveValue').invalid
                                  ? 'error'
                                  : fld.fieldId !== 31 &&
                                    !fileFieldsForm
                                      .get(fld.fieldId + '')
                                      .get('effectiveValue').value &&
                                    !fileFieldsForm.get(fld.fieldId + '')
                                      ?.disabled
                                  ? true
                                  : null
                              "
                                                                    [class.red]="
                                (fld?.fileFldInfo &&
                                  fld?.fileFldInfo.indBlockAprrove) ||
                                (!fld?.fileFldInfo &&
                                  fieldFormGroup.get('effectiveValue').invalid)
                              "
                                                                    [class.whiteText]="
                                activeField?.field?.fieldId === fld.fieldId ||
                                (activeField?.field?.fieldId === 24 &&
                                  fld.fieldId === 17) ||
                                (activeField?.field?.fieldId === 29 &&
                                  fld.fieldId === 18)
                              "
                                                                    class="alertLine"
                                                            >
                                                                <div class="lineBorder"></div>
                                                                <span
                                                                        *ngIf="
                                  fld?.fileFldInfo
                                    ? fld?.fileFldInfo.indBlockAprrove
                                      ? 'error'
                                      : 'warn'
                                    : fieldFormGroup.get('effectiveValue')
                                        .invalid
                                    ? 'error'
                                    : null
                                "
                                                                        [innerHTML]="
                                  fld?.fileFldInfo
                                    ? fld?.fileFldInfo.alertMessage
                                    : (fieldFormGroup.get('effectiveValue')
                                        .errors | ocrFieldErrorTranslate)
                                "
                                                                ></span>
                                                            </div>
                                                        </ng-container>
                                                        <ng-container
                                                                *ngSwitchCase="
                              fld.fieldId === 28 ? fld.fieldId : false
                            "
                                                        >
                                                            <div
                                                                    [class.whiteText]="
                                activeField?.field?.fieldId === fld.fieldId ||
                                (activeField?.field?.fieldId === 24 &&
                                  fld.fieldId === 17) ||
                                (activeField?.field?.fieldId === 24 &&
                                  fld.fieldId === 18)
                              "
                                                                    class="alertLine"
                                                                    style="padding-right: 21px"
                                                            >
                                                                <span> לטובת זיהוי אוטומטי בעתיד </span>
                                                            </div>
                                                            <div
                                                                    *ngIf="
                                fld?.fileFldInfo
                                  ? fld?.fileFldInfo.indBlockAprrove
                                    ? 'error'
                                    : 'warn'
                                  : fieldFormGroup.get('effectiveValue').invalid
                                  ? 'error'
                                  : fld.fieldId !== 31 &&
                                    !fileFieldsForm
                                      .get(fld.fieldId + '')
                                      .get('effectiveValue').value
                                  ? true
                                  : null
                              "
                                                                    [class.red]="
                                (fld?.fileFldInfo &&
                                  fld?.fileFldInfo.indBlockAprrove) ||
                                (!fld?.fileFldInfo &&
                                  fieldFormGroup.get('effectiveValue').invalid)
                              "
                                                                    [class.whiteText]="
                                activeField?.field?.fieldId === fld.fieldId ||
                                (activeField?.field?.fieldId === 24 &&
                                  fld.fieldId === 17) ||
                                (activeField?.field?.fieldId === 29 &&
                                  fld.fieldId === 18)
                              "
                                                                    class="alertLine"
                                                            >
                                                                <div class="lineBorder"></div>
                                                                <span
                                                                        *ngIf="
                                  fld?.fileFldInfo
                                    ? fld?.fileFldInfo.indBlockAprrove
                                      ? 'error'
                                      : 'warn'
                                    : fieldFormGroup.get('effectiveValue')
                                        .invalid
                                    ? 'error'
                                    : null
                                "
                                                                        [innerHTML]="
                                  fld?.fileFldInfo
                                    ? fld?.fileFldInfo.alertMessage
                                    : (fieldFormGroup.get('effectiveValue')
                                        .errors | ocrFieldErrorTranslate)
                                "
                                                                ></span>
                                                            </div>
                                                        </ng-container>
                                                        <ng-container *ngSwitchDefault>
                                                            <div
                                                                    *ngIf="
                                (fld.fieldId === 2 ||
                                  fld.fieldId === 6 ||
                                  fld.fieldId === 30 ||
                                  fld.fieldId === 40 ||
                                  fld.fieldId === 41 ||
                                  fld.fieldId === 21) &&
                                fileDetailsSave.userApproveFieldsType &&
                                fld.approveUserValue === null &&
                                fld.fieldValue !== null
                              "
                                                                    [class.whiteText]="
                                activeField?.field?.fieldId === fld.fieldId
                              "
                                                                    class="alertLineCartis"
                                                            >
                                                                הוגדר “השאר ריק” ע”י
                                                                {{ fileDetailsSave.approvedBy }},

                                                                <span (click)="cancelCust(fld)" class="link"
                                                                >ביטול</span
                                                                >
                                                            </div>
                                                            <div
                                                                    *ngIf="
                                fld.fieldId === 17 &&
                                fileDetailsSave.matahSums &&
                                !fileFieldsForm.get('24').get('effectiveValue')
                                  .value &&
                                !fileFieldsForm.get('24')?.disabled
                              "
                                                                    [class.red]="
                                fileFieldsForm.get('24').get('effectiveValue')
                                  .invalid
                              "
                                                                    [class.whiteText]="
                                activeField?.field?.fieldId === fld.fieldId
                              "
                                                                    class="alertLine"
                                                                    style="margin-right: 150px"
                                                            >
                                                                <div class="lineBorder"></div>
                                                                <span
                                                                        [innerHTML]="
                                  fileFieldsForm.get('24').get('effectiveValue')
                                    .errors | ocrFieldErrorTranslate
                                "
                                                                ></span>
                                                            </div>
                                                            <div
                                                                    *ngIf="
                                fld.fieldId === 18 &&
                                fileDetailsSave.matahSums &&
                                !fileFieldsForm.get('29').get('effectiveValue')
                                  .value &&
                                !fileFieldsForm.get('29')?.disabled
                              "
                                                                    [class.red]="
                                fileFieldsForm.get('29').get('effectiveValue')
                                  .invalid
                              "
                                                                    [class.whiteText]="
                                activeField?.field?.fieldId === fld.fieldId
                              "
                                                                    class="alertLine"
                                                                    style="margin-right: 150px"
                                                            >
                                                                <div class="lineBorder"></div>
                                                                <span
                                                                        [innerHTML]="
                                  fileFieldsForm.get('29').get('effectiveValue')
                                    .errors | ocrFieldErrorTranslate
                                "
                                                                ></span>
                                                            </div>
                                                            <div
                                                                    *ngIf="
                                fld?.fileFldInfo
                                  ? fld?.fileFldInfo.indBlockAprrove
                                    ? 'error'
                                    : 'warn'
                                  : fieldFormGroup.get('effectiveValue').invalid
                                  ? 'error'
                                  : fld.fieldId !== 31 &&
                                    !fileFieldsForm
                                      .get(fld.fieldId + '')
                                      .get('effectiveValue').value &&
                                    !fileFieldsForm.get(fld.fieldId + '')
                                      ?.disabled &&
                                    fieldFormGroup.get('effectiveValue').invalid
                                  ? true
                                  : null
                              "
                                                                    [class.red]="
                                (fld?.fileFldInfo &&
                                  fld?.fileFldInfo.indBlockAprrove) ||
                                (!fld?.fileFldInfo &&
                                  fieldFormGroup.get('effectiveValue').invalid)
                              "
                                                                    [class.whiteText]="
                                activeField?.field?.fieldId === fld.fieldId
                              "
                                                                    class="alertLine"
                                                            >
                                                                <div class="lineBorder"></div>
                                                                <span
                                                                        *ngIf="
                                  fld?.fileFldInfo
                                    ? fld?.fileFldInfo.indBlockAprrove
                                      ? 'error'
                                      : 'warn'
                                    : fieldFormGroup.get('effectiveValue')
                                        .invalid
                                    ? 'error'
                                    : null
                                "
                                                                        [innerHTML]="
                                  fld?.fileFldInfo
                                    ? fld?.fileFldInfo.alertMessage
                                    : (fieldFormGroup.get('effectiveValue')
                                        .errors | ocrFieldErrorTranslate)
                                "
                                                                ></span>

                                                                <span
                                                                        *ngIf="
                                  !fld?.fileFldInfo &&
                                  !fieldFormGroup.get('effectiveValue').invalid
                                "
                                                                >
                                &nbsp;
                              </span>
                                                            </div>

                                                            <!--                                                        <div class="alertLineCartis"-->
                                                            <!--                                                             [class.whiteText]="(activeField?.field?.fieldId === fld.fieldId)"-->
                                                            <!--                                                             *ngIf="(fld.fieldId === 2 || fld.fieldId === 6) && fld.default">-->
                                                            <!--                                                            שוייך ב- -->
                                                            <!--                                                            {{fld.defaultUpdatedDate| date:'dd/MM/yy'}}-->

                                                            <!--                                                            ע״י-->
                                                            <!--                                                            {{fld.defaultUserName}},-->

                                                            <!--                                                            <span class="link"-->
                                                            <!--                                                                  (click)="cancelCust(fld)">ביטול שיוך</span>-->
                                                            <!--                                                        </div>-->
                                                        </ng-container>
                                                    </ng-container>
                                                </ng-container>
                                            </div>
                                        </mat-list-item>
                                    </ng-container>

                                    <mat-list-item
                                            (click)="
                    fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      0 ||
                    fileFieldsForm.get('21')?.get('effectiveValue').value === 1
                      ? editOrder()
                      : null
                  "
                                            *ngIf="
                    isLast &&
                    cat.category === 'נתוני פקודת יומן' &&
                    !showEmptyFields.value
                  "
                                            [class.disabled]="
                    fileFieldsForm.get('21')?.get('effectiveValue').value !==
                      0 &&
                    fileFieldsForm.get('21')?.get('effectiveValue').value !== 1
                  "
                                            class="doc-field-form editOrder"
                                    >
                                        <div matLine>
                    <span style="font-size: 16px; font-weight: 600">
                      עריכה, פיצול פקודה וצפייה בהיסטוריה
                    </span>
                                        </div>
                                    </mat-list-item>

                                    <mat-list-item
                                            (click)="
                    fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      0 ||
                    fileFieldsForm.get('21')?.get('effectiveValue').value === 1
                      ? editReceipt()
                      : null
                  "
                                            *ngIf="
                    isLast &&
                    (cat.category === 'נתוני קבלה' ||
                      cat.category === 'נתוני קבלה (זיכוי כספי)') &&
                    fileDetailsSave.invoicePayment !== null &&
                    invoicePayment.value
                  "
                                            [class.disabled]="
                    fileFieldsForm.get('21')?.get('effectiveValue').value !==
                      0 &&
                    fileFieldsForm.get('21')?.get('effectiveValue').value !== 1
                  "
                                            class="doc-field-form editOrder"
                                    >
                                        <div matLine>
                                            <span> עריכת/ פיצול קבלה </span>
                                        </div>
                                    </mat-list-item>
                                </ng-container>
                            </ng-container>
                        </ng-container>
                    </mat-list>
                    <ng-template #byFieldType let-fc="formControl" let-fld="field">
                        <!--                        <ng-container *ngIf="fileFieldsForm.get(fld.fieldId + '').get('valueTypeOv').value">-->

                        <!--                        </ng-container>-->
                        <ng-container *ngIf="fc">
                            <ng-container [ngSwitch]="fld['valueType']">
                                <ng-container *ngSwitchCase="'DATE'">
                                    <p-calendar
                                        #formCalendars
                                        *ngIf="fld.fieldId !== 14 && fld.fieldId !== 13"
                                        [dateFormat]="'dd/mm/yy'"
                                        [formControl]="fc"
                                        [locale]="'langCalendar' | translate"
                                        [maxDate]="maxDateCalendar"
                                        [minDate]="minDateCalendar"
                                        appendTo="body"
                                        placeholder="בחירה"
                                    ></p-calendar>

                                    <p-calendar
                                        #formCalendars
                                        *ngIf="fld.fieldId === 13"
                                        [dateFormat]="'dd/mm/yy'"
                                        [formControl]="fc"
                                        [locale]="'langCalendar' | translate"
                                        [maxDate]="maxDateCalendar13"
                                        [minDate]="minDateCalendar13"
                                        appendTo="body"
                                        placeholder="בחירה"
                                    ></p-calendar>
                                    <ng-container *ngIf="fld.fieldId === 14">
                                        <p-calendar
                                            #formCalendars
                                            [dateFormat]="'dd/mm/yy'"
                                            [formControl]="fc"
                                            [locale]="'langCalendar' | translate"
                                            appendTo="body"
                                            placeholder="בחירה"
                                        ></p-calendar>
                                    </ng-container>
                                </ng-container>
                                <ng-container *ngSwitchCase="'NUMBER'">
                                    <ng-container
                                            *ngIf="
                  fld.fieldId !== 31 &&
                  fld.fieldId !== 32 &&
                  fld.fieldId !== 36 &&
                  fld.fieldId !== 37
                "
                                    >
                                        <ng-container
                                                *ngIf="
                    activeField?.field === fld ||
                      (activeField?.field?.fieldId === 24 &&
                        fld.fieldId === 17) ||
                              (activeField?.field?.fieldId === 27 &&
                        fld.fieldId === 16) ||
                      (activeField?.field?.fieldId === 29 &&
                        fld.fieldId === 18) ||
                      (fld.fieldId !== 15 &&
                        fld.fieldId !== 16 &&
                        fld.fieldId !== 17 &&
                        fld.fieldId !== 24 &&
                        fld.fieldId !== 18 &&
                        fld.fieldId !== 29);
                    else showFormatSum
                  "
                                        >
                                            <div
                                                #fieldListItemChild
                                                    *ngIf="
                      (activeField?.field === fld ||
                        (activeField?.field?.fieldId === 24 &&
                          fld.fieldId === 17) ||
                             (activeField?.field?.fieldId === 27 &&
                          fld.fieldId === 16) ||
                        (activeField?.field?.fieldId === 29 &&
                          fld.fieldId === 18)) &&
                        fileDetailsSave.matahSums &&
                        (fld.fieldId === 15 ||
                          fld.fieldId === 16 ||
                          fld.fieldId === 17 ||
                          fld.fieldId === 18);
                      else notRevaluationCurrCode
                    "
                                                    class="inputSumNumbers"
                                                    style="padding-left: 5px"
                                            >
                                                <!--                                            <div *ngIf="revaluationCurrCode && (fld.fieldId === 15 || fld.fieldId === 16)">-->
                                                <!--                                                {{formatAsSumNoMathNum(roundDigitsDec(fc.value))}}-->
                                                <!--&lt;!&ndash;                                                {{revaluationCurrCodeSign | currencySymbol}}&ndash;&gt;-->
                                                <!--                                            </div>-->

                                                <div
                                                        *ngIf="
                        fileDetailsSave.matahSums &&
                        (fld.fieldId === 17 ||
                          fld.fieldId === 15 ||
                          fld.fieldId === 16 ||
                          fld.fieldId === 18)
                      "
                                                >
                                                    <!--                                    24 - 17-->
                                                    <!--                                    27 - 16-->
                                                    <!--                                    26 - 15-->
                                                    <!--                                    29 - 18-->

                                                    <input
                                                            (blur)="
                          updateInputFromLastSaved(
                            fld.fieldId === 17
                              ? '24'
                              : fld.fieldId === 16
                              ? '27'
                              : fld.fieldId === 15
                              ? '26'
                              : '29'
                          )
                        "
                                                            (click)="fileDetailsSave.matahSums && fld.fieldId === 16  ?
                                                              setActiveField(
            fld,
            fieldsList,
            fileFieldsForm.get(27 + '')
        ) : null"
                                                            (focus)="
                          updateFocus(
                            fld.fieldId === 17
                              ? '24'
                              : fld.fieldId === 16
                              ? '27'
                              : fld.fieldId === 15
                              ? '26'
                              : '29'
                          );

                        "
                                                            [appNumbersOnly]="'positive'"
                                                            [formControl]="
                          fileFieldsForm
                            .get(
                              fld.fieldId === 17
                                ? '24'
                                : fld.fieldId === 16
                                ? '27'
                                : fld.fieldId === 15
                                ? '26'
                                : '29'
                            )
                            .get('effectiveValue')
                        "
                                                            [id]="
                          fld.fieldId === 17
                            ? '24'
                            : fld.fieldId === 16
                            ? '27'
                            : fld.fieldId === 15
                            ? '26'
                            : '29'
                        "
                                                            [placeholder]="'יש להשלים'"
                                                            autocomplete="off"
                                                            class="numberInput"
                                                            size="{{
                          (
                            fileFieldsForm
                              .get(
                                fld.fieldId === 17
                                  ? '24'
                                  : fld.fieldId === 16
                                  ? '27'
                                  : fld.fieldId === 15
                                  ? '26'
                                  : '29'
                              )
                              .get('effectiveValue').value + ''
                          ).length
                        }}"
                                                            style="text-align: right !important"
                                                    />
                                                    {{
                                                    showNegative && fld.fieldId !== 3 && fld.fieldId !== 25
                                                        ? '-'
                                                        : ''
                                                    }}
                                                    {{ revaluationCurrCodeSign | currencySymbol }}
                                                </div>
                                                <div>|</div>
                                                <div
                                                        [class.clean33]="
                        fld.fieldId === 33 &&
                        fileFieldsForm.get('33').get('effectiveValue').value ===
                          null &&
                        fileDetailsSave?.report856
                      "
                                                >
                                                    <div
                                                            *ngIf="
                          fld.fieldId === 33 &&
                          fileFieldsForm.get('33').get('effectiveValue')
                            .value === null &&
                          fileDetailsSave?.report856
                        "
                                                            class="set33empty"
                                                    >
                        <span (click)="set33empty(); updateFocus(fld.fieldId)">
                          נקה
                        </span>
                                                    </div>
                                                    <input
                                                            (click)="fileDetailsSave.matahSums && fld.fieldId === 16  ?
                                                              setActiveField(
            fld,
            fieldsList,
            fileFieldsForm.get(fld.fieldId + '')
        ) : null"
                                                            (blur)="updateInputFromLastSaved(fld.fieldId)"
                                                            (focus)="updateFocus(fld.fieldId)"
                                                            [appNumbersOnly]="'positive'"
                                                            [formControl]="fc"
                                                            [id]="fld.fieldId"
                                                            [placeholder]="
                          fld.fieldId === 33 &&
                          fileFieldsForm.get('33').get('effectiveValue')
                            .value === null &&
                          fileDetailsSave?.report856
                            ? 'לא יוצג בפקודה'
                            : fld.fieldId === 33 &&
                              fileFieldsForm.get('33').get('effectiveValue')
                                .value === null &&
                              !fileDetailsSave?.report856
                            ? ''
                            : 'יש להשלים'
                        "
                                                            autocomplete="off"
                                                            class="numberInput"
                                                            size="{{ (fc.value + '').length }}"
                                                    />
                                                    {{
                                                    showNegative && fld.fieldId !== 3 && fld.fieldId !== 25
                                                        ? '-'
                                                        : ''
                                                    }}
                                                    ₪
                                                </div>
                                            </div>
                                            <ng-template #notRevaluationCurrCode>
                                                <div
                                                        *ngIf="
                        fld.fieldId === 33 &&
                        fileFieldsForm.get('33').get('effectiveValue').value ===
                          null &&
                        fileDetailsSave?.report856
                      "
                                                        class="set33empty"
                                                >
                      <span (click)="set33empty(); updateFocus(fld.fieldId)">
                        נקה
                      </span>
                                                </div>
                                                <input
                                                        (blur)="updateInputFromLastSaved(fld.fieldId)"
                                                        (focus)="updateFocus(fld.fieldId)"
                                                        [appNumbersOnly]="
                        fld.fieldId === 33
                          ? 'positive'
                          : fld.fieldId === 3
                          ? 'positiveInt'
                          : 'positive'
                      "
                                                        [formControl]="fc"
                                                        [placeholder]="
                        fld.fieldId === 3 &&
                        fileDetailsSave.documentLogicType &&
                        (fileDetailsSave.documentLogicType ===
                          'matah_expense_type' ||
                          fileDetailsSave.documentLogicType ===
                            'matah_income_type' ||
                          fileDetailsSave.documentLogicType === 'other_type')
                          ? ''
                          : fld.fieldId === 33 &&
                            fileFieldsForm.get('33').get('effectiveValue')
                              .value === null &&
                            fileDetailsSave.report856
                          ? 'לא יוצג בפקודה'
                          : fld.fieldId === 33 &&
                            fileFieldsForm.get('33').get('effectiveValue')
                              .value === null &&
                            !fileDetailsSave?.report856
                          ? ''
                          : 'יש להשלים'
                      "
                                                        autocomplete="off"
                                                        class="numberInput"
                                                />
                                                {{
                                                showNegative && fld.fieldId !== 3 && fld.fieldId !== 25
                                                    ? '-'
                                                    : ''
                                                }}
                                            </ng-template>
                                        </ng-container>
                                        <ng-template #showFormatSum>
                                            <ng-container
                                                    *ngIf="
                      fileDetailsSave.matahSums &&
                        (fld.fieldId === 15 ||
                          fld.fieldId === 16 ||
                          fld.fieldId === 17 ||
                          fld.fieldId === 18);
                      else showFormatSumForOther
                    "
                                            >
                                                <div class="sumNumbers flexSum">
                                                    <div
                                                            (click)="fileDetailsSave.matahSums && fld.fieldId === 16  ?
                                                        setActiveField(
            fld,
            fieldsList,
            fileFieldsForm.get(27 + ''),
            27
        ) : null"
                                                            *ngIf="
                          fileDetailsSave.matahSums &&
                          (fld.fieldId === 15 ||
                            fld.fieldId === 16 ||
                            fld.fieldId === 17 ||
                            fld.fieldId === 18)
                        "
                                                    >
                                                        {{
                                                        fld.fieldId !== 17 && fld.fieldId !== 18
                                                            ? formatAsSumNoMathNum(
                                                                roundDigitsDec(
                                                                    fileFieldsForm
                                                                        .get(
                                                                            fld.fieldId === 17
                                                                                ? '24'
                                                                                : fld.fieldId === 16
                                                                                    ? '27'
                                                                                    : fld.fieldId === 15
                                                                                        ? '26'
                                                                                        : '29'
                                                                        )
                                                                        .get('effectiveValue').value
                                                                )
                                                            )
                                                            : fileFieldsForm
                                                                .get(fld.fieldId === 17 ? '24' : '29')
                                                                .get('effectiveValue').value &&
                                                            fileFieldsForm
                                                                .get(fld.fieldId === 17 ? '24' : '29')
                                                                .get('effectiveValue').value !== '0'
                                                                ? formatAsSumNoMathNum(
                                                                    roundDigitsDec(
                                                                        fileFieldsForm
                                                                            .get(fld.fieldId === 17 ? '24' : '29')
                                                                            .get('effectiveValue').value
                                                                    )
                                                                )
                                                                : 'יש להשלים'
                                                        }}
                                                        {{
                                                        (fld.fieldId !== 17 && fld.fieldId !== 18) ||
                                                        (fld.fieldId === 17 &&
                                                            fileFieldsForm.get('24').get('effectiveValue')
                                                                .value &&
                                                            fileFieldsForm.get('24').get('effectiveValue')
                                                                .value !== '0') ||
                                                        (fld.fieldId === 18 &&
                                                            fileFieldsForm.get('29').get('effectiveValue')
                                                                .value &&
                                                            fileFieldsForm.get('29').get('effectiveValue')
                                                                .value !== '0')
                                                            ? (showNegative ? '-' : '') +
                                                            (revaluationCurrCodeSign | currencySymbol)
                                                            : ''
                                                        }}
                                                    </div>
                                                    <div
                                                            *ngIf="
                          fileDetailsSave.matahSums &&
                          (fld.fieldId === 15 ||
                            fld.fieldId === 16 ||
                            fld.fieldId === 17 ||
                            fld.fieldId === 18)
                        "
                                                    >
                                                        |
                                                    </div>
                                                    <div
                                                            (click)="fileDetailsSave.matahSums && fld.fieldId === 16  ?
                                                        setActiveField(
            fld,
            fieldsList,
            fileFieldsForm.get(16 + ''),
            16
        ) : null">
                                                        {{
                                                        (fld.fieldId === 17 &&
                                                            fc.value &&
                                                            fc.value !== '0') ||
                                                        (fld.fieldId === 18 &&
                                                            fc.value &&
                                                            fc.value !== '0') ||
                                                        (fld.fieldId !== 17 &&
                                                            fc.value !== undefined &&
                                                            fc.value !== null) ||
                                                        (fld.fieldId !== 18 &&
                                                            fc.value !== undefined &&
                                                            fc.value !== null)
                                                            ? formatAsSumNoMathNum(fc.value)
                                                            : 'יש להשלים'
                                                        }}

                                                        {{
                                                        fileDetailsSave.matahSums &&
                                                        fc.value !== undefined &&
                                                        fc.value !== null &&
                                                        ((fld.fieldId === 17 && fc.value !== '0') ||
                                                            fld.fieldId !== 17) &&
                                                        ((fld.fieldId === 18 && fc.value !== '0') ||
                                                            fld.fieldId !== 18)
                                                            ? (showNegative ? '-' : '') + '₪'
                                                            : ''
                                                        }}
                                                    </div>
                                                </div>
                                            </ng-container>
                                            <ng-template #showFormatSumForOther>
                                                <div class="sumNumbers">
                                                    {{
                                                    fc.value !== undefined && fc.value !== null
                                                        ? formatAsSumNoMathNum(fc.value) +
                                                        (showNegative &&
                                                        fld.fieldId !== 3 &&
                                                        fld.fieldId !== 25
                                                            ? '-'
                                                            : '')
                                                        : 'יש להשלים'
                                                    }}
                                                </div>
                                            </ng-template>
                                        </ng-template>
                                    </ng-container>
                                    <ng-container *ngIf="fld.fieldId === 31">
                                        <input
                                                (blur)="updateInputFromLastSaved(fld.fieldId)"
                                                (focus)="updateFocus(fld.fieldId)"
                                                [formControl]="fc"
                                                appNumbersOnly="positiveInt"
                                                autocomplete="off"
                                                class="numberInput"
                                        />
                                    </ng-container>
                                    <ng-container
                                            *ngIf="
                  fld.fieldId === 32 || fld.fieldId === 36 || fld.fieldId === 37
                "
                                    >
                                        <input
                                                (blur)="updateInputFromLastSaved(fld.fieldId)"
                                                (focus)="updateFocus(fld.fieldId)"
                                                [formControl]="fc"
                                                appNumbersOnly="positive"
                                                autocomplete="off"
                                                class="numberInput"
                                                style="padding-left: 0"
                                        />{{ showNegative ? '-' : '' }}
                                    </ng-container>
                                </ng-container>
                                <ng-container *ngSwitchDefault>
                                    <ng-container *ngIf="fc">
                                        <input
                                            #inputElement
                                            (blur)="updateInputFromLastSaved(fld.fieldId)"
                                            (focus)="updateFocus(fld.fieldId)"
                                            [class.infoInput]="fld.fieldId === 7"
                                            [class.numberInput]="fld.fieldId === 11"
                                            [formControl]="fc"
                                            [matTooltip]="
                inputElement.offsetWidth >= inputElement.scrollWidth
                  ? null
                  : fc.value
              "
                                            [placeholder]="fld.fieldId === 28 ? '' : 'יש להשלים'"
                                            autocomplete="off"
                                            class="text-ellipsis"
                                            matTooltipPosition="above"
                                        />
                                    </ng-container>
                                </ng-container>
                            </ng-container>
                        </ng-container>
                    </ng-template>
                    <ng-template
                        #byFieldIdWithPredefined
                        let-fc="formControl"
                        let-fld="field"
                    >
                        <ng-container [ngSwitch]="fld.fieldId">
                            <ng-container *ngSwitchCase="'40'">
                                <app-dropdown-wrap
                                        [virtualScrollItemSize]="33"
                                        [virtualScroll]="true"
                                    #formDropdowns
                                    #formDropdownsCartis
                                    (onFocus)="clearFilter(formDropdowns)"
                                    (onFilter)="filterFuncReset($event, formDropdownsCartis)"
                                    [filter]="true"
                                    [resetFilterOnHide]="true"
                                    [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                    [formControl]="fc"
                                    [options]="arrOption40"
                                    [scrollHeight]="'185px'"
                                    [style]="{ width: 'auto' }"
                                    appendTo="body"
                                    panelStyleClass="company-customer-dropdown-panel cardsDD"
                                    placeholder="בחירה"
                                    styleClass="ddInfoCompanyForm"
                                    filterBy="label,value"
                                >
                                    <ng-template pTemplate="empty">
                                        <div
                                                class="p-helper-clearfix"
                                                style="font-size: 0.95em; padding: 0.3em 1em"
                                        >
                                            לא נמצאו נתונים
                                        </div>
                                    </ng-template>
                                    <ng-template let-item pTemplate="selectedItem">
                  <span
                      #spanElement
                      [pTooltip]="item.label + ' ' + item.value"
                      [tooltipDisabled]="
                      spanElement.offsetWidth >= spanElement.scrollWidth
                    "
                      style="
                      vertical-align: middle;
                      display: block;
                      white-space: nowrap;
                      overflow: hidden;
                      text-overflow: ellipsis;
                    "
                      tooltipPosition="top"
                  >{{
                      limitCharacters(item.onlyName ? item.label : item.value)
                      }}</span
                  >
                                    </ng-template>
                                    <ng-template let-item pTemplate="item">
                                        <div class="p-helper-clearfix cust-item">
                                            <div
                                                    style="
                        display: flex;
                        align-items: center;
                        flex-direction: row;
                        justify-content: space-between;
                      "
                                            >
                                                <span class="text-ellipsis">{{ item.label }}</span>
                                                <span
                                                        *ngIf="!item.onlyName"
                                                        class="text-ellipsis"
                                                        style="
                          width: 60px;
                          display: inline-block;
                          margin-right: 10px;
                        "
                                                >{{ item.value }}</span
                                                >
                                            </div>
                                        </div>
                                    </ng-template>
                                    <ng-template pTemplate="footer">
                                        <ng-container *ngIf="isTransTypeStatus">

                                            <div
                                                    class="p-helper-clearfix"
                                                    style="height: 34px; line-height: 34px"
                                            >
                                                <div
                                                        [routerLinkActiveOptions]="{ exact: true }"
                                                        [routerLink]="[
                          '/accountants/companies/general/transType'
                        ]"
                                                        class="link"
                                                        queryParamsHandling="merge"
                                                        routerLinkActive="active"
                                                        style="text-align: center"
                                                >
                                                    <span> לשינוי והוספה לחצו כאן </span>
                                                </div>
                                            </div>

                                        </ng-container>
                                    </ng-template>
                                </app-dropdown-wrap>
                            </ng-container>
                            <ng-container *ngSwitchCase="'41'">
                                <app-dropdown-wrap
                                        [virtualScrollItemSize]="33"
                                        [virtualScroll]="true"
                                    #formDropdowns
                                    (onFocus)="clearFilter(formDropdowns)"
                                    [autoDisplayFirst]="false"
                                    [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                    [formControl]="fc"
                                    [options]="arrOption41"
                                    [scrollHeight]="'185px'"
                                    [style]="{ width: 'auto' }"
                                    appendTo="body"
                                    panelStyleClass="company-customer-dropdown-panel cardsDD"
                                    placeholder="בחירה"
                                    styleClass="ddInfoCompanyForm"
                                >
                                    <ng-template pTemplate="empty">
                                        <div
                                                class="p-helper-clearfix"
                                                style="font-size: 0.95em; padding: 0.3em 1em"
                                        >
                                            לא נמצאו נתונים
                                        </div>
                                    </ng-template>
                                    <ng-template let-item pTemplate="selectedItem">
                  <span
                      #spanElement
                      [pTooltip]="item.label + ' ' + item.value"
                      [tooltipDisabled]="
                      spanElement.offsetWidth >= spanElement.scrollWidth
                    "
                      style="
                      vertical-align: middle;
                      display: block;
                      white-space: nowrap;
                      overflow: hidden;
                      text-overflow: ellipsis;
                    "
                      tooltipPosition="top"
                  >{{
                      limitCharacters(item.onlyName ? item.label : item.value)
                      }}</span
                  >
                                    </ng-template>
                                    <ng-template let-item pTemplate="item">
                                        <div class="p-helper-clearfix cust-item">
                                            <div
                                                    style="
                        display: flex;
                        align-items: center;
                        flex-direction: row;
                        justify-content: space-between;
                      "
                                            >
                                                <span class="text-ellipsis">{{ item.label }}</span>
                                                <span
                                                        *ngIf="!item.onlyName"
                                                        class="text-ellipsis"
                                                        style="
                          width: 60px;
                          display: inline-block;
                          margin-right: 10px;
                        "
                                                >{{ item.value }}</span
                                                >
                                            </div>
                                        </div>
                                    </ng-template>
                                    <ng-template pTemplate="footer">
                                        <ng-container *ngIf="isTransTypeStatus">

                                            <div
                                                    class="p-helper-clearfix"
                                                    style="height: 34px; line-height: 34px"
                                            >
                                                <div
                                                        [routerLinkActiveOptions]="{ exact: true }"
                                                        [routerLink]="[
                          '/accountants/companies/general/transType'
                        ]"
                                                        class="link"
                                                        queryParamsHandling="merge"
                                                        routerLinkActive="active"
                                                        style="text-align: center"
                                                >
                                                    <span> לשינוי והוספה לחצו כאן </span>
                                                </div>
                                            </div>

                                        </ng-container>
                                    </ng-template>
                                </app-dropdown-wrap>
                            </ng-container>
                            <ng-container *ngSwitchCase="'4'">
                                <p-dropdown
                                    #formDropdowns
                                    [autoDisplayFirst]="false"
                                    [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                    [formControl]="fc"
                                    [options]="
                  fileFieldsForm.get('21')?.get('effectiveValue').value === 1
                    ? fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'חשבונית מס' ||
                      fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'חשבונית מס קבלה' ||
                      fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'חשבונית זיכוי' ||
                      fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'אחר'
                      ? vatOptionsAll
                      : vatOptions
                    : fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      0
                    ? vatOptionsIncome
                    : vatOptions
                "
                                    [pTooltip]="'מקביל לסוג תנועה בהנה״ח'"
                                    [style]="{ width: 'auto' }"
                                    appendTo="body"
                                    placeholder="בחירה"
                                    scrollHeight="unset"
                                    tooltipPosition="top"
                                ></p-dropdown>
                            </ng-container>
                            <ng-container *ngSwitchCase="'30'">
                                <app-dropdown-wrap
                                        #formDropdowns
                                        #formDropdownsCartis
                                        (onFilter)="filterFuncReset($event, formDropdownsCartis)"
                                        (onFocus)="clearFilter(formDropdowns)"
                                        [autoDisplayFirst]="false"
                                        [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                        [filter]="true"
                                        [formControl]="fc"
                                        [options]="arrOption30"
                                        [resetFilterOnHide]="true"
                                        [scrollHeight]="'228px'"
                                        [style]="{ width: 'auto' }"
                                        [virtualScrollItemSize]="38"
                                        [virtualScroll]="true"
                                        (addCardManuallyFunc)="setValCartis(formDropdowns, 30);getCompanyCustomerDetailsTimer()"
                                        [addCardManually]="true"
                                        appendTo="body"
                                        dataKey="custId"
                                        emptyFilterMessage="לא נמצאו תוצאות"
                                        filterBy="lName,custId,hp"
                                        optionDisabled="disabled"
                                        optionLabel="custId"
                                        panelStyleClass="company-customer-dropdown-panel cardsDD card275 cardsDD40"
                                        placeholder="בחירה"
                                        styleClass="ddInfoCompanyForm"

                                >
                                    <ng-template let-item pTemplate="selectedItem">
                                        <!--                                        <span style="vertical-align:middle;display: block;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;"-->
                                        <!--                                              #spanElement-->
                                        <!--                                              [tooltipDisabled]="spanElement.offsetWidth >= spanElement.scrollWidth"-->
                                        <!--                                              [pTooltip]="item.cartisName"-->
                                        <!--                                              tooltipPosition="top">{{item.custId}}</span>-->

                                        <span
                                            #spanElement
                                            [pTooltip]="item.cartisName"
                                            [tooltipDisabled]="
                      spanElement.offsetWidth >= spanElement.scrollWidth
                    "
                                            style="
                      vertical-align: middle;
                      display: block;
                      white-space: nowrap;
                      overflow: hidden;
                      text-overflow: ellipsis;
                    "
                                            tooltipPosition="top"
                                        >{{ limitCharacters(item.cartisName) }}</span
                                        >
                                    </ng-template>
                                    <ng-template let-item pTemplate="item">
                                        <div *ngIf="item.title"
                                             class="p-helper-clearfix"
                                             style="font-size: 0.95em;padding: 0.3em 1em;border-bottom: 1px solid #cacaca;line-height: 20px;flex: 1;display: block;">
                                            <div style="
    padding: 0;
    margin: 0;
    flex: 1;
    font-size: 15px;
    font-weight: 400;
">לא מצאתם את הכרטיס שחיפשתם?
                                            </div>
                                            <button
                                                    (click)="
                            cupaAllTheOptions = true;
                          rebuildArrData(fld.fieldId);
                          $event.stopPropagation()
                          "
                                                    *ngIf="!cupaAllTheOptions"
                                                    class="button-link"
                                                    style="padding: 0;font-size: 15px;font-weight: 400; pointer-events: auto; cursor: pointer !important"
                                            >
                                                חפשו בין כל הכרטיסים בהנה״ח
                                            </button>
                                            <ng-container *ngIf="cupaAllTheOptions">
                                                <div>צרו כרטיס חדש בחשבשבת.</div>
                                                <div>
                                                    בינתיים ניתן לעדכן ידנית את
                                                    <strong style="font-weight: 700">
                                                        מפתח הכרטיס במדויק
                                                    </strong>
                                                    <br/>
                                                    עד שנמשוך את פרטי הכרטיס.
                                                </div>
                                                <button
                                                        (click)="
                            setValCartis(formDropdowns, 30);
                            getCompanyCustomerDetailsTimer()
                          "
                                                        class="button-link"
                                                        style="
                            padding: 0;
                            font-size: inherit;
                            text-decoration: underline;
                          "
                                                >
                                                    לעדכון ידני לחצו פה
                                                </button>
                                            </ng-container>
                                        </div>
                                        <div *ngIf="!item.title"
                                             class="p-helper-clearfix cust-item">

                                            <div
                                                    [ngStyle]="
                      (fileFieldsForm.get('22') &&
                        fileFieldsForm.get('22').get('effectiveValue') &&
                        fileFieldsForm.get('22').get('effectiveValue').value &&
                        fileFieldsForm.get('22').get('effectiveValue').value ===
                          item.custId) ||
                      (fileFieldsForm.get('6').get('effectiveValue') &&
                        fileFieldsForm.get('6').get('effectiveValue').value &&
                        fileFieldsForm.get('6').get('effectiveValue').value
                          .custId &&
                        fileFieldsForm.get('6').get('effectiveValue').value
                          .custId === item.custId) ||
                      (fileFieldsForm.get('2').get('effectiveValue') &&
                        fileFieldsForm.get('2').get('effectiveValue').value &&
                        fileFieldsForm.get('2').get('effectiveValue').value
                          .custId &&
                        fileFieldsForm.get('2').get('effectiveValue').value
                          .custId === item.custId)
                        ? { opacity: '0.4', cursor: 'default' }
                        : ''
                    "
                                                    class="p-helper-clearfix"
                                                    style="flex-flow: column"
                                            >
                                                <div>
                      <span class="text-ellipsis">{{
                          item.cartisName
                          }}</span>
                                                </div>
                                                <!--												<div *ngIf="item.hp" class="separator">-->
                                                <!--													<span>-</span>-->
                                                <!--												</div>-->

                                                <div style="font-size: 12px">
                        <span

                                class="text-ellipsis secondary"
                        >
							<ng-container *ngIf="item.hp">
								                          ח.פ./ע.מ. {{ item.hp }}
							</ng-container>



							<ng-container
                                    *ngIf="
                        fileFieldsForm.get('22') &&
                        fileFieldsForm.get('22').get('effectiveValue') &&
                        fileFieldsForm.get('22').get('effectiveValue').value &&
                        fileFieldsForm.get('22').get('effectiveValue').value ===
                          item.custId
                      "
                                    style="
                        flex: none;
                        width: 100%;
                        height: auto;
                        line-height: normal;
                      "
                            >
													הכרטיס נבחר ככרטיס מע"מ
												</ng-container>
												<ng-container
                                                        *ngIf="
                        fileFieldsForm.get('6').get('effectiveValue') &&
                        fileFieldsForm.get('6').get('effectiveValue').value &&
                        fileFieldsForm.get('6').get('effectiveValue').value
                          .custId &&
                        fileFieldsForm.get('6').get('effectiveValue').value
                          .custId === item.custId
                      "
                                                        style="
                        flex: none;
                        width: 100%;
                        height: auto;
                        line-height: normal;
                      "
                                                >
													הכרטיס כבר נבחר בכרטיס נגדי
												</ng-container>
												<ng-container
                                                        *ngIf="
                        fileFieldsForm.get('2').get('effectiveValue') &&
                        fileFieldsForm.get('2').get('effectiveValue').value &&
                        fileFieldsForm.get('2').get('effectiveValue').value
                          .custId &&
                        fileFieldsForm.get('2').get('effectiveValue').value
                          .custId === item.custId
                      "
                                                        style="
                        flex: none;
                        width: 100%;
                        height: auto;
                        line-height: normal;
                      "
                                                >
													הכרטיס כבר נבחר בכרטיס ספק/לקוח
												</ng-container>
						</span>
                                                </div>

                                            </div>
                                        </div>
                                    </ng-template>
                                    <ng-template pTemplate="empty">
                                        <div
                                                class="p-helper-clearfix"
                                                style="font-size: 0.95em; padding: 0.3em 1em"
                                        >
                                            <ng-container>
                                                <div>לא מצאתם את הכרטיס שחיפשתם?</div>
                                                <div>צרו כרטיס חדש בחשבשבת.</div>
                                                <div>
                                                    בינתיים ניתן לעדכן ידנית את
                                                    <strong style="font-weight: 700">
                                                        מפתח הכרטיס במדויק
                                                    </strong>
                                                    <br/>
                                                    עד שנמשוך את פרטי הכרטיס.
                                                </div>
                                                <button
                                                        (click)="
                          setValCartis(formDropdowns, 30);
                          getCompanyCustomerDetailsTimer()
                        "
                                                        class="button-link"
                                                        style="
                          padding: 0;
                          font-size: inherit;
                          text-decoration: underline;
                        "
                                                >
                                                    לעדכון ידני לחצו פה
                                                </button>
                                            </ng-container>
                                            <!--                                        <ng-template #loader>-->
                                            <!--                                            <div style="height: 84px;">-->
                                            <!--                                                <div class="loaderPercent blueCircle" style="background: #e6e5e5;">-->
                                            <!--                                                    <div class="circle"></div>-->
                                            <!--                                                </div>-->
                                            <!--                                            </div>-->
                                            <!--                                            <div style="-->
                                            <!--    z-index: 999;-->
                                            <!--    position: absolute;-->
                                            <!--    bottom: 26px;-->
                                            <!--    font-size: 14.5px;-->
                                            <!--    text-align: center;-->
                                            <!--    font-weight: 600;-->
                                            <!--    left: 0;-->
                                            <!--    right: 0;-->
                                            <!--">-->
                                            <!--                                                מתבצע סינכרון-->
                                            <!--                                            </div>-->
                                            <!--                                        </ng-template>-->
                                        </div>
                                    </ng-template>
                                    <ng-template pTemplate="emptyfilter">
                                        <div
                                                class="p-helper-clearfix"
                                                style="font-size: 0.95em; padding: 0.3em 1em"
                                        >
                                            <ng-container>
                                                <div>לא מצאתם את הכרטיס שחיפשתם?</div>
                                                <div>צרו כרטיס חדש בחשבשבת.</div>
                                                <div>
                                                    בינתיים ניתן לעדכן ידנית את
                                                    <strong style="font-weight: 700">
                                                        מפתח הכרטיס במדויק
                                                    </strong>
                                                    <br/>
                                                    עד שנמשוך את פרטי הכרטיס.
                                                </div>
                                                <button
                                                        (click)="
                          setValCartis(formDropdowns, 30);
                          getCompanyCustomerDetailsTimer()
                        "
                                                        class="button-link"
                                                        style="
                          padding: 0;
                          font-size: inherit;
                          text-decoration: underline;
                        "
                                                >
                                                    לעדכון ידני לחצו פה
                                                </button>
                                            </ng-container>
                                            <!--                                        <ng-template #loader>-->
                                            <!--                                            <div style="height: 84px;">-->
                                            <!--                                                <div class="loaderPercent blueCircle" style="background: #e6e5e5;">-->
                                            <!--                                                    <div class="circle"></div>-->
                                            <!--                                                </div>-->
                                            <!--                                            </div>-->
                                            <!--                                            <div style="-->
                                            <!--    z-index: 999;-->
                                            <!--    position: absolute;-->
                                            <!--    bottom: 26px;-->
                                            <!--    font-size: 14.5px;-->
                                            <!--    text-align: center;-->
                                            <!--    font-weight: 600;-->
                                            <!--    left: 0;-->
                                            <!--    right: 0;-->
                                            <!--">-->
                                            <!--                                                מתבצע סינכרון-->
                                            <!--                                            </div>-->
                                            <!--                                        </ng-template>-->
                                        </div>
                                    </ng-template>
                                </app-dropdown-wrap>
                            </ng-container>
                            <ng-container *ngSwitchCase="'5'">
                                <ng-container *ngIf="companyCustomerDetailsData">
                                    <p-dropdown
                                            #formDropdowns123
                                            [autoDisplayFirst]="false"
                                            [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                            [formControl]="fc"
                                            [options]="companyCustomerDetailsData.vatReportOptions"
                                            [style]="{ width: 'auto' }"
                                            [virtualScrollItemSize]="33"
                                            appendTo="body"
                                            placeholder="בחירה"
                                    ></p-dropdown>
                                </ng-container>
                            </ng-container>
                            <ng-container *ngSwitchCase="'2'">
                                <app-dropdown-wrap
                                        #formDropdowns
                                        #formDropdownsCartis
                                        (onFilter)="filterFuncReset($event, formDropdownsCartis)"
                                        (onFocus)="clearFilter(formDropdowns)"
                                        (onHide)="hideDropCartis()"
                                        [autoDisplayFirst]="false"
                                        [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                        [filter]="true"
                                        [formControl]="fc"
                                        [options]="arrOption2"
                                        [resetFilterOnHide]="true"
                                        [scrollHeight]="'200px'"
                                        [style]="{ width: 'auto' }"
                                        [virtualScroll]="true"
                                        [virtualScrollItemSize]="38"
                                        (addCardManuallyFunc)="setValCartis(formDropdowns, 2);getCompanyCustomerDetailsTimer()"
                                        [addCardManually]="true"
                                        appendTo="body"
                                        dataKey="custId"
                                        emptyFilterMessage="לא נמצאו תוצאות"
                                        filterBy="lName,custId,hp"
                                        optionDisabled="disabled"
                                        optionLabel="custId"
                                        panelStyleClass="company-customer-dropdown-panel cardsDD cardsDD40"
                                        placeholder="בחירה"
                                        styleClass="ddInfoCompanyForm"
                                >

                                    <ng-template let-item pTemplate="selectedItem">
                  <span
                      #spanElement
                      [pTooltip]="item.cartisName"
                      [tooltipDisabled]="
                      spanElement.offsetWidth >= spanElement.scrollWidth
                    "
                      style="
                      vertical-align: middle;
                      display: block;
                      white-space: nowrap;
                      overflow: hidden;
                      text-overflow: ellipsis;
                    "
                      tooltipPosition="top"
                  >{{ limitCharacters(item.cartisName) }}</span
                  >
                                    </ng-template>
                                    <ng-template let-item pTemplate="item">
                                        <div
                                                [ngStyle]="
                      (fileFieldsForm.get('22') &&
                        fileFieldsForm.get('22').get('effectiveValue') &&
                        fileFieldsForm.get('22').get('effectiveValue').value &&
                        fileFieldsForm.get('22').get('effectiveValue').value ===
                          item.custId) ||
                      (fileFieldsForm.get('6').get('effectiveValue') &&
                        fileFieldsForm.get('6').get('effectiveValue').value &&
                        fileFieldsForm.get('6').get('effectiveValue').value
                          .custId &&
                        fileFieldsForm.get('6').get('effectiveValue').value
                          .custId === item.custId) ||
                      (fileFieldsForm.get('30') &&
                        fileFieldsForm.get('30').get('effectiveValue') &&
                        fileFieldsForm.get('30').get('effectiveValue').value &&
                        fileFieldsForm.get('30').get('effectiveValue').value
                          .custId &&
                        fileFieldsForm.get('30').get('effectiveValue').value
                          .custId === item.custId)
                        ? { opacity: '0.4', cursor: 'default' }
                        : ''
                    "
                                                class="p-helper-clearfix"
                                                style="flex-flow: column"
                                        >
                                            <div>
                      <span class="text-ellipsis">{{
                          item.cartisName
                          }}</span>
                                            </div>

                                            <div style="font-size: 12px">
                        <span
                                class="text-ellipsis secondary"
                        >
							<ng-container
                                    *ngIf="item.hp">
																										 ח.פ./ע.מ. {{ item.hp }}
							</ng-container>




							<ng-container
                                    *ngIf="
                        fileFieldsForm.get('22') &&
                        fileFieldsForm.get('22').get('effectiveValue') &&
                        fileFieldsForm.get('22').get('effectiveValue').value &&
                        fileFieldsForm.get('22').get('effectiveValue').value ===
                          item.custId
                      "
                            >
								-
														הכרטיס נבחר ככרטיס מע"מ
													</ng-container>
													<ng-container
                                                            *ngIf="
                        fileFieldsForm.get('6').get('effectiveValue') &&
                        fileFieldsForm.get('6').get('effectiveValue').value &&
                        fileFieldsForm.get('6').get('effectiveValue').value
                          .custId &&
                        fileFieldsForm.get('6').get('effectiveValue').value
                          .custId === item.custId
                      "
                                                    >
														-
														הכרטיס כבר נבחר בכרטיס נגדי
													</ng-container>
													<ng-container
                                                            *ngIf="
                        fileFieldsForm.get('30') &&
                        fileFieldsForm.get('30').get('effectiveValue') &&
                        fileFieldsForm.get('30').get('effectiveValue').value &&
                        fileFieldsForm.get('30').get('effectiveValue').value
                          .custId &&
                        fileFieldsForm.get('30').get('effectiveValue').value
                          .custId === item.custId
                      "
                                                    >
														-
														הכרטיס כבר נבחר בכרטיס קופה
													</ng-container>

						</span>


                                            </div>

                                        </div>
                                    </ng-template>
                                    <ng-template pTemplate="empty">
                                        <div
                                                class="p-helper-clearfix"
                                                style="font-size: 0.95em; padding: 0.3em 1em"
                                        >
                                            <!--                                        <ng-container *ngIf="!loaderGetCompanyCustomerDetails; else loader">-->
                                            <!--                                            <div>לא מצאת את הכרטיס שחיפשת?</div>-->
                                            <!--                                            <div>צרו כרטיס חדש בהנה"ח</div>-->
                                            <!--                                            <button class="button-link" style="padding: 0; font-size: inherit;"-->
                                            <!--                                                    (click)="getCompanyCustomerDetailsTimer(); $event.stopPropagation()">-->
                                            <!--                                                ולחצו על-->
                                            <!--                                                רענון הנתונים-->
                                            <!--                                            </button>-->
                                            <!--                                        </ng-container>-->

                                            <ng-container>
                                                <!--                                            <div>לא מצאת את הכרטיס?</div>-->
                                                <!--                                            <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                <!--                                            <div>-->
                                                <!--                                                ובנתיים-->
                                                <!--                                                <button class="button-link"-->
                                                <!--                                                        style="padding: 0; font-size: inherit; text-decoration: underline"-->
                                                <!--                                                        (click)="setValCartis(formDropdowns, 2);  getCompanyCustomerDetailsTimer();">-->
                                                <!--                                                    לחצו לעדכון-->
                                                <!--                                                </button>-->
                                                <!--                                            </div>-->

                                                <div>לא מצאתם את הכרטיס שחיפשתם?</div>
                                                <div>צרו כרטיס חדש בחשבשבת.</div>
                                                <div>
                                                    בינתיים ניתן לעדכן ידנית את
                                                    <strong style="font-weight: 700">
                                                        מפתח הכרטיס במדויק
                                                    </strong>
                                                    <br/>
                                                    עד שנמשוך את פרטי הכרטיס.
                                                </div>
                                                <button
                                                        (click)="
                          setValCartis(formDropdowns, 2);
                          getCompanyCustomerDetailsTimer()
                        "
                                                        class="button-link"
                                                        style="
                          padding: 0;
                          font-size: inherit;
                          text-decoration: underline;
                        "
                                                >
                                                    לעדכון ידני לחצו פה
                                                </button>
                                            </ng-container>

                                            <!--                                        <ng-template #loader>-->
                                            <!--                                            <div style="height: 84px;">-->
                                            <!--                                                <div class="loaderPercent blueCircle" style="background: #e6e5e5;">-->
                                            <!--                                                    <div class="circle"></div>-->
                                            <!--                                                </div>-->
                                            <!--                                            </div>-->
                                            <!--                                            <div style="-->
                                            <!--    z-index: 999;-->
                                            <!--    position: absolute;-->
                                            <!--    bottom: 26px;-->
                                            <!--    font-size: 14.5px;-->
                                            <!--    text-align: center;-->
                                            <!--    font-weight: 600;-->
                                            <!--    left: 0;-->
                                            <!--    right: 0;-->
                                            <!--">-->
                                            <!--                                                מתבצע סינכרון-->
                                            <!--                                            </div>-->
                                            <!--                                        </ng-template>-->
                                        </div>
                                    </ng-template>
                                    <ng-template pTemplate="emptyfilter">
                                        <div
                                                class="p-helper-clearfix"
                                                style="font-size: 0.95em; padding: 0.3em 1em"
                                        >
                                            <!--                                        <ng-container *ngIf="!loaderGetCompanyCustomerDetails; else loader">-->
                                            <!--                                            <div>לא מצאת את הכרטיס שחיפשת?</div>-->
                                            <!--                                            <div>צרו כרטיס חדש בהנה"ח</div>-->
                                            <!--                                            <button class="button-link" style="padding: 0; font-size: inherit;"-->
                                            <!--                                                    (click)="getCompanyCustomerDetailsTimer(); $event.stopPropagation()">-->
                                            <!--                                                ולחצו על-->
                                            <!--                                                רענון הנתונים-->
                                            <!--                                            </button>-->
                                            <!--                                        </ng-container>-->

                                            <ng-container>
                                                <!--                                            <div>לא מצאת את הכרטיס?</div>-->
                                                <!--                                            <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                <!--                                            <div>-->
                                                <!--                                                ובנתיים-->
                                                <!--                                                <button class="button-link"-->
                                                <!--                                                        style="padding: 0; font-size: inherit; text-decoration: underline"-->
                                                <!--                                                        (click)="setValCartis(formDropdowns, 2);  getCompanyCustomerDetailsTimer();">-->
                                                <!--                                                    לחצו לעדכון-->
                                                <!--                                                </button>-->
                                                <!--                                            </div>-->

                                                <div>לא מצאתם את הכרטיס שחיפשתם?</div>
                                                <div>צרו כרטיס חדש בחשבשבת.</div>
                                                <div>
                                                    בינתיים ניתן לעדכן ידנית את
                                                    <strong style="font-weight: 700">
                                                        מפתח הכרטיס במדויק
                                                    </strong>
                                                    <br/>
                                                    עד שנמשוך את פרטי הכרטיס.
                                                </div>
                                                <button
                                                        (click)="
                          setValCartis(formDropdowns, 2);
                          getCompanyCustomerDetailsTimer()
                        "
                                                        class="button-link"
                                                        style="
                          padding: 0;
                          font-size: inherit;
                          text-decoration: underline;
                        "
                                                >
                                                    לעדכון ידני לחצו פה
                                                </button>
                                            </ng-container>

                                            <!--                                        <ng-template #loader>-->
                                            <!--                                            <div style="height: 84px;">-->
                                            <!--                                                <div class="loaderPercent blueCircle" style="background: #e6e5e5;">-->
                                            <!--                                                    <div class="circle"></div>-->
                                            <!--                                                </div>-->
                                            <!--                                            </div>-->
                                            <!--                                            <div style="-->
                                            <!--    z-index: 999;-->
                                            <!--    position: absolute;-->
                                            <!--    bottom: 26px;-->
                                            <!--    font-size: 14.5px;-->
                                            <!--    text-align: center;-->
                                            <!--    font-weight: 600;-->
                                            <!--    left: 0;-->
                                            <!--    right: 0;-->
                                            <!--">-->
                                            <!--                                                מתבצע סינכרון-->
                                            <!--                                            </div>-->
                                            <!--                                        </ng-template>-->
                                        </div>
                                    </ng-template>
                                </app-dropdown-wrap>
                            </ng-container>
                            <ng-container *ngSwitchCase="'6'">
                                <app-dropdown-wrap
                                        #formDropdowns
                                        #formDropdownsCartis6
                                        (onFilter)="filterFunc($event, formDropdownsCartis6)"
                                        (onFocus)="clearFilter(formDropdownsCartis6)"
                                        (onHide)="hideDropCartis()"
                                        (onShow)="setDefOpt()"
                                        [autoDisplayFirst]="false"
                                        [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                        [filter]="true"
                                        [formControl]="fc"
                                        [options]="arrOption6"
                                        [resetFilterOnHide]="true"
                                        [scrollHeight]="'200px'"
                                        [style]="{ width: 'auto' }"
                                        [virtualScroll]="true"
                                        [virtualScrollItemSize]="38"
                                        (addCardManuallyFunc)="setValCartis(formDropdowns, 6);getCompanyCustomerDetailsTimer()"
                                        [addCardManually]="true"
                                        appendTo="body"
                                        dataKey="custId"
                                        emptyFilterMessage="לא נמצאו תוצאות"
                                        filterBy="lName,custId"
                                        optionDisabled="disabled"
                                        optionLabel="custId"
                                        panelStyleClass="company-customer-dropdown-panel cardsDD cardsDD40"
                                        placeholder="בחירה"
                                        styleClass="ddInfoCompanyForm"
                                >
                                    <ng-template let-item pTemplate="selectedItem">
                  <span
                      #spanElement
                      [pTooltip]="item.cartisName"
                      [tooltipDisabled]="
                      spanElement.offsetWidth >= spanElement.scrollWidth
                    "
                      style="vertical-align: middle; display: block"
                      tooltipPosition="top"
                  >{{ limitCharacters(item.cartisName) }}</span
                  >
                                    </ng-template>
                                    <ng-template let-item pTemplate="item">
                                        <ng-container *ngIf="item.title">
                                            <div class="p-helper-clearfix" style="
    font-weight: 700;
    padding: 0;
    font-size: 16px;
">
                                                <span> כרטיסים ששוייכו בעבר: </span>
                                            </div>
                                        </ng-container>
                                        <ng-container *ngIf="!item.title">
                                            <div
                                                    [ngStyle]="
                      (fileFieldsForm.get('22') &&
                        fileFieldsForm.get('22').get('effectiveValue') &&
                        fileFieldsForm.get('22').get('effectiveValue').value &&
                        fileFieldsForm.get('22').get('effectiveValue').value ===
                          item.custId) ||
                      (fileFieldsForm.get('2').get('effectiveValue') &&
                        fileFieldsForm.get('2').get('effectiveValue').value &&
                        fileFieldsForm.get('2').get('effectiveValue').value
                          .custId &&
                        fileFieldsForm.get('2').get('effectiveValue').value
                          .custId === item.custId) ||
                      (fileFieldsForm.get('30') &&
                        fileFieldsForm.get('30').get('effectiveValue') &&
                        fileFieldsForm.get('30').get('effectiveValue').value &&
                        fileFieldsForm.get('30').get('effectiveValue').value
                          .custId &&
                        fileFieldsForm.get('30').get('effectiveValue').value
                          .custId === item.custId)
                        ? { opacity: '0.4', cursor: 'default' }
                        : ''
                    "
                                                    class="p-helper-clearfix"
                                                    style="flex-flow: column"
                                            >
                                                <div
                                                        [class.bottom9]="item.isLastHistory"
                                                        class="p-helper-clearfix"
                                                >
                                                    <div>
                                                        <span>{{ item.cartisName }}</span>
                                                    </div>
                                                    <div style="font-size: 12px">
                        <span class="text-ellipsis secondary">
				<ng-container
                        *ngIf="
                        fileFieldsForm.get('22') &&
                        fileFieldsForm.get('22').get('effectiveValue') &&
                        fileFieldsForm.get('22').get('effectiveValue').value &&
                        fileFieldsForm.get('22').get('effectiveValue').value ===
                          item.custId
                      "

                >
														הכרטיס נבחר ככרטיס מע"מ
													</ng-container>
													<ng-container
                                                            *ngIf="
                        fileFieldsForm.get('2').get('effectiveValue') &&
                        fileFieldsForm.get('2').get('effectiveValue').value &&
                        fileFieldsForm.get('2').get('effectiveValue').value
                          .custId &&
                        fileFieldsForm.get('2').get('effectiveValue').value
                          .custId === item.custId
                      "

                                                    >
														הכרטיס כבר נבחר בכרטיס ספק/לקוח
													</ng-container>
													<ng-container
                                                            *ngIf="
                        fileFieldsForm.get('30') &&
                        fileFieldsForm.get('30').get('effectiveValue') &&
                        fileFieldsForm.get('30').get('effectiveValue').value &&
                        fileFieldsForm.get('30').get('effectiveValue').value
                          .custId &&
                        fileFieldsForm.get('30').get('effectiveValue').value
                          .custId === item.custId
                      ">
														הכרטיס כבר נבחר בכרטיס קופה
													</ng-container>

						</span>


                                                    </div>


                                                </div>

                                                <div
                                                        *ngIf="item.isLastHistory"
                                                        style="
                                  height: 1px;
                                  background: #cacaca;
                                  padding: 0;
                                  position: absolute;
                                  bottom: -2px;
                                  right: 0;
                                  left: 0;
                                  z-index: 999;
                                "
                                                ></div>
                                            </div>
                                        </ng-container>
                                    </ng-template>
                                    <ng-template pTemplate="empty">
                                        <div
                                                class="p-helper-clearfix"
                                                style="font-size: 0.95em; padding: 0.3em 1em"
                                        >
                                            <!--                                        <ng-container *ngIf="!loaderGetCompanyCustomerDetails; else loader">-->
                                            <!--                                            <div>לא מצאת את הכרטיס שחיפשת?</div>-->
                                            <!--                                            <div>צרו כרטיס חדש בהנה"ח</div>-->
                                            <!--                                            <button class="button-link" style="padding: 0; font-size: inherit;"-->
                                            <!--                                                    (click)="getCompanyCustomerDetailsTimer(); $event.stopPropagation()">-->
                                            <!--                                                ולחצו על-->
                                            <!--                                                רענון הנתונים-->
                                            <!--                                            </button>-->
                                            <!--                                        </ng-container>-->

                                            <!--                                        <ng-container *ngIf="!loaderGetCompanyCustomerDetails; else loader">-->
                                            <!--                                            <div>לא מצאתם את הכרטיס שחיפשתם?</div>-->
                                            <!--                                            <div>צרו כרטיס חדש בחשבשבת.</div>-->
                                            <!--                                            <div>-->
                                            <!--                                                בנתיים ניתן לעדכן ידנית עד שנמשוך <br>-->
                                            <!--                                                את פרטי הכרטיס.-->
                                            <!--                                            </div>-->
                                            <!--                                            <button class="button-link" style="padding: 0; font-size: inherit;"-->
                                            <!--                                                    (click)="setValCartis(formDropdowns, 6);formDropdowns.putStyle(); getCompanyCustomerDetailsTimer(); $event.stopPropagation()">-->
                                            <!--                                                לעדכון ידני לחצו פה-->
                                            <!--                                            </button>-->
                                            <!--                                        </ng-container>-->

                                            <ng-container>
                                                <!--                                            <div>לא מצאת את הכרטיס?</div>-->
                                                <!--                                            <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                <!--                                            <div>-->
                                                <!--                                                ובנתיים-->
                                                <!--                                                <button class="button-link"-->
                                                <!--                                                        style="padding: 0; font-size: inherit; text-decoration: underline"-->
                                                <!--                                                        (click)="setValCartis(formDropdowns, 6);  getCompanyCustomerDetailsTimer();">-->
                                                <!--                                                    לחצו לעדכון-->
                                                <!--                                                </button>-->
                                                <!--                                            </div>-->

                                                <div>לא מצאתם את הכרטיס שחיפשתם?</div>
                                                <div>צרו כרטיס חדש בחשבשבת.</div>
                                                <div>
                                                    בינתיים ניתן לעדכן ידנית את
                                                    <strong style="font-weight: 700">
                                                        מפתח הכרטיס במדויק
                                                    </strong>
                                                    <br/>
                                                    עד שנמשוך את פרטי הכרטיס.
                                                </div>
                                                <button
                                                        (click)="
                          setValCartis(formDropdowns, 6);
                          getCompanyCustomerDetailsTimer()
                        "
                                                        class="button-link"
                                                        style="
                          padding: 0;
                          font-size: inherit;
                          text-decoration: underline;
                        "
                                                >
                                                    לעדכון ידני לחצו פה
                                                </button>
                                            </ng-container>
                                            <!--                                        <ng-template #loader>-->
                                            <!--                                            <div style="height: 84px;">-->
                                            <!--                                                <div class="loaderPercent blueCircle"-->
                                            <!--                                                     style="background: #e6e5e5;">-->
                                            <!--                                                    <div class="circle"></div>-->
                                            <!--                                                </div>-->
                                            <!--                                            </div>-->
                                            <!--                                            <div style="-->
                                            <!--    z-index: 999;-->
                                            <!--    position: absolute;-->
                                            <!--    bottom: 26px;-->
                                            <!--    font-size: 14.5px;-->
                                            <!--    text-align: center;-->
                                            <!--    font-weight: 600;-->
                                            <!--    left: 0;-->
                                            <!--    right: 0;-->
                                            <!--">-->
                                            <!--                                                מתבצע סינכרון-->
                                            <!--                                            </div>-->
                                            <!--                                        </ng-template>-->
                                        </div>
                                    </ng-template>
                                    <ng-template pTemplate="emptyfilter">
                                        <div
                                                class="p-helper-clearfix"
                                                style="font-size: 0.95em; padding: 0.3em 1em"
                                        >
                                            <!--                                        <ng-container *ngIf="!loaderGetCompanyCustomerDetails; else loader">-->
                                            <!--                                            <div>לא מצאת את הכרטיס שחיפשת?</div>-->
                                            <!--                                            <div>צרו כרטיס חדש בהנה"ח</div>-->
                                            <!--                                            <button class="button-link" style="padding: 0; font-size: inherit;"-->
                                            <!--                                                    (click)="getCompanyCustomerDetailsTimer(); $event.stopPropagation()">-->
                                            <!--                                                ולחצו על-->
                                            <!--                                                רענון הנתונים-->
                                            <!--                                            </button>-->
                                            <!--                                        </ng-container>-->

                                            <!--                                        <ng-container *ngIf="!loaderGetCompanyCustomerDetails; else loader">-->
                                            <!--                                            <div>לא מצאתם את הכרטיס שחיפשתם?</div>-->
                                            <!--                                            <div>צרו כרטיס חדש בחשבשבת.</div>-->
                                            <!--                                            <div>-->
                                            <!--                                                בנתיים ניתן לעדכן ידנית עד שנמשוך <br>-->
                                            <!--                                                את פרטי הכרטיס.-->
                                            <!--                                            </div>-->
                                            <!--                                            <button class="button-link" style="padding: 0; font-size: inherit;"-->
                                            <!--                                                    (click)="setValCartis(formDropdowns, 6);formDropdowns.putStyle(); getCompanyCustomerDetailsTimer(); $event.stopPropagation()">-->
                                            <!--                                                לעדכון ידני לחצו פה-->
                                            <!--                                            </button>-->
                                            <!--                                        </ng-container>-->

                                            <ng-container>
                                                <!--                                            <div>לא מצאת את הכרטיס?</div>-->
                                                <!--                                            <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                <!--                                            <div>-->
                                                <!--                                                ובנתיים-->
                                                <!--                                                <button class="button-link"-->
                                                <!--                                                        style="padding: 0; font-size: inherit; text-decoration: underline"-->
                                                <!--                                                        (click)="setValCartis(formDropdowns, 6);  getCompanyCustomerDetailsTimer();">-->
                                                <!--                                                    לחצו לעדכון-->
                                                <!--                                                </button>-->
                                                <!--                                            </div>-->

                                                <div>לא מצאתם את הכרטיס שחיפשתם?</div>
                                                <div>צרו כרטיס חדש בחשבשבת.</div>
                                                <div>
                                                    בינתיים ניתן לעדכן ידנית את
                                                    <strong style="font-weight: 700">
                                                        מפתח הכרטיס במדויק
                                                    </strong>
                                                    <br/>
                                                    עד שנמשוך את פרטי הכרטיס.
                                                </div>
                                                <button
                                                        (click)="
                          setValCartis(formDropdowns, 6);
                          getCompanyCustomerDetailsTimer()
                        "
                                                        class="button-link"
                                                        style="
                          padding: 0;
                          font-size: inherit;
                          text-decoration: underline;
                        "
                                                >
                                                    לעדכון ידני לחצו פה
                                                </button>
                                            </ng-container>
                                            <!--                                        <ng-template #loader>-->
                                            <!--                                            <div style="height: 84px;">-->
                                            <!--                                                <div class="loaderPercent blueCircle"-->
                                            <!--                                                     style="background: #e6e5e5;">-->
                                            <!--                                                    <div class="circle"></div>-->
                                            <!--                                                </div>-->
                                            <!--                                            </div>-->
                                            <!--                                            <div style="-->
                                            <!--    z-index: 999;-->
                                            <!--    position: absolute;-->
                                            <!--    bottom: 26px;-->
                                            <!--    font-size: 14.5px;-->
                                            <!--    text-align: center;-->
                                            <!--    font-weight: 600;-->
                                            <!--    left: 0;-->
                                            <!--    right: 0;-->
                                            <!--">-->
                                            <!--                                                מתבצע סינכרון-->
                                            <!--                                            </div>-->
                                            <!--                                        </ng-template>-->
                                        </div>
                                    </ng-template>
                                </app-dropdown-wrap>
                            </ng-container>
                            <ng-container *ngSwitchCase="'9'">
                                <p-dropdown
                                    #formDropdowns
                                    [autoDisplayFirst]="false"
                                    [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                    [formControl]="fc"
                                    [options]="
                  fileFieldsForm.get('21')?.get('effectiveValue').value === 1
                    ? docTypeOptions
                    : docTypeOptionsIncome
                "
                                    [style]="{ width: 'auto' }"
                                    appendTo="body"
                                    placeholder="בחירה"
                                ></p-dropdown>
                            </ng-container>

                            <ng-container *ngSwitchCase="'22'">
                                <app-dropdown-wrap
                                        [scrollHeight]="'135px'"
                                        #formDropdownsMaamCustids
                                        (onShow)="setDefOpt_maamCustids()"
                                        [autoDisplayFirst]="false"
                                        [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                        [formControl]="fc"
                                        [options]="userService.appData.userData.maamCustids"
                                        [style]="{ width: 'auto' }"
                                        [virtualScroll]="true"
                                        [virtualScrollItemSize]="33"
                                        appendTo="body"
                                        panelStyleClass="company-customer-dropdown-panel cardsDD cardsDD40"
                                        placeholder="בחירה"
                                >
                                    <ng-template let-item pTemplate="selectedItem">
                  <span
                      #spanElement
                      [pTooltip]="item?.label"
                      [tooltipDisabled]="
                      spanElement.offsetWidth >= spanElement.scrollWidth
                    "
                      style="vertical-align: middle; display: block"
                      tooltipPosition="top"
                  >{{ limitCharacters(item?.label) }}</span
                  >
                                    </ng-template>




                                    <ng-template let-item pTemplate="item">
                                        <div
                                                [ngStyle]="
                      (fileFieldsForm.get('6').get('effectiveValue') &&
                        fileFieldsForm.get('6').get('effectiveValue').value &&
                        fileFieldsForm.get('6').get('effectiveValue').value
                          .custId &&
                        fileFieldsForm.get('6').get('effectiveValue').value
                          .custId === item.value) ||
                      (fileFieldsForm.get('2').get('effectiveValue') &&
                        fileFieldsForm.get('2').get('effectiveValue').value &&
                        fileFieldsForm.get('2').get('effectiveValue').value
                          .custId &&
                        fileFieldsForm.get('2').get('effectiveValue').value
                          .custId === item.value) ||
                      (fileFieldsForm.get('30') &&
                        fileFieldsForm.get('30').get('effectiveValue') &&
                        fileFieldsForm.get('30').get('effectiveValue').value &&
                        fileFieldsForm.get('30').get('effectiveValue').value
                          .custId &&
                        fileFieldsForm.get('30').get('effectiveValue').value
                          .custId === item.value)
                        ? { opacity: '0.4', cursor: 'default' }
                        : ''
                    "
                                                class="p-helper-clearfix"
                                                style="flex-flow: column"
                                        >
                                            <div>
                      <span class="text-ellipsis">{{
                          item.label
                          }}</span>
                                            </div>

                                            <div style="font-size: 12px">
                        <span
                                class="text-ellipsis secondary"
                        >



                              <ng-container
                                      *ngIf="
                        fileFieldsForm.get('6').get('effectiveValue') &&
                        fileFieldsForm.get('6').get('effectiveValue').value &&
                        fileFieldsForm.get('6').get('effectiveValue').value
                          .custId &&
                        fileFieldsForm.get('6').get('effectiveValue').value
                          .custId === item.value
                      "
                                      style="
                        flex: none;
                        width: 100%;
                        height: auto;
                        line-height: normal;
                      "
                              >
                                                הכרטיס כבר נבחר בכרטיס נגדי
                                            </ng-container>
                                            <ng-container
                                                    *ngIf="
                        fileFieldsForm.get('2').get('effectiveValue') &&
                        fileFieldsForm.get('2').get('effectiveValue').value &&
                        fileFieldsForm.get('2').get('effectiveValue').value
                          .custId &&
                        fileFieldsForm.get('2').get('effectiveValue').value
                          .custId === item.value
                      "
                                                    style="
                        flex: none;
                        width: 100%;
                        height: auto;
                        line-height: normal;
                      "
                                            >
                                                הכרטיס כבר נבחר בכרטיס ספק/לקוח
                                            </ng-container>
                                            <ng-container
                                                    *ngIf="
                        fileFieldsForm.get('30') &&
                        fileFieldsForm.get('30').get('effectiveValue') &&
                        fileFieldsForm.get('30').get('effectiveValue').value &&
                        fileFieldsForm.get('30').get('effectiveValue').value
                          .custId &&
                        fileFieldsForm.get('30').get('effectiveValue').value
                          .custId === item.value
                      "
                                                    style="
                        flex: none;
                        width: 100%;
                        height: auto;
                        line-height: normal;
                      "
                                            >
                                                הכרטיס כבר נבחר בכרטיס קופה
                                            </ng-container>
                        </span>


                                            </div>

                                        </div>
                                    </ng-template>
                                    <ng-template pTemplate="empty">
                                        <div
                                                class="p-helper-clearfix" style="display: block;
    white-space: nowrap;
    overflow: hidden;
    line-height: 33px;
    text-overflow: ellipsis;
    margin: 0px 14px !important;">
                                            לא נמצאו נתונים
                                        </div>
                                    </ng-template>
                                </app-dropdown-wrap>
                            </ng-container>
                            <ng-container *ngSwitchCase="'10'">
                                <p-checkbox [binary]="true" [formControl]="fc" checkboxIcon="fa fa-check"></p-checkbox>
                            </ng-container>
                            <ng-container *ngSwitchCase="'12'">
                                <ng-container *ngIf="currencyList$ | async as currencyList">
                                    <!--                                <p-dropdown [formControl]="fc"-->
                                    <!--                                            [style]="{'width': 'auto'}"-->
                                    <!--                                            placeholder="בחירה"-->
                                    <!--                                            [options]="(fileDetailsSave.documentLogicType && (fileDetailsSave.documentLogicType === 'revaluation_expense_type' || fileDetailsSave.documentLogicType === 'revaluation_income_type' || fileDetailsSave.documentLogicType === 'matah_expense_type' || fileDetailsSave.documentLogicType === 'matah_income_type'))? arrCurrenciesWithoutILS : arrCurrencies"-->
                                    <!--                                            [group]="true"-->
                                    <!--                                            [autoDisplayFirst]="false"-->
                                    <!--                                             appendTo="body"-->
                                    <!--                                            #formDropdowns></p-dropdown>-->

                                    <p-dropdown
                                        #formDropdowns
                                        [autoDisplayFirst]="false"
                                        [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                        [formControl]="fc"
                                        [group]="true"
                                        [options]="
                    fileDetailsSave.documentLogicType &&
                    (fileDetailsSave.documentLogicType ===
                      'revaluation_expense_type' ||
                      fileDetailsSave.documentLogicType ===
                        'revaluation_income_type' ||
                      fileDetailsSave.documentLogicType ===
                        'matah_expense_type' ||
                      fileDetailsSave.documentLogicType === 'matah_income_type')
                      ? arrCurrenciesWithoutILS
                      : arrCurrencies
                  "
                                        [scrollHeight]="'185px'"
                                        [style]="{ width: 'auto' }"
                                        appendTo="body"
                                        panelStyleClass="company-customer-dropdown-panel cardsDD card195"
                                        placeholder="בחירה"
                                    >
                                        <ng-template let-item pTemplate="selectedItem">
                    <span
                        #spanElement
                        [pTooltip]="item.label + ' ' + item.value"
                        [tooltipDisabled]="
                        spanElement.offsetWidth >= spanElement.scrollWidth
                      "
                        style="
                        vertical-align: middle;
                        display: block;
                        white-space: nowrap;
                        overflow: hidden;
                        text-overflow: ellipsis;
                      "
                        tooltipPosition="top"
                    >{{ item.label }}</span
                    >
                                        </ng-template>
                                        <ng-template let-item pTemplate="item">
                                            <div class="p-helper-clearfix cust-item">
                                                <div
                                                        style="
                          display: flex;
                          align-items: center;
                          flex-direction: row;
                          justify-content: space-between;
                        "
                                                >
                                                    <span class="text-ellipsis">{{ item.label }}</span>
                                                </div>
                                            </div>
                                        </ng-template>
                                        <ng-template pTemplate="empty">
                                            <div
                                                    class="p-helper-clearfix" style="display: block;
    white-space: nowrap;
    overflow: hidden;
    line-height: 33px;
    text-overflow: ellipsis;
    margin: 0px 14px !important;">
                                                לא נמצאו נתונים
                                            </div>
                                        </ng-template>
                                        <ng-template pTemplate="footer">
                                            <div
                                                    class="p-helper-clearfix"
                                                    style="height: 34px; line-height: 34px"
                                            >
                                                <div
                                                        (click)="openModalAddCurrency()"
                                                        style="display: flex; cursor: pointer"
                                                >
                                                    <img
                                                            src="/assets/images/add.png"
                                                            style="
                            align-self: center;
                            flex: 0 0 auto;
                            -ms-flex: 0 0 auto;
                            margin: 0 0px 0px 4px;
                            cursor: pointer;
                          "
                                                    />
                                                    <label style="cursor: pointer"> הוספת מטבע </label>
                                                </div>
                                            </div>
                                        </ng-template>
                                    </p-dropdown>
                                </ng-container>
                            </ng-container>
                            <ng-container *ngSwitchCase="'21'">
                                <p-dropdown
                                    #formDropdowns
                                    [autoDisplayFirst]="false"
                                    [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                    [formControl]="fc"
                                    [options]="invoiceTypeOptions"
                                    [styleClass]="
                  fileFieldsForm.get('21')?.get('effectiveValue').value === 1
                    ? 'ddTypeExpense'
                    : fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      0
                    ? 'ddTypeIncome'
                    : 'ddTypeChoose'
                "
                                    [style]="{ width: 'auto' }"
                                    appendTo="body"
                                    placeholder="בחירה"
                                ></p-dropdown>
                            </ng-container>
                            <input
                                    *ngSwitchDefault
                                    [formControl]="fc"
                                    autocomplete="off"
                                    placeholder="יש להשלים"
                            />
                        </ng-container>
                    </ng-template>

                    <ng-template #loaderPercent>
                        <div class="loaderPercent">
                            <div class="circle"></div>
                        </div>
                    </ng-template>
                    <!--                </ng-template>-->
                </div>
            </ng-scrollbar>
        </div>
        <div #footer id="fixed-part-footer">
            <div [style.visibility]="
      fileDetailsSave && fileDetailsSave.fieldsHierarchy
                  ? 'visible'
                  : 'hidden'
              "
                 class="line-sep">&nbsp;
            </div>
            <div [style.visibility]="
      fileDetailsSave && fileDetailsSave.fieldsHierarchy
                  ? 'visible'
                  : 'hidden'
              "
                 class="controls-line">
                <button
                    #moreActionsBtn
                    (click)="moreActions.toggle($event)"
                    class="button-dark contour"
                >
                    <i>{{ 'פעולות נוספות' }}</i>
                </button>
                <button
                        (click)="documentApprove($event.srcElement)"
                        [disabled]="!fileDetailsSave || (fileDetailsSave && !fileDetailsSave.approveActive)"
                        class="button-dark"
                >
                    <mat-icon
                            style="
                vertical-align: middle;
                width: 22px;
                height: 22px;
                margin-top: -4px;
              "
                    >done
                    </mat-icon>
                    <i>{{ 'actions.approve' | translate }}</i>
                </button>
                <p-overlayPanel
                    #moreActions
                    [style]="{
              'min-width': moreActionsBtn.getBoundingClientRect().width + 'px'
            }"
                    appendTo="body"
                    styleClass="ocr-additional-actions-ov"
                >
                    <mat-list *ngIf="fileDetails$ | async as fileDetails" dense>
                        <mat-list-item>
                            <button
                                    (click)="
                    docFoldersShow.emit({
                      companyId:
                        userService.appData?.userData?.companySelect?.companyId,
                      fileId: _fileScanView?.fileId
                    });
                    moreActions.hide()
                  "
                                    [disabled]="fileDetails.status === 'ARCHIVE'"
                                    mat-button
                            >
                                <mat-icon svgIcon="bizibox_archive"></mat-icon>
                                העברה לארכיון
                            </button>
                        </mat-list-item>
                        <mat-list-item
                                *ngIf="
                  userService.appData?.userData?.companies &&
                  userService.appData?.userData?.companies.length > 1
                "
                        >
                            <button
                                    (click)="docCompanyReplacement.show(); moreActions.hide()"
                                    mat-button
                            >
                                <mat-icon style="font-size: 18px">swap_calls</mat-icon>
                                מעבר לחברה אחרת
                            </button>
                        </mat-list-item>
                        <mat-list-item *ngIf="(fileDetails$ | async)?.pages?.length === 1">
                            <button
                                    (click)="splitContent(); moreActions.hide()"
                                    [disabled]="!(currentPageCachedContent$ | async)"
                                    mat-button
                            >
                                <mat-icon svgIcon="crop"></mat-icon>
                                הפרדת חשבוניות
                            </button>
                        </mat-list-item>
                        <mat-list-item>
                            <button
                                    (click)="downloadContent(); moreActions.hide()"
                                    [disabled]="!(currentPageCachedContent$ | async)"
                                    mat-button
                            >
                                <mat-icon svgIcon="bizibox_download"></mat-icon>
                                הורדה
                            </button>
                        </mat-list-item>
                        <mat-list-item>
                            <button
                                    (click)="downloadContent(true); moreActions.hide()"
                                    [disabled]="!(currentPageCachedContent$ | async)"
                                    mat-button
                            >
                                <mat-icon svgIcon="print"></mat-icon>
                                הדפסה
                            </button>
                        </mat-list-item>
                        <ng-container
                                *ngIf="{
                  pages: (fileDetails$ | async)?.pages
                } as pagesNavData"
                        >
                            <mat-list-item *ngIf="pagesNavData.pages?.length > 1">
                                <button
                                        (click)="
                      getChildren(pagesNavData.pages); moreActions.hide()
                    "
                                        [disabled]="!(currentPageCachedContent$ | async)"
                                        mat-button
                                >
                    <span
                            style="
                        font-size: inherit;
                        width: 1em;
                        height: 1em;
                        margin-left: 6px;
                      "
                    >&#9986;</span>

                                    פיצול
                                </button>
                            </mat-list-item>
                        </ng-container>
                        <mat-divider></mat-divider>
                        <mat-list-item>
                            <button
                                    (click)="
                    docToSend.emit(_fileScanView?.fileId); moreActions.hide()
                  "
                                    mat-button
                            >
                                <mat-icon
                                        [svgIcon]="'send'"
                                        style="font-size: 18px"
                                ></mat-icon>
                                שליחת הודעה ללקוח
                            </button>
                        </mat-list-item>
                        <mat-list-item>
                            <button
                                    (click)="
                    docRemoveFileShow.emit(_fileScanView?.fileId);
                    moreActions.hide()
                  "
                                    mat-button
                            >
                                <mat-icon
                                        [svgIcon]="'deleteInvoice'"
                                        style="font-size: 18px"
                                ></mat-icon>
                                הסרת מסמך
                            </button>
                        </mat-list-item>
                        <mat-list-item>
                            <button
                                    (click)="
                    docNoteShow.emit({
                      fileDetails: fileDetails,
                      fileId: _fileScanView?.fileId
                    });
                    moreActions.hide()
                  "
                                    mat-button
                            >
                                <mat-icon
                                        [svgIcon]="'note'"
                                        style="font-size: 18px"
                                ></mat-icon>
                                {{ !!fileDetails.note ? 'עריכת פתק' : 'הוספת פתק' }}
                            </button>
                        </mat-list-item>
                        <mat-list-item>
                            <button
                                    (click)="toggleFlagOn(fileDetails); moreActions.hide()"
                                    mat-button
                            >
                                <mat-icon
                                        [svgIcon]="'bizibox_flag'"
                                        style="font-size: 18px"
                                ></mat-icon>
                                {{ !!fileDetails.flag ? 'הורדת טיפול' : 'להמשך טיפול' }}
                            </button>
                        </mat-list-item>
                    </mat-list>
                </p-overlayPanel>
            </div>

            <div class="docs-iterator">
                <ng-container *ngIf="navigatorData$ | async as navigatorData">
                    <button
                            (click)="setFile(navigatorData.forwardLink)"
                            [disabled]="!navigatorData.forwardLink"
                            mat-icon-button
                    >
                        <mat-icon>chevron_right</mat-icon>
                    </button>
                    <label class="forceLTR"
                    ><b>{{ navigatorData.currDocNo }}</b> /
                        {{ navigatorData.total }}</label
                    >
                    <button
                            (click)="setFile(navigatorData.backwardLink)"
                            [disabled]="!navigatorData.backwardLink"
                            mat-icon-button
                    >
                        <mat-icon>chevron_left</mat-icon>
                    </button>
                </ng-container>
            </div>
        </div>
    </div>

    <div *ngIf="showSplit" class="fixed-part showSplit">
        <ng-container
                *ngIf="{
        currentPage: (currentPage | async),
        pages: (fileDetails$ | async)?.pages
      } as pagesNavData"
        >
            <div #fixedSlider class="showEmptyFields">
                <p (click)="splitAllPages(pagesNavData.pages)" class="splitAllPages">
                    <i>&#9986;</i>
                    פיצול כל העמודים
                </p>
                <div class="actionsAllPages">
                    <button
                            (click)="
              docFoldersShow.emit({
                companyId:
                  userService.appData?.userData?.companySelect?.companyId,
                fileId: _fileScanView?.fileId
              })
            "
                            mat-button
                    >
                        <mat-icon
                                style="width: 23px; height: 28px"
                                svgIcon="bizibox_archive"
                        ></mat-icon>
                    </button>
                    <!--                    <button mat-button-->
                    <!--                            (click)="rotateAllPages(pagesNavData.pages)">-->
                    <!--                        <mat-icon style="    width: 23px;-->
                    <!--    height: 28px;"-->
                    <!--                                  svgIcon="reload"></mat-icon>-->
                    <!--                    </button>-->
                </div>
            </div>

            <div class="wrap-scroll" style="position: relative">
                <div class="loaderPercent" *ngIf="splitDisabled">
                    <div class="circle"></div>
                </div>
                <div
                    #fieldsList
                    (scroll)="hideOpenedPanels()"
                    [appScrollHeight]="
            content.getBoundingClientRect().top +
            footer.getBoundingClientRect().height +
            fixedSlider.getBoundingClientRect().height +
            2
          "
                    class="scrollbar-dynamic"
                >
                    <div
                            *ngFor="let page of pagesNavData.pages; index as i; last as isLast"
                            [id]="page?.id"
                            class="pages"
                    >
                        <ng-container
                                *ngIf="(cachedContent$ | async)[i] | async as imgBlob"
                        >
                            <div
                                    (click)="navigateToDocumentPage(i + 1)"
                                    [class.active]="i + 1 === pagesNavData.currentPage"
                                    class="page"
                            >
                                <div class="numberPage">{{ i + 1 }}</div>
                                <div class="wrapImg">
                                    <img
                                            (load)="
                      !page?.rotate?.image
                        ? imgBlobSetCanvas(imgBlob, page)
                        : null
                    "
                                            [src]="imgBlob"
                                            alt="pageImage"
                                    />

                                    <ng-container *ngIf="page?.rotate?.image">
                                        <div class="hoverBtns">
                                            <div>
                                                <button
                                                        (click)="
                            docFoldersShow.emit({
                              companyId:
                                userService.appData?.userData?.companySelect
                                  ?.companyId,
                              fileId: _fileScanView?.fileId,
                              childId: page?.id,
                              isOnlyOne: pagesNavData.pages.length === 1
                            });
                            $event.stopPropagation()
                          "
                                                >
                                                    <mat-icon
                                                            style="width: 12px; height: 10px"
                                                            svgIcon="bizibox_archive"
                                                    ></mat-icon>
                                                </button>
                                                <!--                                                                                                <button-->
                                                <!--                                                                                                        (click)="descButton(page, i); $event.stopPropagation()">-->
                                                <!--                                                                                                    <mat-icon style="width: 12px;-->
                                                <!--                                                    height: 12px;-->
                                                <!--                                                    transform: rotate(-50deg);"-->
                                                <!--                                                                                                              svgIcon="reloadRotate"></mat-icon>-->
                                                <!--                                                                                                </button>-->
                                                <!--                                                <button-->
                                                <!--                                                        (click)="incButton(page, i); $event.stopPropagation()">-->
                                                <!--                                                    <mat-icon style="width: 12px;-->
                                                <!--    height: 12px;-->
                                                <!--       transform: scaleX(-1) rotate(-40deg);"-->
                                                <!--                                                              svgIcon="reloadRotate"></mat-icon>-->
                                                <!--                                                </button>-->
                                            </div>
                                        </div>
                                    </ng-container>
                                </div>
                            </div>
                            <div
                                    (click)="page.split = !page.split"
                                    *ngIf="!isLast"
                                    [class.active]="page.split"
                                    [pTooltip]="
                  page.split ? 'לחיצה תאחד את המסמכים' : 'לחיצה תפצל את המסמכים'
                "
                                    class="splitLine"
                                    tooltipPosition="bottom"
                            >
                                <div class="line">&nbsp;</div>
                                <div class="splitIcon">&#9986;</div>
                            </div>
                        </ng-container>
                    </div>
                </div>
            </div>
            <div #footer id="fixed-part-footer">
                <div class="controls-line">
                    <button (click)="showSplit = false" class="button-link">
                        {{ 'actions.cancellation' | translate }}
                    </button>
                    <button (click)="filesSplit(pagesNavData.pages)"
                            [disabled]="splitDisabled"
                            class="button-dark">
                        {{ 'actions.save' | translate }}
                    </button>
                </div>
            </div>
        </ng-container>
    </div>

    <!--    draggable="true"-->
    <!--    data-item="0"-->
    <!--    (dragstart)="drag_start($event)"-->
    <!--    (dragenter)="handleDragEnter($event)"-->
    <!--    (dragend)="handleDragEnd($event)"-->

    <!--    'top': elementWrapCenter.getBoundingClientRect().top + 'px'-->
    <div
        #elementWrapCenter
        style="
      position: relative;
      flex: 100%;
      background-color: rgba(232, 231, 231, 0.6509803921568628);
    "
    >
        <ng-container *ngIf="show_approveActiveCopy">
            <div
                #imgTopOrder
                [ngStyle]="{ width: elementWrapCenter.clientWidth + 'px', top: '0px' }"
                cdkDrag
                cdkDragBoundary=".containerPage"
                class="dragme"
                id="dragme"
                style="
          position: absolute;
          z-index: 99;
          background: #ffffff;
          left: 0;
          display: none;
          right: auto;
        "
            >
                <div
                        [class.isMatah]="isMatah"
                        class="imgTopOrder editOrderModal"
                        style="width: auto; z-index: 99; left: 0; right: 0; top: 0"
                >
                    <div
                            class="table"
                            style="margin: 0; border-bottom: 1px solid #cdcdcd"
                    >
                        <div class="header">
                            <div>תאריך</div>
                            <div class="border"></div>
                            <div>
                                {{ !fileFieldsForm.get('40') ? 'אחוז מע"מ' : 'ס.תנועה' }}
                            </div>
                            <div class="border"></div>
                            <div>חובה</div>
                            <div class="border"></div>
                            <div>זכות</div>
                            <ng-container *ngIf="isMatah">
                                <div class="border"></div>
                                <div>(₪)</div>
                                <div>(₪)</div>
                                <div class="border"></div>
                                <div>({{ currencySign }})</div>
                                <div>({{ currencySign }})</div>
                            </ng-container>
                            <div class="border"></div>
                            <div>
                                פרטים נוספים

                                <div
                                        (click)="
                    show_approveActiveCopy = false;
                    fileDetailsSave.approveActiveCopy = false;
                    sidebarImgsDescList = false;
                    removeEventListener_draganddrop()
                  "
                                        class="closeModalInvoice"
                                >
                                    <mat-icon
                                            style="color: #022258; height: 15px; width: 15px"
                                            svgIcon="closeIcon"
                                    ></mat-icon>
                                </div>
                            </div>
                        </div>
                        <div
                                [ngStyle]="{
                height:
                  sidebarImgsDescList &&
                  (((!sidebarImgsDescList.payments ||
                    (sidebarImgsDescList.payments &&
                      !sidebarImgsDescList.payments.length)) &&
                    sidebarImgsDescList.invoices &&
                    sidebarImgsDescList.invoices.length === 1) ||
                    ((!sidebarImgsDescList.invoices ||
                      (sidebarImgsDescList.invoices &&
                        !sidebarImgsDescList.invoices.length)) &&
                      sidebarImgsDescList.payments &&
                      sidebarImgsDescList.payments.length === 1))
                    ? '92px'
                    : sidebarImgsDescList &&
                      (((!sidebarImgsDescList.payments ||
                        (sidebarImgsDescList.payments &&
                          !sidebarImgsDescList.payments.length)) &&
                        sidebarImgsDescList.invoices &&
                        sidebarImgsDescList.invoices.length === 2) ||
                        ((!sidebarImgsDescList.invoices ||
                          (sidebarImgsDescList.invoices &&
                            !sidebarImgsDescList.invoices.length)) &&
                          sidebarImgsDescList.payments &&
                          sidebarImgsDescList.payments.length === 2) ||
                        (sidebarImgsDescList.invoices &&
                          sidebarImgsDescList.invoices.length === 1 &&
                          sidebarImgsDescList.payments &&
                          sidebarImgsDescList.payments.length === 1))
                    ? 'auto'
                    : 'auto'
              }"
                                class="scroll-chrome scrollbar-dynamic"
                                style="max-height: 216px; position: relative; overflow: auto"
                        >
                            <ng-template #loaders>
                                <div style="height: 96px; background: #ffffff">
                                    <div class="loaderPercent">
                                        <div class="circle"></div>
                                    </div>
                                </div>
                            </ng-template>
                            <ng-container *ngIf="sidebarImgsDescList; else loaders">
                                <ng-container *ngIf="sidebarImgsDescList.invoices">
                                    <div
                                            *ngFor="
                      let item of sidebarImgsDescList.invoices;
                      let i = index
                    "
                                            [class.isChanged]="item.isChanged"
                                            [class.isDeleted]="item.isDeleted"
                                            [matTooltip]="
                      item.isDeleted
                        ? 'הפקודה בוטלה בחשבשבת'
                        : item.isChanged
                        ? item.tooltipText
                        : null
                    "
                                            class="row"
                                            matTooltipClass="tooltipTextChanged"
                                            matTooltipPosition="below"
                                    >
                                        <div>
                                            <div class="date flex bold" style="margin-bottom: 10px">
                                                <p>חשבונית</p>
                                            </div>
                                            <div
                                                    (click)="item.opened = !item.opened"
                                                    class="date flex"
                                                    style="
                          margin-bottom: 10px;
                          justify-content: space-between;
                        "
                                            >
                                                <img
                                                        *ngIf="item.dateValue || item.thirdDate"
                                                        [src]="
                            item.opened
                              ? '/assets/images/stateOpen.png'
                              : '/assets/images/stateClose.png'
                          "
                                                        height="7"
                                                        style="
                            width: 11px;
                            height: 7px;
                            vertical-align: middle;
                            cursor: pointer;
                            margin-left: 1px;
                          "
                                                        width="11"
                                                />
                                                <p>תאריך</p>

                                                <div>
                                                    {{ item.invoiceDate | date: 'dd/MM/yy' }}
                                                </div>
                                            </div>
                                            <div
                                                    *ngIf="item.opened && item.dateValue"
                                                    class="date flex"
                                                    style="
                          margin-bottom: 10px;
                          justify-content: space-between;
                        "
                                            >
                                                <p>תאריך ערך</p>

                                                <div>
                                                    {{ item.dateValue | date: 'dd/MM/yy' }}
                                                </div>
                                            </div>
                                            <div
                                                    *ngIf="item.opened && item.thirdDate"
                                                    class="date flex"
                                                    style="
                          margin-bottom: 10px;
                          justify-content: space-between;
                        "
                                            >
                                                <p>תאריך נוסף</p>

                                                <div>
                                                    {{ item.thirdDate | date: 'dd/MM/yy' }}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="border"></div>
                                        <div>
                                            <ng-container *ngIf="!fileFieldsForm.get('40')">
                                                <div *ngIf="item.maamPrc; else empty">
                                                    {{ item.maamPrc.label }}
                                                </div>
                                            </ng-container>

                                            <ng-container *ngIf="fileFieldsForm.get('40')">
                                                <div *ngIf="item.transTypeCode; else empty">
                                                    {{ item.transTypeCode }}
                                                </div>
                                            </ng-container>
                                        </div>
                                        <div class="border"></div>

                                        <ng-container
                                                *ngTemplateOutlet="
                        (!sidebarImgsDescList.showUpside &&
                          item.invoiceType === 1) ||
                        (sidebarImgsDescList.showUpside &&
                          item.invoiceType === 0)
                          ? expenseTemp
                          : incomeTemp
                      "
                                        >
                                        </ng-container>
                                        <div class="border"></div>
                                        <ng-container
                                                *ngTemplateOutlet="
                        (!sidebarImgsDescList.showUpside &&
                          item.invoiceType === 1) ||
                        (sidebarImgsDescList.showUpside &&
                          item.invoiceType === 0)
                          ? incomeTemp
                          : expenseTemp
                      "
                                        >
                                        </ng-container>

                                        <ng-container *ngIf="isMatah">
                                            <div class="border"></div>
                                            <ng-container
                                                    *ngTemplateOutlet="
                          (!sidebarImgsDescList.showUpside &&
                            item.invoiceType === 1) ||
                          (sidebarImgsDescList.showUpside &&
                            item.invoiceType === 0)
                            ? expenseTempSums
                            : incomeTempSums
                        "
                                            >
                                            </ng-container>
                                            <ng-container
                                                    *ngTemplateOutlet="
                          (!sidebarImgsDescList.showUpside &&
                            item.invoiceType === 1) ||
                          (sidebarImgsDescList.showUpside &&
                            item.invoiceType === 0)
                            ? incomeTempSums
                            : expenseTempSums
                        "
                                            >
                                            </ng-container>

                                            <div class="border"></div>
                                            <ng-container
                                                    *ngTemplateOutlet="
                          (!sidebarImgsDescList.showUpside &&
                            item.invoiceType === 1) ||
                          (sidebarImgsDescList.showUpside &&
                            item.invoiceType === 0)
                            ? expenseMatahTemp
                            : incomeMatahTemp
                        "
                                            >
                                            </ng-container>
                                            <ng-container
                                                    *ngTemplateOutlet="
                          (!sidebarImgsDescList.showUpside &&
                            item.invoiceType === 1) ||
                          (sidebarImgsDescList.showUpside &&
                            item.invoiceType === 0)
                            ? incomeMatahTemp
                            : expenseMatahTemp
                        "
                                            >
                                            </ng-container>
                                        </ng-container>

                                        <div class="border"></div>
                                        <div style="position: relative">
                                            <div
                                                    (click)="item.openedAsm = !item.openedAsm"
                                                    class="flex"
                                                    style="margin-bottom: 10px"
                                            >
                                                <img
                                                        *ngIf="item.asmachta2 || item.asmachta3"
                                                        [src]="
                            item.openedAsm
                              ? '/assets/images/stateOpen.png'
                              : '/assets/images/stateClose.png'
                          "
                                                        height="7"
                                                        style="
                            width: 11px;
                            height: 7px;
                            vertical-align: middle;
                            cursor: pointer;
                            margin-right: -16px;
                            margin-left: 4px;
                          "
                                                        width="11"
                                                />
                                                <p style="width: 64px">{{ fieldNameAsmachta }}</p>
                                                <div style="width: 65px; margin-left: 20px">
                                                    {{ item.asmachta }}
                                                </div>
                                            </div>
                                            <div
                                                    *ngIf="item.asmachta2 && item.openedAsm"
                                                    class="flex"
                                                    style="margin-bottom: 10px"
                                            >
                                                <p style="width: 64px">
                                                    אסמכ.
                                                    {{ fieldNameAsmachta === 'אסמכתא 1' ? '2' : '1' }}
                                                </p>
                                                <div style="width: 65px; margin-left: 20px">
                                                    {{ item.asmachta2 }}
                                                </div>
                                            </div>
                                            <div
                                                    *ngIf="item.asmachta3 && item.openedAsm"
                                                    class="flex"
                                                    style="margin-bottom: 10px"
                                            >
                                                <p style="width: 64px">אסמכ. 3</p>
                                                <div style="width: 65px; margin-left: 20px">
                                                    {{ item.asmachta3 }}
                                                </div>
                                            </div>

                                            <div class="flex">
                                                <p style="width: 64px">פרטים</p>
                                                <div
                                                    #inputElement
                                                    [pTooltip]="item.details"
                                                    [tooltipDisabled]="
                            inputElement.offsetWidth >= inputElement.scrollWidth
                          "
                                                    class="text-ellipsis"
                                                    style="max-width: 200px"
                                                    tooltipPosition="top"
                                                >
                                                    {{ item.details }}
                                                </div>
                                            </div>
                                        </div>

                                        <ng-template #expenseTemp>
                                            <div>
                                                <div
                                                        class="flex"
                                                        style="
                            margin-bottom: 10px;
                            justify-content: space-between;
                          "
                                                >
                                                    <div
                                                            [ngStyle]="{
                              width: isMatah ? '170px' : '170px',
                              'min-width': isMatah ? '170px' : '170px'
                            }"
                                                    >
                                                        <div
                                                            #inputElement
                                                            [pTooltip]="
                                item.oppositeCust
                                  ? item.oppositeCust.cartisName
                                  : ''
                              "
                                                            [tooltipDisabled]="
                                inputElement.offsetWidth >=
                                inputElement.scrollWidth
                              "
                                                            class="text-ellipsis"
                                                            tooltipPosition="top"
                                                        >
                                                            <p *ngIf="item.oppositeCust; else empty">
                                                                {{
                                                                item.oppositeCust
                                                                    ? item.oppositeCust.cartisName
                                                                    : ''
                                                                }}
                                                            </p>
                                                        </div>
                                                    </div>
                                                    <div
                                                            style="
                              align-self: stretch;
                              width: 11px;
                              height: auto;
                            "
                                                    ></div>
                                                    <div
                                                            *ngIf="!isMatah"
                                                            class="input disabled"
                                                            style="width: 85px; display: flex"
                                                    >
                                                        <app-sum-view
                                                                *ngIf="item.totalBeforeMaam"
                                                                [sum]="item.totalBeforeMaam"
                                                                class="text-item text-ellipsis"
                                                        ></app-sum-view>

                                                        <p
                                                                *ngIf="!item.totalBeforeMaam"
                                                                class="text-item text-ellipsis"
                                                        >
                                                            0
                                                        </p>
                                                    </div>
                                                </div>

                                                <div
                                                        *ngIf="
                            ((!item.maamPrc || item.maamPrc.value === 'NONE') &&
                              item.totalMaam) ||
                            (item.maamPrc && item.maamPrc.value !== 'NONE')
                          "
                                                        class="flex"
                                                        style="justify-content: space-between"
                                                >
                                                    <div
                                                            [ngStyle]="{
                              width: isMatah ? '170px' : '170px',
                              'min-width': isMatah ? '170px' : '170px'
                            }"
                                                    >
                                                        <div
                                                            #inputElement
                                                            [pTooltip]="
                                item.cartisMaam
                                  ? item.cartisMaam.cartisName
                                  : ''
                              "
                                                            [tooltipDisabled]="
                                inputElement.offsetWidth >=
                                inputElement.scrollWidth
                              "
                                                            class="text-ellipsis"
                                                            tooltipPosition="top"
                                                        >
                                                            <p *ngIf="item.cartisMaam; else empty">
                                                                {{
                                                                item.cartisMaam
                                                                    ? item.cartisMaam.cartisName
                                                                    : ''
                                                                }}
                                                            </p>
                                                        </div>
                                                    </div>
                                                    <div
                                                            *ngIf="!isMatah"
                                                            style="
                              align-self: stretch;
                              width: 11px;
                              height: auto;
                            "
                                                    ></div>
                                                    <div
                                                            *ngIf="!isMatah"
                                                            class="input disabled"
                                                            style="width: 85px; display: flex"
                                                    >
                                                        <app-sum-view
                                                                *ngIf="item.totalMaam"
                                                                [sum]="item.totalMaam"
                                                                class="text-item text-ellipsis"
                                                        ></app-sum-view>

                                                        <p
                                                                *ngIf="!item.totalMaam"
                                                                class="text-item text-ellipsis"
                                                        >
                                                            0
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </ng-template>

                                        <ng-template #incomeTemp>
                                            <div>
                                                <div
                                                        class="flex"
                                                        style="
                            margin-bottom: 10px;
                            justify-content: space-between;
                          "
                                                >
                                                    <div
                                                            [ngStyle]="{
                              width: isMatah ? '170px' : '170px',
                              'min-width': isMatah ? '170px' : '170px'
                            }"
                                                    >
                                                        <div
                                                            #inputElement
                                                            [pTooltip]="
                                item.custId ? item.custId.cartisName : ''
                              "
                                                            [tooltipDisabled]="
                                inputElement.offsetWidth >=
                                inputElement.scrollWidth
                              "
                                                            class="text-ellipsis"
                                                            tooltipPosition="top"
                                                        >
                                                            <p *ngIf="item.custId; else empty">
                                                                {{ item.custId ? item.custId.cartisName : '' }}
                                                            </p>
                                                        </div>
                                                    </div>

                                                    <div
                                                            *ngIf="!isMatah"
                                                            style="
                              align-self: stretch;
                              width: 11px;
                              height: auto;
                            "
                                                    ></div>
                                                    <div
                                                            *ngIf="!isMatah"
                                                            class="input disabled"
                                                            style="width: 85px; display: flex"
                                                    >
                                                        <app-sum-view
                                                                *ngIf="item.totalIncludeMaam"
                                                                [sum]="item.totalIncludeMaam"
                                                                class="text-item text-ellipsis"
                                                        ></app-sum-view>

                                                        <p
                                                                *ngIf="!item.totalIncludeMaam"
                                                                class="text-item text-ellipsis"
                                                        >
                                                            0
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </ng-template>

                                        <ng-template #expenseTempSums>
                                            <div>
                                                <div>
                                                    <div
                                                            class="input disabled"
                                                            style="width: 85px; display: flex"
                                                    >
                                                        <app-sum-view
                                                                *ngIf="item.totalBeforeMaam"
                                                                [sum]="item.totalBeforeMaam"
                                                                class="text-item text-ellipsis"
                                                        ></app-sum-view>

                                                        <p
                                                                *ngIf="!item.totalBeforeMaam"
                                                                class="text-item text-ellipsis"
                                                        >
                                                            0
                                                        </p>
                                                    </div>
                                                </div>
                                                <div
                                                        *ngIf="
                            ((!item.maamPrc || item.maamPrc.value === 'NONE') &&
                              item.totalMaam) ||
                            (item.maamPrc && item.maamPrc.value !== 'NONE')
                          "
                                                >
                                                    <div
                                                            class="input disabled"
                                                            style="width: 85px; display: flex"
                                                    >
                                                        <app-sum-view
                                                                *ngIf="item.totalMaam"
                                                                [sum]="item.totalMaam"
                                                                class="text-item text-ellipsis"
                                                        ></app-sum-view>

                                                        <p
                                                                *ngIf="!item.totalMaam"
                                                                class="text-item text-ellipsis"
                                                        >
                                                            0
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </ng-template>
                                        <ng-template #incomeTempSums>
                                            <div>
                                                <div>
                                                    <div
                                                            class="input disabled"
                                                            style="width: 85px; display: flex"
                                                    >
                                                        <app-sum-view
                                                                *ngIf="item.totalIncludeMaam"
                                                                [sum]="item.totalIncludeMaam"
                                                                class="text-item text-ellipsis"
                                                        ></app-sum-view>

                                                        <p
                                                                *ngIf="!item.totalIncludeMaam"
                                                                class="text-item text-ellipsis"
                                                        >
                                                            0
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </ng-template>

                                        <ng-template #expenseMatahTemp>
                                            <div style="position: relative; align-self: stretch">
                                                <div>
                                                    <div>
                                                        <div
                                                                class="input disabled"
                                                                style="width: 85px; display: flex"
                                                        >
                                                            <app-sum-view
                                                                    *ngIf="item.totalBeforeMaamMatah"
                                                                    [sum]="item.totalBeforeMaamMatah"
                                                                    class="text-item text-ellipsis"
                                                            ></app-sum-view>

                                                            <p
                                                                    *ngIf="!item.totalBeforeMaamMatah"
                                                                    class="text-item text-ellipsis"
                                                            >
                                                                0
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div>
                                                    <div
                                                            class="input disabled"
                                                            style="width: 85px; display: flex"
                                                    >
                                                        <app-sum-view
                                                                *ngIf="item.totalMaamMatah"
                                                                [sum]="item.totalMaamMatah"
                                                                class="text-item text-ellipsis"
                                                        ></app-sum-view>

                                                        <p
                                                                *ngIf="!item.totalMaamMatah"
                                                                class="text-item text-ellipsis"
                                                        >
                                                            0
                                                        </p>
                                                    </div>
                                                </div>

                                                <i
                                                        *ngIf="
                            !(
                              (!sidebarImgsDescList.showUpside &&
                                item.invoiceType === 1) ||
                              (sidebarImgsDescList.showUpside &&
                                item.invoiceType === 0)
                            )
                          "
                                                        [matTooltip]="'לפי שער יציג של ' + rate + ' ₪'"
                                                        class="fas fa-globe"
                                                        matTooltipPosition="below"
                                                        style="
                            position: absolute;
                            bottom: 5px;
                            left: 0px;
                            cursor: pointer;
                          "
                                                ></i>
                                            </div>
                                        </ng-template>
                                        <ng-template #incomeMatahTemp>
                                            <div style="position: relative; align-self: stretch">
                                                <div
                                                        class="input disabled"
                                                        style="width: 85px; display: flex"
                                                >
                                                    <app-sum-view
                                                            *ngIf="item.matahAmount"
                                                            [sum]="item.matahAmount"
                                                            class="text-item text-ellipsis"
                                                    ></app-sum-view>

                                                    <p
                                                            *ngIf="!item.matahAmount"
                                                            class="text-item text-ellipsis"
                                                    >
                                                        0
                                                    </p>
                                                </div>
                                                <i
                                                        *ngIf="
                            (!sidebarImgsDescList.showUpside &&
                              item.invoiceType === 1) ||
                            (sidebarImgsDescList.showUpside &&
                              item.invoiceType === 0)
                          "
                                                        [matTooltip]="'לפי שער יציג של ' + rate + ' ₪'"
                                                        class="fas fa-globe"
                                                        matTooltipPosition="below"
                                                        style="
                            position: absolute;
                            bottom: 5px;
                            left: 0px;
                            cursor: pointer;
                          "
                                                ></i>
                                            </div>
                                        </ng-template>
                                        <ng-template #empty>
                                            <div>&nbsp;</div>
                                        </ng-template>
                                    </div>
                                </ng-container>
                                <ng-container *ngIf="sidebarImgsDescList.payments">
                                    <div
                                            *ngFor="
                      let item of sidebarImgsDescList.payments;
                      let i = index
                    "
                                            [class.isChanged]="item.isChanged"
                                            [class.isDeleted]="item.isDeleted"
                                            [matTooltip]="
                      item.isDeleted
                        ? 'הפקודה בוטלה בחשבשבת'
                        : item.isChanged
                        ? 'הפקודה שונתה בחשבשבת'
                        : null
                    "
                                            class="row"
                                            matTooltipClass="tooltipTextChanged"
                                            matTooltipPosition="below"
                                    >
                                        <div>
                                            <div class="date flex bold" style="margin-bottom: 10px">
                                                <p>קבלה</p>
                                            </div>
                                            <div
                                                    (click)="item.opened = !item.opened"
                                                    class="date flex"
                                                    style="
                          margin-bottom: 10px;
                          justify-content: space-between;
                        "
                                            >
                                                <img
                                                        *ngIf="item.dateValue || item.thirdDate"
                                                        [src]="
                            item.opened
                              ? '/assets/images/stateOpen.png'
                              : '/assets/images/stateClose.png'
                          "
                                                        height="7"
                                                        style="
                            width: 11px;
                            height: 7px;
                            vertical-align: middle;
                            cursor: pointer;
                            margin-left: 1px;
                          "
                                                        width="11"
                                                />
                                                <p>תאריך</p>

                                                <div>
                                                    {{ item.invoiceDate | date: 'dd/MM/yy' }}
                                                </div>
                                            </div>
                                            <div
                                                    *ngIf="item.opened && item.dateValue"
                                                    class="date flex"
                                                    style="
                          margin-bottom: 10px;
                          justify-content: space-between;
                        "
                                            >
                                                <p>תאריך ערך</p>

                                                <div>
                                                    {{ item.dateValue | date: 'dd/MM/yy' }}
                                                </div>
                                            </div>
                                            <div
                                                    *ngIf="item.opened && item.thirdDate"
                                                    class="date flex"
                                                    style="
                          margin-bottom: 10px;
                          justify-content: space-between;
                        "
                                            >
                                                <p>תאריך נוסף</p>

                                                <div>
                                                    {{ item.thirdDate | date: 'dd/MM/yy' }}
                                                </div>
                                            </div>
                                        </div>
                                        <div class="border"></div>
                                        <div>
                                            <ng-container *ngIf="!fileFieldsForm.get('40')">
                                                <div>&nbsp;</div>
                                            </ng-container>

                                            <ng-container *ngIf="fileFieldsForm.get('40')">
                                                <div *ngIf="item.transTypeReceiptCode; else empty">
                                                    {{ item.transTypeReceiptCode }}
                                                </div>
                                            </ng-container>
                                        </div>
                                        <div class="border"></div>

                                        <ng-container
                                                *ngTemplateOutlet="
                        (!sidebarImgsDescList.showUpside &&
                          item.invoiceType === 1) ||
                        (sidebarImgsDescList.showUpside &&
                          item.invoiceType === 0)
                          ? expenseTemp
                          : incomeTemp
                      "
                                        >
                                        </ng-container>
                                        <div class="border"></div>
                                        <ng-container
                                                *ngTemplateOutlet="
                        (!sidebarImgsDescList.showUpside &&
                          item.invoiceType === 1) ||
                        (sidebarImgsDescList.showUpside &&
                          item.invoiceType === 0)
                          ? incomeTemp
                          : expenseTemp
                      "
                                        >
                                        </ng-container>

                                        <!--                                        <ng-container *ngIf="isMatah">-->
                                        <!--                                            <div class="border"></div>-->
                                        <!--                                            <ng-container-->
                                        <!--                                                    *ngTemplateOutlet="((showDocumentListStorageDataFile.invoiceType === 1 && showDocumentListStorageDataFile.documentType  !== 'חשבונית זיכוי')-->
                                        <!--            ||-->
                                        <!--            (showDocumentListStorageDataFile.invoiceType !== 1 && showDocumentListStorageDataFile.documentType  === 'חשבונית זיכוי')) ? expenseMatahTemp: incomeMatahTemp">-->

                                        <!--                                            </ng-container>-->
                                        <!--                                            <ng-container-->
                                        <!--                                                    *ngTemplateOutlet="((showDocumentListStorageDataFile.invoiceType === 1 && showDocumentListStorageDataFile.documentType  !== 'חשבונית זיכוי')-->
                                        <!--            ||-->
                                        <!--            (showDocumentListStorageDataFile.invoiceType !== 1 && showDocumentListStorageDataFile.documentType  === 'חשבונית זיכוי')) ? incomeMatahTemp : expenseMatahTemp">-->

                                        <!--                                            </ng-container>-->
                                        <!--                                        </ng-container>-->

                                        <ng-container *ngIf="isMatah">
                                            <div class="border"></div>
                                            <ng-container
                                                    *ngTemplateOutlet="
                          (!sidebarImgsDescList.showUpside &&
                            item.invoiceType === 1) ||
                          (sidebarImgsDescList.showUpside &&
                            item.invoiceType === 0)
                            ? expenseTempSums
                            : incomeTempSums
                        "
                                            >
                                            </ng-container>
                                            <ng-container
                                                    *ngTemplateOutlet="
                          (!sidebarImgsDescList.showUpside &&
                            item.invoiceType === 1) ||
                          (sidebarImgsDescList.showUpside &&
                            item.invoiceType === 0)
                            ? incomeTempSums
                            : expenseTempSums
                        "
                                            >
                                            </ng-container>

                                            <div class="border"></div>
                                            <ng-container
                                                    *ngTemplateOutlet="
                          (!sidebarImgsDescList.showUpside &&
                            item.invoiceType === 1) ||
                          (sidebarImgsDescList.showUpside &&
                            item.invoiceType === 0)
                            ? expenseMatahTemp
                            : incomeMatahTemp
                        "
                                            >
                                            </ng-container>
                                            <ng-container
                                                    *ngTemplateOutlet="
                          (!sidebarImgsDescList.showUpside &&
                            item.invoiceType === 1) ||
                          (sidebarImgsDescList.showUpside &&
                            item.invoiceType === 0)
                            ? incomeMatahTemp
                            : expenseMatahTemp
                        "
                                            >
                                            </ng-container>
                                        </ng-container>

                                        <div class="border"></div>
                                        <div style="position: relative">
                                            <div
                                                    (click)="item.openedAsm = !item.openedAsm"
                                                    class="flex"
                                                    style="margin-bottom: 10px"
                                            >
                                                <img
                                                        *ngIf="item.asmachta2 || item.asmachta3"
                                                        [src]="
                            item.openedAsm
                              ? '/assets/images/stateOpen.png'
                              : '/assets/images/stateClose.png'
                          "
                                                        height="7"
                                                        style="
                            width: 11px;
                            height: 7px;
                            vertical-align: middle;
                            cursor: pointer;
                            margin-right: -16px;
                            margin-left: 4px;
                          "
                                                        width="11"
                                                />
                                                <p style="width: 64px">{{ fieldNameAsmachta }}</p>
                                                <div style="width: 65px; margin-left: 20px">
                                                    {{ item.asmachta }}
                                                </div>
                                            </div>
                                            <div
                                                    *ngIf="item.asmachta2 && item.openedAsm"
                                                    class="flex"
                                                    style="margin-bottom: 10px"
                                            >
                                                <p style="width: 64px">
                                                    אסמכ.
                                                    {{ fieldNameAsmachta === 'אסמכתא 1' ? '2' : '1' }}
                                                </p>
                                                <div style="width: 65px; margin-left: 20px">
                                                    {{ item.asmachta2 }}
                                                </div>
                                            </div>
                                            <div
                                                    *ngIf="item.asmachta3 && item.openedAsm"
                                                    class="flex"
                                                    style="margin-bottom: 10px"
                                            >
                                                <p style="width: 64px">אסמכ. 3</p>
                                                <div style="width: 65px; margin-left: 20px">
                                                    {{ item.asmachta3 }}
                                                </div>
                                            </div>
                                            <div class="flex">
                                                <p style="width: 64px">פרטים</p>
                                                <div
                                                    #inputElement
                                                    [pTooltip]="item.details"
                                                    [tooltipDisabled]="
                            inputElement.offsetWidth >= inputElement.scrollWidth
                          "
                                                    class="text-ellipsis"
                                                    style="max-width: 200px"
                                                    tooltipPosition="top"
                                                >
                                                    {{ item.details }}
                                                </div>
                                            </div>
                                        </div>
                                        <ng-template #expenseTemp>
                                            <div>
                                                <div
                                                        class="flex"
                                                        style="
                            margin-bottom: 10px;
                            justify-content: space-between;
                          "
                                                >
                                                    <div
                                                            [ngStyle]="{
                              width: isMatah ? '170px' : '170px',
                              'min-width': isMatah ? '170px' : '170px'
                            }"
                                                    >
                                                        <div
                                                            #inputElement
                                                            [pTooltip]="
                                item.custId ? item.custId.cartisName : ''
                              "
                                                            [tooltipDisabled]="
                                inputElement.offsetWidth >=
                                inputElement.scrollWidth
                              "
                                                            class="text-ellipsis"
                                                            tooltipPosition="top"
                                                        >
                                                            <p *ngIf="item.custId; else empty">
                                                                {{ item.custId ? item.custId.cartisName : '' }}
                                                            </p>
                                                        </div>
                                                    </div>
                                                    <div
                                                            *ngIf="!isMatah"
                                                            style="
                              align-self: stretch;
                              width: 11px;
                              height: auto;
                            "
                                                    ></div>
                                                    <div
                                                            *ngIf="!isMatah"
                                                            class="input disabled"
                                                            style="width: 85px; display: flex"
                                                    >
                                                        <app-sum-view
                                                                *ngIf="item.total"
                                                                [sum]="item.total"
                                                                class="text-item text-ellipsis"
                                                        ></app-sum-view>

                                                        <p
                                                                *ngIf="!item.total"
                                                                class="text-item text-ellipsis"
                                                        >
                                                            0
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </ng-template>
                                        <ng-template #incomeTemp>
                                            <div>
                                                <div
                                                        class="flex"
                                                        style="
                            margin-bottom: 10px;
                            justify-content: space-between;
                          "
                                                >
                                                    <div
                                                            [ngStyle]="{
                              width: isMatah ? '170px' : '170px',
                              'min-width': isMatah ? '170px' : '170px'
                            }"
                                                    >
                                                        <div
                                                            #inputElement
                                                            [pTooltip]="
                                item.paymentCustId
                                  ? item.paymentCustId.cartisName
                                  : ''
                              "
                                                            [tooltipDisabled]="
                                inputElement.offsetWidth >=
                                inputElement.scrollWidth
                              "
                                                            class="text-ellipsis"
                                                            tooltipPosition="top"
                                                        >
                                                            <p *ngIf="item.paymentCustId; else empty">
                                                                {{
                                                                item.paymentCustId
                                                                    ? item.paymentCustId.cartisName
                                                                    : ''
                                                                }}
                                                            </p>
                                                        </div>
                                                    </div>

                                                    <div
                                                            *ngIf="!isMatah"
                                                            style="
                              align-self: stretch;
                              width: 11px;
                              height: auto;
                            "
                                                    ></div>
                                                    <div
                                                            *ngIf="!isMatah"
                                                            class="input disabled"
                                                            style="width: 85px; display: flex"
                                                    >
                                                        <app-sum-view
                                                                *ngIf="item.paymentTotal"
                                                                [sum]="item.paymentTotal"
                                                                class="text-item text-ellipsis"
                                                        ></app-sum-view>

                                                        <p
                                                                *ngIf="!item.paymentTotal"
                                                                class="text-item text-ellipsis"
                                                        >
                                                            0
                                                        </p>
                                                    </div>
                                                </div>

                                                <div
                                                        *ngIf="item.taxDeductionCustId"
                                                        class="flex text-ellipsis"
                                                        style="justify-content: space-between"
                                                >
                                                    <div
                                                            [ngStyle]="{
                              width: isMatah ? '170px' : '170px',
                              'min-width': isMatah ? '170px' : '170px'
                            }"
                                                    >
                                                        <div
                                                            #inputElement
                                                            [pTooltip]="
                                item.taxDeductionCustId
                                  ? item.taxDeductionCustId.cartisName
                                  : ''
                              "
                                                            [tooltipDisabled]="
                                inputElement.offsetWidth >=
                                inputElement.scrollWidth
                              "
                                                            class="text-ellipsis"
                                                            tooltipPosition="top"
                                                        >
                                                            <p *ngIf="item.taxDeductionCustId; else empty">
                                                                {{
                                                                item.taxDeductionCustId
                                                                    ? item.taxDeductionCustId.cartisName
                                                                    : ''
                                                                }}
                                                            </p>
                                                        </div>
                                                    </div>

                                                    <div
                                                            *ngIf="!isMatah"
                                                            style="
                              align-self: stretch;
                              width: 11px;
                              height: auto;
                            "
                                                    ></div>
                                                    <div
                                                            *ngIf="!isMatah"
                                                            class="input disabled"
                                                            style="width: 85px; display: flex"
                                                    >
                                                        <app-sum-view
                                                                *ngIf="item.paymentNikui"
                                                                [sum]="item.paymentNikui"
                                                                class="text-item text-ellipsis"
                                                        ></app-sum-view>

                                                        <p
                                                                *ngIf="!item.paymentNikui"
                                                                class="text-item text-ellipsis"
                                                        >
                                                            0
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </ng-template>

                                        <ng-template #expenseTempSums>
                                            <div>
                                                <div>
                                                    <div
                                                            class="input disabled"
                                                            style="width: 85px; display: flex"
                                                    >
                                                        <app-sum-view
                                                                *ngIf="item.total"
                                                                [sum]="item.total"
                                                                class="text-item text-ellipsis"
                                                        ></app-sum-view>

                                                        <p
                                                                *ngIf="!item.total"
                                                                class="text-item text-ellipsis"
                                                        >
                                                            0
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </ng-template>
                                        <ng-template #incomeTempSums>
                                            <div>
                                                <div>
                                                    <div
                                                            class="input disabled"
                                                            style="width: 85px; display: flex"
                                                    >
                                                        <app-sum-view
                                                                *ngIf="item.paymentTotal"
                                                                [sum]="item.paymentTotal"
                                                                class="text-item text-ellipsis"
                                                        ></app-sum-view>

                                                        <p
                                                                *ngIf="!item.paymentTotal"
                                                                class="text-item text-ellipsis"
                                                        >
                                                            0
                                                        </p>
                                                    </div>
                                                </div>
                                                <div>
                                                    <div
                                                            class="input disabled"
                                                            style="width: 85px; display: flex"
                                                    >
                                                        <app-sum-view
                                                                *ngIf="item.paymentNikui"
                                                                [sum]="item.paymentNikui"
                                                                class="text-item text-ellipsis"
                                                        ></app-sum-view>

                                                        <p
                                                                *ngIf="!item.paymentNikui"
                                                                class="text-item text-ellipsis"
                                                        >
                                                            0
                                                        </p>
                                                    </div>
                                                </div>
                                            </div>
                                        </ng-template>

                                        <ng-template #expenseMatahTemp>
                                            <div style="position: relative; align-self: stretch">
                                                <div
                                                        class="input disabled"
                                                        style="width: 85px; display: flex"
                                                >
                                                    <app-sum-view
                                                            *ngIf="item.totalMatah"
                                                            [sum]="item.totalMatah"
                                                            class="text-item text-ellipsis"
                                                    ></app-sum-view>

                                                    <p
                                                            *ngIf="!item.totalMatah"
                                                            class="text-item text-ellipsis"
                                                    >
                                                        0
                                                    </p>
                                                </div>
                                                <i
                                                        *ngIf="
                            !(
                              (!sidebarImgsDescList.showUpside &&
                                item.invoiceType === 1) ||
                              (sidebarImgsDescList.showUpside &&
                                item.invoiceType === 0)
                            )
                          "
                                                        [matTooltip]="'לפי שער יציג של ' + rate + ' ₪'"
                                                        class="fas fa-globe"
                                                        matTooltipPosition="below"
                                                        style="
                            position: absolute;
                            bottom: 0px;
                            left: 0px;
                            cursor: pointer;
                          "
                                                ></i>
                                            </div>
                                        </ng-template>

                                        <ng-template #incomeMatahTemp>
                                            <div style="position: relative; align-self: stretch">
                                                <div>
                                                    <div>
                                                        <div
                                                                class="input disabled"
                                                                style="width: 85px; display: flex"
                                                        >
                                                            <app-sum-view
                                                                    *ngIf="item.paymentTotalMatah"
                                                                    [sum]="item.paymentTotalMatah"
                                                                    class="text-item text-ellipsis"
                                                            ></app-sum-view>

                                                            <p
                                                                    *ngIf="!item.paymentTotalMatah"
                                                                    class="text-item text-ellipsis"
                                                            >
                                                                0
                                                            </p>
                                                        </div>
                                                    </div>
                                                </div>
                                                <div>
                                                    <div
                                                            class="input disabled"
                                                            style="width: 85px; display: flex"
                                                    >
                                                        <app-sum-view
                                                                *ngIf="item.paymentNikuiMatah"
                                                                [sum]="item.paymentNikuiMatah"
                                                                class="text-item text-ellipsis"
                                                        ></app-sum-view>

                                                        <p
                                                                *ngIf="!item.paymentNikuiMatah"
                                                                class="text-item text-ellipsis"
                                                        >
                                                            0
                                                        </p>
                                                    </div>
                                                </div>

                                                <i
                                                        *ngIf="
                            (!sidebarImgsDescList.showUpside &&
                              item.invoiceType === 1) ||
                            (sidebarImgsDescList.showUpside &&
                              item.invoiceType === 0)
                          "
                                                        [matTooltip]="'לפי שער יציג של ' + rate + ' ₪'"
                                                        class="fas fa-globe"
                                                        matTooltipPosition="below"
                                                        style="
                            position: absolute;
                            bottom: 0px;
                            left: 0px;
                            cursor: pointer;
                          "
                                                ></i>
                                            </div>
                                        </ng-template>

                                        <ng-template #empty>
                                            <div>&nbsp;</div>
                                        </ng-template>
                                    </div>
                                </ng-container>
                            </ng-container>
                        </div>
                    </div>
                </div>
            </div>
        </ng-container>
        <ng-container *ngIf="fileDetails$ | async as fileDetails">
            <div #zoomControl class="zoom-controls">
                <button (click)="zoomBestFit()" mat-icon-button>
                    <mat-icon class="rotate-90">height</mat-icon>
                </button>
                <button
                        (click)="
            incButton(
              fileDetails.pages[currentPage.getValue() - 1],
              currentPage.getValue() - 1
            );
            $event.stopPropagation()
          "
                        [disabled]="
            !(currentPageCachedContent$ | async) ||
            !fileDetails.pages[currentPage.getValue() - 1]?.rotate?.image
          "
                        mat-icon-button
                >
                    <mat-icon
                            style="width: 17px; height: 17px"
                            svgIcon="rotate"
                    ></mat-icon>
                </button>
                <button (click)="zoomStep(1)" mat-icon-button>
                    <mat-icon>add</mat-icon>
                </button>
                <button (click)="zoomStep(-1)" mat-icon-button>
                    <mat-icon>remove</mat-icon>
                </button>
            </div>
            <div *ngIf="fileProgress; else finishedLoadedFile" class="loaderPercent">
                <div class="circle"></div>
            </div>
            <ng-template #finishedLoadedFile>
                <!--                (mousemove)="hoverCanvas($event)"-->

                <div
                    #pagesScrollContainer
                    (scroll)="setPageNum($event)"
                    [style.height.px]="
            getHeightScrollDoc(content.getBoundingClientRect().top + 2)
          "
                    class="scrollbar-dynamic scroll-chrome-doc-wrap"
                    style="overflow: auto; position: relative"
                >
                    <ng-container
                            *ngFor="
              let page of fileDetails.pages;
              index as i;
              let firstPage = first;
              let lastPage = last
            "
                    >
                        <div [style.width.px]="getOffsetWidthMax()" style="margin: 0 auto">
                            <div
                                #pageContainer
                                [id]="'page' + i"
                                class="ocr-doc-page-container"
                                style="position: relative"
                            >
                                <ng-container
                                        *ngIf="(cachedContent$ | async)[i] | async as imgBlob"
                                >
                                    <!--                        <ng-container *ngIf="showDoubleSuspect">-->
                                    <!--                            <div class="doubleSuspect"-->
                                    <!--                                                         [ngStyle]="{ 'right': ((pageContainer.getBoundingClientRect().width - (pageImage.getBoundingClientRect().width*imageScale))/2) + 'px'}"-->
                                    <!--                                 (click)="doubleSuspect()">-->
                                    <!--                                <div [style.zoom.%]="(imageScale * 160)"-->
                                    <!--                                     [ngStyle]="{ 'margin-right': '55px' , 'margin-top': '135px'}">-->
                                    <!--                                    <img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/doubleSuspect.png">-->
                                    <!--                                    <p>לחצו להשוואת חשבוניות</p>-->
                                    <!--                                </div>-->
                                    <!--                            </div>-->
                                    <!--                        </ng-container>-->
                                    <ng-container
                                            *ngIf="firstPage && !lastPage && !showDoubleSuspect"
                                    >
                                        <app-folded-corner
                                                [right]="
                        (pageContainer.getBoundingClientRect().width -
                          pageImage.getBoundingClientRect().width *
                            imageScale) /
                        2
                      "
                                                [top]="
                        pageImage.getBoundingClientRect().top * imageScale -
                        pageContainer.getBoundingClientRect().top
                      "
                                        ></app-folded-corner>
                                    </ng-container>

                                    <img
                                            *ngIf="showDoubleSuspect"
                                            [ngStyle]="{
                      right:
                        (pageContainer.getBoundingClientRect().width -
                          pageImage.getBoundingClientRect().width *
                            imageScale) /
                          2 +
                        'px'
                    }"
                                            height="78"
                                            src="/assets/images/shadowCornerPages.png"
                                            style="position: absolute; top: -19px; margin-right: -14px"
                                            width="81"
                                    />

                                    <div
                                            [ngClass]="{
                      expenseBorder:
                        fileFieldsForm.get('21') &&
                        fileFieldsForm.get('21')?.get('effectiveValue')
                          .value === 1,
                      incomeBorder:
                        fileFieldsForm.get('21') &&
                        fileFieldsForm.get('21')?.get('effectiveValue')
                          .value === 0,
                      baseBorder:
                        fileFieldsForm.get('21') &&
                        fileFieldsForm.get('21')?.get('effectiveValue')
                          .value !== 0 &&
                        fileFieldsForm.get('21')?.get('effectiveValue')
                          .value !== 1
                    }"
                                            class="baseTransparentBorder"
                                            style="display: table; margin: 0 auto"
                                    >
                                        <img
                                            #pageImage
                                            (error)="zoomControl.style.display = 'none'"
                                            (load)="
                        zoomControl.style.display = 'flex';
                        zoomBestFitBase();
                        !page?.rotate?.image
                          ? imgBlobSetCanvas(imgBlob, page)
                          : null
                      "
                                            [src]="imgBlob"
                                            [style.zoom.%]="imageScale * 100"
                                            alt="pageImage"
                                            style="display: flex; margin: 0 auto;"
                                        />
                                    </div>

                                    <!--                            <ng-container *ngIf="!activeWord?.position?.length">-->
                                    <!--                                <ng-container *ngIf="((visionResultWords$ | async)[i]| async) as pageWords">-->
                                    <!--                                    <svg style="position: absolute; top: 7px; left: 0; right: 0; display: block; margin: 0 auto;"-->
                                    <!--                                         #svgElem-->
                                    <!--                                         [ngStyle]="{ 'width': pageImage.getBoundingClientRect().width*imageScale + 'px',-->
                                    <!--                             'height': pageImage.getBoundingClientRect().height*imageScale + 'px' }"-->
                                    <!--                                         [attr.viewBox]="'0 0 ' + pageImage.width + ' ' + pageImage.height">-->
                                    <!--                                        <g *ngFor="let word of pageWords;"-->
                                    <!--                                           (click)="activeWord = { position: word.vertices, pageNo: (i+1)};-->
                                    <!--                                                inlineEditorForm.patchValue({-->
                                    <!--                                                  fieldValue: word.text,-->
                                    <!--                                                  fieldPage: (i+1),-->
                                    <!--                                                  fieldPosition: word.vertices-->
                                    <!--                                                });-->
                                    <!--                                                currentPage.next(i + 1);-->
                                    <!--                                                $event.stopPropagation();">-->
                                    <!--                                            &lt;!&ndash;                [matTooltip]="word.text">&ndash;&gt;-->
                                    <!--                                            &lt;!&ndash;                                             [ngClass]="{'ocr-field': isExistField(word.text)}"&ndash;&gt;-->

                                    <!--                                            <polygon #fieldBox class="ocr-word"-->
                                    <!--                                                     [attr.points]="word.vertices | verticesArrayToPolygonPoints"></polygon>-->
                                    <!--                                        </g>-->

                                    <!--                                        <ng-container *ngIf="wordsFieldsExist && wordsFieldsExist.length">-->
                                    <!--                                            <g *ngFor="let word of wordsFieldsExist;"-->
                                    <!--                                               (click)="setActiveFieldFromExistingWord(word)">-->
                                    <!--                                                <polygon class="ocr-word ocr-field"-->
                                    <!--                                                         *ngIf="word.fieldPage === (i+1)"-->
                                    <!--                                                         [attr.points]="word?.fieldPosition| verticesArrayToPolygonPoints"></polygon>-->
                                    <!--                                            </g>-->
                                    <!--                                        </ng-container>-->
                                    <!--                                    </svg>-->

                                    <!--                                    &lt;!&ndash;                                <ng-container *ngIf="activeWord?.position?.length && activeWord.pageNo === (i+1)">&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                    <div #activeWordElementDiv>&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                        <app-resizable-draggable&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                            #activeWordElement&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                            [offsetPageLeft]="((pageContainer.getBoundingClientRect().width - (pageImage.getBoundingClientRect().width*imageScale))/2)"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                            [pageImage]="pageImage"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                            (setPositions)="draggerCanvas($event)"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                            [widthScreen]="pageImage.getBoundingClientRect().width*imageScale"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                            [heightScreen]="pageImage.getBoundingClientRect().height*imageScale"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                            [width]="(activeWord.position[1].x-activeWord.position[0].x)"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                            [height]="(activeWord.position[3].y-activeWord.position[0].y)"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                            [left]="activeWord.position[0].x"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                            [top]="activeWord.position[0].y"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                            [imageScale]="imageScale">&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                        </app-resizable-draggable>&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                    </div>&ndash;&gt;-->

                                    <!--                                    &lt;!&ndash;                                </ng-container>&ndash;&gt;-->

                                    <!--                                    &lt;!&ndash;                                                                                                <ng-container *ngIf="activeWord?.position?.length && activeWord.pageNo === (i+1)">&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                    <svg xmlns="http://www.w3.org/2000/svg"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                         style="position: absolute; top: 0; left: 0; right: 0; display: block; margin: 0 auto;"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                         [ngStyle]="{ 'width': pageImage.getBoundingClientRect().width*imageScale + 'px',&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                             'height': pageImage.getBoundingClientRect().height*imageScale + 'px' }"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                         [attr.viewBox]="'0 0 ' + pageImage.width*imageScale + ' ' + pageImage.height*imageScale"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                         (mousedown)="startDrag($event)"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                         (mousemove)="drager($event, pageImage.width*imageScale, pageImage.height*imageScale)"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                         (mouseup)="endDrag($event)">&ndash;&gt;-->

                                    <!--                                    &lt;!&ndash;                                                                        &lt;!&ndash;                                    <polygon [attr.points]="activeWord.position| verticesArrayToPolygonPoints"&ndash;&gt;&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                        &lt;!&ndash;                                          class="draggable ocr-word ocr-field active" #activeWordElement&ndash;&gt;&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                        &lt;!&ndash;                                          fill="rgba(0,112,253,0.25)"/>&ndash;&gt;&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                        <rect [attr.x]="activeWord.position[0].x"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              [attr.y]="activeWord.position[0].y"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              class="draggable ocr-word ocr-field active"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              #activeWordElement&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              [attr.width]="activeWord.position[1].x-activeWord.position[0].x"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              [attr.height]="activeWord.position[3].y-activeWord.position[0].y"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              fill="rgba(0,112,253,0.25)"/>&ndash;&gt;-->

                                    <!--                                    &lt;!&ndash;                                                                        <rect style="cursor: nwse-resize;"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              class="draggable draggableTopLeft"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              [attr.x]="activeWord.position[0].x - 6"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              [attr.y]="activeWord.position[0].y - 6"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              [attr.width]="20"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              [attr.height]="20"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              fill="transparent"/>&ndash;&gt;-->

                                    <!--                                    &lt;!&ndash;                                                                        <rect style="cursor: nesw-resize;"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              class="draggable draggableTopRight"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              [attr.x]="activeWord.position[1].x + 6 - 20"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              [attr.y]="activeWord.position[1].y - 6"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              [attr.width]="20"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              [attr.height]="20"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              fill="transparent"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                        />&ndash;&gt;-->

                                    <!--                                    &lt;!&ndash;                                                                        <rect style="cursor: nwse-resize;"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              class="draggable draggableBottomRight"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              [attr.x]="activeWord.position[2].x + 6 - 20"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              [attr.y]="activeWord.position[2].y + 6 - 20"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              [attr.width]="20"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              [attr.height]="20"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              fill="transparent"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                        />&ndash;&gt;-->

                                    <!--                                    &lt;!&ndash;                                                                        <rect style="cursor: nesw-resize;"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              class="draggable draggableBottomLeft"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              [attr.x]="activeWord.position[3].x - 6"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              [attr.y]="activeWord.position[3].y + 6 - 20"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              [attr.width]="20"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              [attr.height]="20"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                              fill="transparent"&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                        />&ndash;&gt;-->

                                    <!--                                    &lt;!&ndash;                                                                    </svg>&ndash;&gt;-->
                                    <!--                                    &lt;!&ndash;                                                                </ng-container>&ndash;&gt;-->

                                    <!--                                </ng-container>-->
                                    <!--                            </ng-container>-->
                                </ng-container>
                            </div>
                        </div>
                    </ng-container>

                    <!--                    <ng-container *ngIf="activeWord?.position?.length && getSizeAllImgs()">-->
                    <!--                    </ng-container>-->
                    <ng-container
                            *ngIf="
              sizeAllImg &&
              (visionResultsArr.length ||
                wordsFieldsExist.length ||
                activeWord?.position?.length)
            "
                    >
                        <!--                        getOffsetWidthMax() - 14-->
                        <!-- 						<app-resizable-draggable -->
                        <!-- 								#activeWordElement -->
                        <!-- 								(setActiveFieldEvent)="setActiveFieldEvent($event)" -->
                        <!-- 								(setActiveFieldFromExistingWordEvent)=" -->
                        <!--                 setActiveFieldFromExistingWordDrag($event) -->
                        <!--               " -->
                        <!-- 								(setPositions)="draggerCanvas($event)" -->
                        <!-- 								[activeWordExist]=" -->
                        <!--                 activeWord && -->
                        <!--                 activeWord.position && -->
                        <!--                 activeWord.position.length -->
                        <!--                   ? activeWord.position.length -->
                        <!--                   : false -->
                        <!--               " -->
                        <!-- 								[changed]="changed" -->
                        <!-- 								[currentPage]="currentPage['_value']" -->
                        <!-- 								[heightScreen]="sizeAllImg ? sizeAllImg.height : 0" -->
                        <!-- 								[height]=" -->
                        <!--                 activeWord?.position?.length -->
                        <!--                   ? activeWord.position[3].y - activeWord.position[0].y -->
                        <!--                   : 0 -->
                        <!--               " -->
                        <!-- 								[imageScale]="imageScale" -->
                        <!-- 								[isPagesExist]=" -->
                        <!--                 fileDetailsSave && -->
                        <!--                 fileDetailsSave.pages && -->
                        <!--                 sizeAllImg && -->
                        <!--                 sizeAllImg.pages && -->
                        <!--                 fileDetailsSave.pages.length === sizeAllImg.pages.length && -->
                        <!--                 fileDetailsSave.pages.length === visionResultsArr.length -->
                        <!--               " -->
                        <!-- 								[left]=" -->
                        <!--                 activeWord?.position?.length ? activeWord.position[0].x : 0 -->
                        <!--               " -->
                        <!-- 								[offsetLocalLeft]=" -->
                        <!--                 activeWord?.position?.length -->
                        <!--                   ? sizeAllImg.pages[activeWord.pageNo - 1]['offsetPageLeft'] -->
                        <!--                   : 0 -->
                        <!--               " -->
                        <!-- 								[offsetPageLeft]="sizeAllImg ? sizeAllImg['offsetPageLeft'] : 0" -->
                        <!-- 								[overOnCanvas]="overOnCanvas" -->
                        <!-- 								[pageImage]="''" -->
                        <!-- 								[pageNo]=" -->
                        <!--                 activeWord?.position?.length ? activeWord.pageNo - 1 : 0 -->
                        <!--               " -->
                        <!-- 								[scrollLeftWidth]=" -->
                        <!--                 pagesScrollContainer.scrollWidth - -->
                        <!--                 pagesScrollContainer.clientWidth -->
                        <!--               " -->
                        <!-- 								[sizeAllImg]="sizeAllImg" -->
                        <!-- 								[topFromFirst]=" -->
                        <!--                 activeWord?.position?.length -->
                        <!--                   ? sizeAllImg.pages[activeWord.pageNo - 1]['top'] -->
                        <!--                   : 0 -->
                        <!--               " -->
                        <!-- 								[top]=" -->
                        <!--                 activeWord?.position?.length ? activeWord.position[0].y : 0 -->
                        <!--               " -->
                        <!-- 								[visionResultsArr]="visionResultsArr" -->
                        <!-- 								[widthScreen]="sizeAllImg ? sizeAllImg.width : 0" -->
                        <!-- 								[width]=" -->
                        <!--                 activeWord?.position?.length -->
                        <!--                   ? activeWord.position[1].x - activeWord.position[0].x -->
                        <!--                   : 0 -->
                        <!--               " -->
                        <!-- 								[wordsFieldsExist]="wordsFieldsExist" -->
                        <!-- 						> -->
                        <!-- 						</app-resizable-draggable> -->


                        <app-resizable-draggable
                                [wordsFieldsExist]="wordsFieldsExist"
                                [overOnCanvas]="overOnCanvas"
                                #activeWordElement
                                [offsetPageLeft]="sizeAllImg ? (sizeAllImg['offsetPageLeft']) : 0"
                                [pageImage]="''"
                                (setActiveFieldEvent)="setActiveFieldEvent($event)"
                                (setActiveFieldFromExistingWordEvent)="setActiveFieldFromExistingWordDrag($event)"
                                (setPositions)="draggerCanvas($event)"
                                [widthScreen]="sizeAllImg ?  sizeAllImg.width : 0"
                                [heightScreen]="sizeAllImg ?  sizeAllImg.height : 0"
                                [width]="activeWord?.position?.length ? (activeWord.position[1].x-activeWord.position[0].x) : 0"
                                [height]="activeWord?.position?.length ? (activeWord.position[3].y-activeWord.position[0].y) : 0"
                                [left]="activeWord?.position?.length ? activeWord.position[0].x : 0"
                                [pageNo]="activeWord?.position?.length ? activeWord.pageNo-1 : 0"
                                [offsetLocalLeft]="activeWord?.position?.length ? (sizeAllImg.pages[activeWord.pageNo-1]['offsetPageLeft']) : 0"
                                [topFromFirst]="activeWord?.position?.length ? (sizeAllImg.pages[activeWord.pageNo-1]['top']) : 0"
                                [top]="activeWord?.position?.length ? activeWord.position[0].y : 0"
                                [imageScale]="imageScale"
                                [visionResultsArr]="visionResultsArr"
                                [scrollLeftWidth]="pagesScrollContainer.scrollWidth - pagesScrollContainer.clientWidth"
                                [sizeAllImg]="sizeAllImg"
                                [currentPage]="currentPage['_value']"
                                [isPagesExist]="fileDetailsSave && fileDetailsSave.pages && sizeAllImg && sizeAllImg.pages && (fileDetailsSave.pages.length === sizeAllImg.pages.length) && (fileDetailsSave.pages.length === visionResultsArr.length)"
                                [activeWordExist]="activeWord && activeWord?.position && activeWord?.position?.length ? activeWord?.position?.length : false"
                                [changed]="changed"
                        >
                        </app-resizable-draggable>
                    </ng-container>

                    <!--                    /////-->
                    <ng-container
                            *ngIf="
              activeWord &&
              activeField?.element &&
              activeWordElement &&
              !fieldsWithPredefinedEditData.has(
                activeField.field.fieldId + ''
              ) &&
              locateInplaceEditor(
                activeWordElement,
                pagesScrollContainer,
                160
              ) as location
            "
                    >
                        <div
                            #inplaceEditor
                            (mouseup)="$event.stopPropagation()"
                            [ngStyle]="{
                width: '160px',
                top: location.top + 'px',
                left: location.left + 'px'
              }"
                            id="inplace-editor"
                        >
                            <ng-container
                                    *ngIf="!inlineEditorForm.errors; else showInlineError"
                            >
                                <form
                                        (ngSubmit)="
                    inplaceEditorApprove(
                      inlineEditorForm.value,
                      activeField.field
                    )
                  "
                                        [formGroup]="inlineEditorForm"
                                        id="inlineEditorForm"
                                >
                                    <div
                                            (click)="activeFieldInput.focus()"
                                            *ngIf="
                      activeField.field.fieldValue === null &&
                      !inlineEditorForm.get('fieldValue').value &&
                      !activeFieldInput.isFocused
                    "
                                            id="activeFieldPlaceHolder"
                                    >
                                        יש לגרור ידנית את הריבוע
                                        <br/>
                                        למיקום הנכון במסמך
                                    </div>

                                    <!--                                    id="activeFieldInput"-->
                                    <!--                                    [placeholder]="activeField.field.fieldValue === null ? 'יש לגרור ידנית את הריבוע למיקום הנכון במסמך' : ''"-->

                                    <textarea
                                        #activeFieldInput
                                        (blur)="activeFieldInput.isFocused = false"
                                        (focus)="activeFieldInput.isFocused = true"
                                        (keyup)="keydownActiveFieldInput($event)"
                                        [formControl]="inlineEditorForm.get('fieldValue')"
                                        [ngStyle]="{ height: activeFieldInput.scrollHeight + 'px' }"
                                        autocomplete="off"
                                        style="
                      resize: none;
                      word-wrap: break-word;
                      word-break: break-all;
                      background: none;
                      width: 100%;
                      min-height: 34px;
                      box-sizing: border-box;
                      font-size: 16px;
                      font-weight: 400;
                      font-family: 'Assistant' !important;
                      line-height: 34px;
                      border-radius: 0;
                      height: 1px;
                      padding: 0 5px;
                      border: none;
                      border-bottom: 2px solid #012157;
                      overflow-y: hidden;
                      overflow-wrap: break-word;
                      white-space: pre-wrap;
                    "
                                    ></textarea>

                                    <!--                                    <input type="text"-->
                                    <!--                                           autocomplete="off"-->
                                    <!--                                           (focus)="activeFieldInput.isFocused=true;"-->
                                    <!--                                           (blur)="activeFieldInput.isFocused=false;"-->
                                    <!--                                           #activeFieldInput-->
                                    <!--                                           [formControl]="inlineEditorForm.get('fieldValue')">-->

                                    <!--                                    <div autocomplete="off"-->
                                    <!--                                         style="    word-wrap: break-word;word-break: break-all;   background: none;-->
                                    <!--    width: 100%;-->
                                    <!--min-height: 0;-->
                                    <!--box-sizing: border-box;-->
                                    <!--font-size: 16px;-->
                                    <!--    font-weight: 400;-->
                                    <!--    font-family: 'Assistant' !important;-->
                                    <!--    line-height: 34px;-->
                                    <!--    padding: 0 5px;-->
                                    <!--    border-bottom: 2px solid #012157;"-->
                                    <!--                                         (input)="inlineEditorForm.patchValue({fieldValue: $event.target.innerHTML})"-->
                                    <!--                                         contenteditable="true"-->
                                    <!--                                         (focus)="activeFieldInput.isFocused=true;"-->
                                    <!--                                         (blur)="activeFieldInput.isFocused=false;"-->
                                    <!--                                         #activeFieldInput-->
                                    <!--                                         [innerHTML]="inlineEditorForm.get('fieldValue').value">-->

                                    <!--                                    </div>-->

                                    <div class="controls-line">
                                        <button mat-icon-button type="submit">
                                            <mat-icon>done</mat-icon>
                                        </button>
                                        <button
                                                (click)="activeWord = null"
                                                mat-icon-button
                                                type="reset"
                                        >
                                            <mat-icon>clear</mat-icon>
                                        </button>
                                    </div>
                                </form>

                                <span class="text-ellipsis">{{ activeField.field.name }}</span>
                            </ng-container>

                            <ng-template #showInlineError>
                <span class="error">{{
                    inlineEditorForm.errors | ocrFieldErrorTranslate
                    }}</span>
                            </ng-template>
                        </div>
                    </ng-container>

                    <!--                    /////-->

                    <!--                    <ng-container *ngIf="activeField?.element && activeWordElement && !fieldsWithPredefinedEditData.has(activeField.field.fieldId + '')-->
                    <!--                && locateInplaceEditor(activeWordElement.nativeElement, pagesScrollContainer,  160) as location">-->
                    <!--                        <div #inplaceEditor id="inplace-editor"-->
                    <!--                             [ngStyle]="{ 'width': '160px', 'top': location.top + 'px', 'left': location.left + 'px'}"-->
                    <!--                             (mouseup)="$event.stopPropagation();">-->

                    <!--                            <ng-container *ngIf="!inlineEditorForm.errors; else showInlineError">-->
                    <!--                                <form [formGroup]="inlineEditorForm"-->
                    <!--                                      (ngSubmit)="inplaceEditorApprove(inlineEditorForm.value, activeField.field)">-->

                    <!--                                    <input type="text" autocomplete="off"-->
                    <!--                                           [formControl]="inlineEditorForm.get('fieldValue')">-->

                    <!--                                    <div class="controls-line">-->
                    <!--                                        <button mat-icon-button type="submit">-->
                    <!--                                            <mat-icon>done</mat-icon>-->
                    <!--                                        </button>-->
                    <!--                                        <button mat-icon-button type="reset" (click)="activeWord = null;">-->
                    <!--                                            <mat-icon>clear</mat-icon>-->
                    <!--                                        </button>-->
                    <!--                                    </div>-->
                    <!--                                </form>-->

                    <!--                                <span class="text-ellipsis">{{activeField.field.name}}</span>-->
                    <!--                            </ng-container>-->

                    <!--                            <ng-template #showInlineError>-->
                    <!--                                <span class="error">{{inlineEditorForm.errors| ocrFieldErrorTranslate}}</span>-->
                    <!--                            </ng-template>-->
                    <!--                        </div>-->
                    <!--                    </ng-container>-->
                </div>
            </ng-template>
        </ng-container>
    </div>

    <div *ngIf="fileDetails$ | async as fileDetails" id="docMarkers">
        <div
                (click)="toggleFlagOn(fileDetails)"
                *ngIf="!!fileDetails.flag"
                class="error"
        >
            <mat-icon [svgIcon]="'bizibox_flag'" style="font-size: 18px"></mat-icon>
        </div>
        <div
                (click)="
        docNoteShow.emit({
          fileDetails: fileDetails,
          fileId: _fileScanView?.fileId
        })
      "
                *ngIf="!!fileDetails.note"
                class="warn"
        >
            <mat-icon [svgIcon]="'note'" style="font-size: 18px"></mat-icon>
        </div>
    </div>

    <svg
        #connectorContainer
        style="
      position: absolute;
      width: 100%;
      height: 100%;
      display: block;
      margin: 0 auto;
      pointer-events: none;
      z-index: 9;
    "
    >
        <g
                *ngIf="
        activeWord &&
        activeField?.element &&
        activeWordElement &&
        !fieldsWithPredefinedEditData.has(activeField.field.fieldId + '')
      "
        >
            <path
                    [attr.d]="
          generateBezierConnector(
            activeField.element.getBoundingClientRect().left - 23,
            activeField.element.getBoundingClientRect().top +
              activeField.element.getBoundingClientRect().height / 2 -
              connectorContainer.getBoundingClientRect().top,
            getScrollLeft(pagesScrollContainer),
            7 +
              (activeWord.position[1].y +
                (activeWord.position[2].y - activeWord.position[1].y) / 2) *
                imageScale -
              getScrollTop(pagesScrollContainer) +
              (activeWord.pageNo > 1
                ? this.pageContainer.toArray()[activeWord.pageNo - 1]
                    .nativeElement.offsetTop
                : 0),
            0.7
          )
        "
                    fill="none"
                    stroke="#002761"
                    stroke-width="2"
            ></path>
            <circle
                    [attr.cx]="activeField.element.getBoundingClientRect().left - 13"
                    [attr.cy]="
          activeField.element.getBoundingClientRect().top +
          activeField.element.getBoundingClientRect().height / 2 -
          connectorContainer.getBoundingClientRect().top
        "
                    fill="none"
                    r="10"
                    stroke="#002761"
                    stroke-width="2"
            />
            <!--      <circle [attr.cx]="hoveredWordElement.getBoundingClientRect().right"-->
            <!--              [attr.cy]="hoveredWordElement.getBoundingClientRect().top + hoveredWordElement.getBoundingClientRect().height/2-->
            <!--                  - connectorContainer.getBoundingClientRect().top" r="10"-->
            <!--              fill="none" stroke="#002761" stroke-width="2" />-->
        </g>
    </svg>

    <p-sidebar
            [appendTo]="content"
            [baseZIndex]="100"
            [modal]="false"
            [position]="'bottom'"
            [styleClass]="'postponed-action-bottom'"
            [visible]="(
postponed && !postponed.fired && !!postponed.message
        )"
    >
        <h1 [innerHTML]="postponed?.message"></h1>
        <button (click)="postponed = null" class="button-link">
            {{ 'actions.cancellation' | translate }}
        </button>
    </p-sidebar>


</section>

<ng-container *ngIf="docCompanyReplacement.visible">
    <p-dialog (visibleChange)="docCompanyReplacement.visible = false"
              [modal]="true"
              [resizable]="false"
              [visible]="(
docCompanyReplacement.visible
        )"
              appendTo="body"
              styleClass="ocrDocumentCompanyReplaceDialog"
    >
        <p-header>{{ 'העברת מסמך לחברה אחרת' }}</p-header>
        <app-accountants-company-selector
                (selectedCompanyChange)="
        docCompanyReplacement.companyReplacement = $event
      "
                [selectedCompanyId]="
        userService.appData?.userData?.companySelect?.companyId
      "
        ></app-accountants-company-selector>
        <p-footer>
            <button
                    (click)="docCompanyReplacement.visible = false"
                    class="button-link"
            >
                {{ 'actions.cancellation' | translate }}
            </button>
            <button
                    (click)="docCompanyReplacement.onApprove()"
                    [disabled]="!docCompanyReplacement.companyReplacement?.companyId"
                    class="button-dark"
            >
                {{ 'actions.save' | translate }}
            </button>
        </p-footer>
    </p-dialog>
</ng-container>

<ng-container *ngIf="docNote.visible && docNote.fd">
    <p-dialog (visibleChange)="docNote.visible = false"
              [modal]="true"
              [resizable]="false"
              [visible]="(
docNote.visible
        )"
              appendTo="body"
              styleClass="ocrDocumentNoteDialog"
    >
        <form
                (ngSubmit)="docNote.approve()"
                [formGroup]="docNote.noteFC"
                novalidate
        >
      <textarea
              [formControl]="docNote.noteFC.get('note')"
              [placeholder]="'הקלידו הערה'"
              class="scroll-chrome"
              cols="48"
              rows="8"
      ></textarea>
        </form>
        <p-footer>
            <div class="corner"></div>
            <div class="rest">
                <button (click)="docNote.approve()" mat-icon-button>
                    <mat-icon>done</mat-icon>
                </button>
                <button
                        (click)="docNote.noteFC.get('note').setValue(null); docNote.approve()"
                        mat-icon-button
                >
                    <mat-icon>delete</mat-icon>
                </button>
            </div>
        </p-footer>
    </p-dialog>
</ng-container>

<ng-container *ngIf="navigateToCreateHashBankStatusPrompt.visible">
    <p-dialog (visibleChange)="navigateToCreateHashBankStatusPrompt.visible = false"
              [closable]="true"
              [modal]="true"
              [resizable]="false"
              [visible]="(
navigateToCreateHashBankStatusPrompt.visible
        )"
              appendTo="body"
              styleClass="ocrNavigateToCreateHashBankStatusPrompt"
    >
        <p-header>{{ 'סיימת לאשר את כל החשבוניות' }}</p-header>
        <p>{{ 'הקובץ ממתין להורדה בלשונית יצירת פקודות יומן' }}</p>
        <p-footer>
            <button
                    (click)="navigateToCreateHashBankStatusPrompt.approve()"
                    class="button-dark"
            >
                {{ 'קחו אותי לשם' }}
            </button>
        </p-footer>
    </p-dialog>
</ng-container>

<ng-container *ngIf="editOrderModalShow">
    <p-dialog #editOrderModal
              (visibleChange)="editOrderModalShow = false"
              [draggable]="false"
              [maskStyleClass]="showDocumentListStorageDataFired
        ? 'isShowDocumentListStorageDataFiredMask'
        : ''"
              [modal]="true"
              [resizable]="false"
              [visible]="(
editOrderModalShow
        )"
              appendTo="body"
              styleClass="editOrderModal {{
      isMatah || revaluationCurrCode ? 'isMatah' : ''
    }} {{
      showDocumentListStorageDataFired
        ? 'isShowDocumentListStorageDataFired'
        : ''
    }}"
    >
        <p-header>{{ 'עריכה, פיצול פקודה וצפייה בהיסטוריה' }}</p-header>

        <div class="table" style="position: relative">
            <div class="header">
                <div>תאריך</div>
                <div class="border"></div>
                <div>
                    {{ fileFieldsForm.get('40') ? 'ס.תנועה' : 'אחוז מע"מ' }}
                </div>
                <div class="border"></div>
                <div>
                    חובה
                    <ng-container *ngIf="revaluationCurrCode">(₪)</ng-container>
                </div>
                <div class="border"></div>
                <div>
                    זכות
                    <ng-container *ngIf="revaluationCurrCode">(₪)</ng-container>
                </div>
                <ng-container *ngIf="isMatah">
                    <div class="border"></div>
                    <div>(₪)</div>
                    <div>(₪)</div>
                </ng-container>
                <ng-container *ngIf="isMatah">
                    <div class="border"></div>
                    <div>({{ currencySign }})</div>
                    <div>({{ currencySign }})</div>
                </ng-container>
                <ng-container *ngIf="revaluationCurrCode">
                    <div class="border"></div>
                    <div>חובה ({{ currencySign | currencySymbol }})</div>
                    <div>זכות ({{ currencySign | currencySymbol }})</div>
                </ng-container>
                <div class="border"></div>
                <div>פרטים נוספים</div>
            </div>

            <div
                    [style.max-height.px]="
          showDocumentListStorageDataFired ? 252 : scrHeight - 350
        "
                    class="scroll-chrome scrollbar-dynamic"
                    style="overflow-y: auto"
            >
                <ng-template #loader>
                    <div style="height: 84px">
                        <div class="loaderPercent">
                            <div class="circle"></div>
                        </div>
                    </div>
                </ng-template>
                <div *ngIf="orders; else loader" [formGroup]="orders">
                    <div formArrayName="arr">
                        <div
                                *ngFor="let item of arr.controls; let i = index; last as isLast"
                                [class.last]="isLast"
                                [formGroupName]="i"
                                class="row main"
                        >
                            <div>
                                <div class="date flex" style="margin-bottom: 10px">
                                    <p>תאריך</p>

                                    <div style="width: 85px">
                                        <p-calendar
                                                [dateFormat]="'dd/mm/yy'"
                                                [locale]="'langCalendar' | translate"
                                                [style]="{ width: '85px' }"
                                                appendTo="body"
                                                formControlName="date"
                                                placeholder="בחירה"
                                        ></p-calendar>
                                    </div>
                                </div>

                                <div
                                        class="date flex"
                                        style="margin-bottom: 10px; position: relative"
                                >
                                    <img
                                            (click)="
                      !item.get('thirdDateOpen').value
                        ? thirdDateOpenItem(item, true)
                        : null
                    "
                                            [ngStyle]="{
                      cursor: !item.get('thirdDateOpen').value ? 'pointer' : 'default'
                    }"
                                            [src]="
                      !item.get('thirdDateOpen').value
                        ? '/assets/images/thirdDateActive.png'
                        : '/assets/images/thirdDateNotActive.png'
                    "
                                            class="plusIconAsmachta"
                                            style="
											height: auto; width: auto;
                      position: absolute;
                      right: -17px;
                      top: 4px;
                      cursor: pointer;
                    "
                                    />
                                    <p style="min-width: 74px">תאריך ערך</p>

                                    <div style="width: 85px">
                                        <p-calendar
                                                [dateFormat]="'dd/mm/yy'"
                                                [locale]="'langCalendar' | translate"
                                                [maxDate]="maxDateCalendar_dateValue"
                                                [minDate]="minDateCalendar_dateValue"
                                                [style]="{ width: '85px' }"
                                                appendTo="body"
                                                formControlName="dateValue"
                                                placeholder="בחירה"
                                        ></p-calendar>
                                    </div>
                                </div>

                                <div
                                        *ngIf="item.get('thirdDateOpen').value"
                                        class="date flex"
                                        style="margin-bottom: 10px; position: relative"
                                >
                                    <mat-icon
                                            (click)="
                      thirdDateOpenItem(item, false);
                      item.get('thirdDate').patchValue('')
                    "
                                            style="
                      color: #022258;
                      cursor: pointer;
                      position: absolute;
                      right: -17px;
                      top: 1px;
                      width: 14px;
                      height: 14px;
                      display: block;
                    "
                                            svgIcon="trash"
                                    >
                                    </mat-icon>

                                    <p style="min-width: 74px">תאריך נוסף</p>

                                    <div style="width: 85px">
                                        <p-calendar
                                                [dateFormat]="'dd/mm/yy'"
                                                [locale]="'langCalendar' | translate"
                                                [style]="{ width: '85px' }"
                                                appendTo="body"
                                                formControlName="thirdDate"
                                                placeholder="בחירה"
                                        ></p-calendar>
                                    </div>
                                </div>
                                <div class="flex">
                                    <!--                                    <p (click)="(!this.alertBeforeSplit.stopIt && this.arr.controls.length === 1) ? alertBeforeSplitOvP.show($event) : addOrder()" *ngIf="i === 0" class="addOrder">-->
                                    <!--                                    <p (click)="arr.controls[0].get('orderType').value !== 'OPEN' ? addOrder() : null"-->
                                    <!--                                       [class.disabled]="arr.controls[0].get('orderType').value === 'OPEN'"-->

                                    <!--                                    [matTooltip]="-->
                                    <!--                                    arr.controls[0].get('orderType').value === 'OPEN' ? 'לא ניתן לפצל פקודה עם מע״מ פתוח'-->
                                    <!--                                    :-->
                                    <!--                                    'לאחר הוספת פקודה מפוצלת, אין אפשרות \n לשנות את סך סכום החשבונית'"-->
                                    <p (click)="addOrder()" *ngIf="i === 0" class="addOrder">
                                        <img
                                                class="iconCopy"
                                                height="15"
                                                src="/assets/images/iconCopy.png"
                                                style="margin-left: 5px"
                                                width="13"
                                        />
                                        פיצול פקודה

                                        <img
                                                [matTooltip]="
                        'לאחר הוספת פקודה מפוצלת, אין אפשרות \n לשנות את סך סכום החשבונית'
                      "
                                                class="infoTooltip"
                                                height="15"
                                                matTooltipClass="allow-cr"
                                                matTooltipPosition="below"
                                                src="/assets/images/infoTooltip.png"
                                                style="margin-right: 10px"
                                                width="15"
                                        />
                                    </p>
                                    <p (click)="removeOrder(i)" *ngIf="i > 0" class="removeOrder">
                                        <mat-icon
                                                style="
                        color: #038ed6;
                        margin-left: 4px;
                        width: 15px;
                        height: 15px;
                      "
                                                svgIcon="trash"
                                        >
                                        </mat-icon>
                                        מחיקה
                                    </p>
                                </div>
                            </div>
                            <div class="border"></div>
                            <div>
                                <div>
                                    <ng-container *ngIf="fileFieldsForm.get('40')">
                                        <p-dropdown
                                            #formDropdowns
                                            (onChange)="orderTypeChange(i, true, formDropdowns)"
                                            [autoDisplayFirst]="false"
                                            [class.invalid]="
                        arr.controls[i].get('transTypeCode').enabled &&
                        arr.controls[i].get('transTypeCode').invalid
                      "
                                            [dropdownIcon]="'fa fa-fw fa-caret-down'"

                                            [options]="
                        fileFieldsForm.get('21')?.get('effectiveValue')
                          .value === 1
                          ? companyCustomerDetailsData.transTypeDefinedExpense40
                          : companyCustomerDetailsData.transTypeDefinedIncome40
                      "
                                            [scrollHeight]="'185px'"
                                            [style]="{ width: '100%' }"
                                            appendTo="body"
                                            formControlName="transTypeCode"
                                            name="transTypeCode"

                                            panelStyleClass="company-customer-dropdown-panel cardsDD card195"
                                            placeholder="בחירה"
                                        >
                                            <ng-template let-item pTemplate="selectedItem">
                        <span
                            #spanElement
                            [pTooltip]="item.label + ' ' + item.value"
                            [tooltipDisabled]="
                            spanElement.offsetWidth >= spanElement.scrollWidth
                          "
                            style="
                            vertical-align: middle;
                            display: block;
                            white-space: nowrap;
                            overflow: hidden;
                            text-overflow: ellipsis;
                          "
                            tooltipPosition="top"
                        >{{ item.onlyName ? item.label : item.value }}</span
                        >
                                            </ng-template>
                                            <ng-template let-item pTemplate="item">
                                                <div class="p-helper-clearfix cust-item">
                                                    <div
                                                            style="
                              display: flex;
                              align-items: center;
                              flex-direction: row;
                              justify-content: space-between;
                            "
                                                    >
                                                        <span class="text-ellipsis">{{ item.label }}</span>
                                                        <span
                                                                *ngIf="!item.onlyName"
                                                                class="text-ellipsis"
                                                                style="
                                width: 60px;
                                display: inline-block;
                                margin-right: 10px;
                              "
                                                        >{{ item.value }}</span
                                                        >
                                                    </div>
                                                </div>
                                            </ng-template>
                                            <ng-template pTemplate="footer">
                                                <ng-container *ngIf="isTransTypeStatus">
                                                    <div
                                                            class="p-helper-clearfix"
                                                            style="height: 34px; line-height: 34px"
                                                    >
                                                        <div
                                                                [routerLinkActiveOptions]="{ exact: true }"
                                                                [routerLink]="[
                                '/accountants/companies/general/transType'
                              ]"
                                                                class="link"
                                                                queryParamsHandling="merge"
                                                                routerLinkActive="active"
                                                                style="text-align: center"
                                                        >
                                                            <span> לשינוי והוספה לחצו כאן </span>
                                                        </div>
                                                    </div>
                                                </ng-container>
                                            </ng-template>
                                        </p-dropdown>
                                    </ng-container>
                                    <ng-container *ngIf="!fileFieldsForm.get('40')">
                                        <p-dropdown
                                            #formDropdowns
                                            (onChange)="orderTypeChange(i)"
                                            [autoDisplayFirst]="false"
                                            [class.invalid]="
                        arr.controls[i].get('orderType').enabled &&
                        arr.controls[i].get('orderType').invalid
                      "
                                            [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                            [options]="
                    optionDDorderType(fileFieldsForm.get('21')?.get('effectiveValue')
                          .value === 1
                          ? fileFieldsForm.get('9')?.get('effectiveValue')
                              .value === 'חשבונית מס' ||
                            fileFieldsForm.get('9')?.get('effectiveValue')
                              .value === 'חשבונית מס קבלה' ||
                            fileFieldsForm.get('9')?.get('effectiveValue')
                              .value === 'חשבונית זיכוי' ||
                            fileFieldsForm.get('9')?.get('effectiveValue')
                              .value === 'אחר'
                            ? vatOptionsAll
                            : vatOptions
                          : vatOptionsIncome)
                      "
                                            [pTooltip]="'מקביל לסוג תנועה בהנה״ח'"
                                            [style]="{ width: '100%' }"
                                            appendTo="body"
                                            formControlName="orderType"
                                            name="orderType"

                                            optionDisabled="disabled"
                                            placeholder="בחירה"
                                            tooltipPosition="top"
                                        >
                                            <ng-template let-option pTemplate="item">
                                                <div>
                                                    <div
                                                            [ngStyle]="
                              !isMaamOpen &&
                              option.value === 'OPEN' &&
                              arr.controls.length > 1
                                ? { opacity: '0.4', cursor: 'default' }
                                : ''
                            "
                                                    >
                                                        {{ option.label }}
                                                    </div>
                                                </div>
                                            </ng-template>
                                        </p-dropdown>
                                    </ng-container>
                                </div>
                            </div>
                            <div class="border"></div>
                            <ng-container
                                    *ngTemplateOutlet="
                  (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                    1 &&
                    showNegative &&
                    fileFieldsForm.get('9')?.get('effectiveValue').value ===
                      'חשבונית זיכוי') ||
                  (fileFieldsForm.get('21')?.get('effectiveValue').value !==
                    1 &&
                    !showNegative &&
                    fileFieldsForm.get('9')?.get('effectiveValue').value ===
                      'חשבונית זיכוי') ||
                  (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                    1 &&
                    showNegative &&
                    fileFieldsForm.get('9')?.get('effectiveValue').value !==
                      'חשבונית זיכוי') ||
                  (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                    1 &&
                    !showNegative &&
                    fileFieldsForm.get('9')?.get('effectiveValue').value !==
                      'חשבונית זיכוי')
                    ? expenseTemp
                    : incomeTemp
                "
                            >
                            </ng-container>
                            <div class="border"></div>

                            <ng-container
                                    *ngTemplateOutlet="
                  (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                    1 &&
                    showNegative &&
                    fileFieldsForm.get('9')?.get('effectiveValue').value ===
                      'חשבונית זיכוי') ||
                  (fileFieldsForm.get('21')?.get('effectiveValue').value !==
                    1 &&
                    !showNegative &&
                    fileFieldsForm.get('9')?.get('effectiveValue').value ===
                      'חשבונית זיכוי') ||
                  (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                    1 &&
                    showNegative &&
                    fileFieldsForm.get('9')?.get('effectiveValue').value !==
                      'חשבונית זיכוי') ||
                  (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                    1 &&
                    !showNegative &&
                    fileFieldsForm.get('9')?.get('effectiveValue').value !==
                      'חשבונית זיכוי')
                    ? incomeTemp
                    : expenseTemp
                "
                            >
                            </ng-container>

                            <ng-container *ngIf="isMatah">
                                <div class="border"></div>
                                <ng-container
                                        *ngTemplateOutlet="
                    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'חשבונית זיכוי') ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value !==
                      1 &&
                      !showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'חשבונית זיכוי') ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value !==
                        'חשבונית זיכוי') ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      !showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value !==
                        'חשבונית זיכוי')
                      ? expenseTempSums
                      : incomeTempSums
                  "
                                >
                                </ng-container>
                                <ng-container
                                        *ngTemplateOutlet="
                    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'חשבונית זיכוי') ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value !==
                      1 &&
                      !showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'חשבונית זיכוי') ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value !==
                        'חשבונית זיכוי') ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      !showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value !==
                        'חשבונית זיכוי')
                      ? incomeTempSums
                      : expenseTempSums
                  "
                                >
                                </ng-container>
                            </ng-container>

                            <ng-container *ngIf="isMatah">
                                <div class="border"></div>
                                <ng-container
                                        *ngTemplateOutlet="
                    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'חשבונית זיכוי') ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value !==
                      1 &&
                      !showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'חשבונית זיכוי') ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value !==
                        'חשבונית זיכוי') ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      !showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value !==
                        'חשבונית זיכוי')
                      ? expenseMatahTemp
                      : incomeMatahTemp
                  "
                                >
                                </ng-container>
                                <ng-container
                                        *ngTemplateOutlet="
                    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'חשבונית זיכוי') ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value !==
                      1 &&
                      !showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'חשבונית זיכוי') ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value !==
                        'חשבונית זיכוי') ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      !showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value !==
                        'חשבונית זיכוי')
                      ? incomeMatahTemp
                      : expenseMatahTemp
                  "
                                >
                                </ng-container>
                            </ng-container>

                            <ng-container *ngIf="revaluationCurrCode">
                                <div class="border"></div>
                                <ng-container
                                        *ngTemplateOutlet="
                    fileFieldsForm.get('21')?.get('effectiveValue').value === 1
                      ? expenseRevaluationCurrCodeTemp
                      : incomeRevaluationCurrCodeTemp
                  "
                                >
                                </ng-container>
                                <ng-container
                                        *ngTemplateOutlet="
                    fileFieldsForm.get('21')?.get('effectiveValue').value === 1
                      ? incomeRevaluationCurrCodeTemp
                      : expenseRevaluationCurrCodeTemp
                  "
                                >
                                </ng-container>
                            </ng-container>

                            <div class="border"></div>
                            <div style="position: relative">
                                <img
                                        (click)="
                    !item.showAsmachta2
                      ? (item.showAsmachta2 = true)
                      : (item.showAsmachta3 = true)
                  "
                                        *ngIf="
                    (!item.get('asmachta3').value ||
                      item.get('asmachta3').value === '') &&
                    !item.showAsmachta3
                  "
                                        class="plusIconAsmachta"
                                        src="/assets/images/thirdDateActive.png"
                                />

                                <img
                                        (click)="
                    arr.controls.length === 1
                      ? (showDocumentListStorageDataFired =
                          'showDocumentAtleft')
                      : arr.controls.length > 3 || getJournalHistory.length
                      ? (showDocumentListStorageDataFired =
                          'showDocumentAtSecond')
                      : (showDocumentListStorageDataFired =
                          'showDocumentAtBottom');
                    dialogMaskListen()
                  "
                                        *ngIf="i === 0"
                                        class="openInvoiceModal"
                                        src="/assets/images/openInvoiceModal.png"
                                />

                                <div class="flex" style="margin-bottom: 10px">
                                    <p style="width: 64px">
                                        {{ fieldNameAsmachta }}
                                    </p>
                                    <div style="max-width: 200px">
                                        <input
                                                appNumbersOnly="positive"
                                                autocomplete="off"
                                                class="input-show"
                                                formControlName="asmachta"
                                        />
                                    </div>
                                </div>
                                <div
                                        *ngIf="
                    (item.get('asmachta2').value &&
                      item.get('asmachta2').value !== '') ||
                    item?.showAsmachta2
                  "
                                        class="flex"
                                        style="margin-bottom: 10px"
                                >
                                    <p style="width: 64px">
                                        אסמכ.
                                        {{ fieldNameAsmachta === 'אסמכתא 1' ? '2' : '1' }}
                                        <!--                                        {{fileFieldsForm.get('21')?.get('effectiveValue').value === 0 ?-->
                                        <!--                                        (incomeAsmachtaType === 2 ? '1' : '2')-->
                                        <!--                                        :-->
                                        <!--                                        (expenseAsmachtaType === 1 ? '2' : '1')}}-->
                                    </p>
                                    <div
                                            style="max-width: 185px; display: flex; align-items: center"
                                    >
                                        <input
                                                [size]="
                        item.get('asmachta2').value
                          ? item.get('asmachta2').value.length
                          : 26
                      "
                                                appNumbersOnly="positive"
                                                autocomplete="off"
                                                class="input-show"
                                                formControlName="asmachta2"
                                                maxlength="14"
                                                style="cursor: text"
                                        />
                                        <mat-icon
                                                (click)="
                        item.showAsmachta2 = false;
                        item.get('asmachta2').patchValue('')
                      "
                                                style="
                        color: #022258;
                        margin-right: 3px;
                        cursor: pointer;
                        width: 15px;
                        height: 15px;
                        display: block;
                      "
                                                svgIcon="trash"
                                        >
                                        </mat-icon>
                                    </div>
                                </div>
                                <div
                                        *ngIf="
                    (item.get('asmachta3').value &&
                      item.get('asmachta3').value !== '') ||
                    item['showAsmachta3']
                  "
                                        class="flex"
                                        style="margin-bottom: 10px"
                                >
                                    <p style="width: 64px">אסמכ. 3</p>
                                    <div
                                            style="max-width: 185px; display: flex; align-items: center"
                                    >
                                        <input
                                                [size]="
                        item.get('asmachta3').value
                          ? item.get('asmachta3').value.length
                          : 26
                      "
                                                appNumbersOnly="positive"
                                                autocomplete="off"
                                                class="input-show"
                                                formControlName="asmachta3"
                                                maxlength="14"
                                                style="cursor: text"
                                        />
                                        <mat-icon
                                                (click)="
                        item.showAsmachta3 = false;
                        item.get('asmachta3').patchValue('')
                      "
                                                style="
                        color: #022258;
                        margin-right: 3px;
                        cursor: pointer;
                        width: 15px;
                        height: 15px;
                        display: block;
                      "
                                                svgIcon="trash"
                                        >
                                        </mat-icon>
                                    </div>
                                </div>
                                <div class="flex">
                                    <p style="width: 64px">פרטים</p>
                                    <div style="max-width: 200px">
                                        <input
                                            #inputElement
                                            (blur)="inputElement.elemNotReadonly = false"
                                            (click)="
                        inputElement.elemNotReadonly = true;
                        inputElement.focus()
                      "
                                            [pTooltip]="item.get('details').value"
                                            [readonly]="!inputElement.elemNotReadonly"
                                            [size]="
                        item.get('details').value
                          ? item.get('details').value.length
                          : 26
                      "
                                            [tooltipDisabled]="
                        inputElement.offsetWidth >= inputElement.scrollWidth
                      "
                                            autocomplete="off"
                                            class="input-show text-ellipsis"
                                            formControlName="details"
                                            style="cursor: text"
                                            tooltipPosition="top"
                                        />
                                    </div>
                                </div>
                            </div>

                            <ng-template #expenseTemp>
                                <div>
                                    <div
                                            class="flex"
                                            style="
                      margin-bottom: 10px;
                      justify-content: space-between;
                      width: max-content;
                    "
                                    >
                                        <div
                                                [ngStyle]="{
                        width: isMatah ? '170px' : '185px',
                        'min-width': isMatah ? '170px' : '185px'
                      }"
                                        >
                                            <ng-container
                                                    *ngIf="
                          userService.appData.userData.companyCustomerDetails &&
                          userService.appData.userData.companyCustomerDetails
                            .all
                        "
                                            >
                                                <app-dropdown-wrap
                                                    #formDropdowns
                                                    #formDropdownsCartis
                                                    [autoDisplayFirst]="false"
                                                    [class.invalid]="
                            arr.controls[i].get('custData').enabled &&
                            arr.controls[i].get('custData').invalid
                          "
                                                    [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                                    [filter]="true"
                                                    [options]="
                            setDisabledDD(userService.appData.userData.companyCustomerDetails.all, i)
                          "
                                                    [resetFilterOnHide]="true"
                                                    [style]="{ width: isMatah ? '170px' : '185px' }"
                                                    [virtualScroll]="true"
                                                    [virtualScrollItemSize]="38"
                                                    appendTo="body"
                                                    dataKey="custId"
                                                    emptyFilterMessage="לא נמצאו תוצאות"
                                                    filterBy="lName,custId"
                                                    formControlName="custData"
                                                    name="custData"

                                                    optionLabel="custId"
                                                    panelStyleClass="company-customer-dropdown-panel cardsDD card195 cardsDD40"
                                                    placeholder="בחירה"
                                                >
                                                    <ng-template let-item pTemplate="selectedItem">
                            <span
                                #spanElement
                                [pTooltip]="item.cartisName"
                                [tooltipDisabled]="
                                spanElement.offsetWidth >=
                                spanElement.scrollWidth
                              "
                                style="
                                vertical-align: middle;
                                display: block;
                                white-space: nowrap;
                                overflow: hidden;
                                text-overflow: ellipsis;
                              "
                                tooltipPosition="top"
                            >{{ item.cartisName }}</span
                            >
                                                    </ng-template>
                                                    <!--                                                    <ng-template let-item pTemplate="item">-->
                                                    <!--                                                        <div class="p-helper-clearfix">-->
                                                    <!--                                                            <div>-->
                                                    <!--                                                                <span class="text-ellipsis">{{item.custId}}</span>-->
                                                    <!--                                                            </div>-->
                                                    <!--                                                            <div class="separator" *ngIf="item.lName">-->
                                                    <!--                                                                <span>-</span></div>-->
                                                    <!--                                                            <div>-->
                                                    <!--                                                                <span class="text-ellipsis"-->
                                                    <!--                                                                      *ngIf="item.lName">{{item.lName}}</span>-->
                                                    <!--                                                            </div>-->
                                                    <!--                                                        </div>-->
                                                    <!--                                                    </ng-template>-->

                                                    <!--                                                    (arr.controls[i].get('orderType').value === 'OPEN' ?-->
                                                    <!--                                                    (arr.controls[i].get('custDataMaam').value && arr.controls[i].get('custDataMaam').value === item.custId)-->
                                                    <!--                                                    :-->
                                                    <!--                                                    (arr.controls[i].get('custDataMaam').value && arr.controls[i].get('custDataMaam').value.custId && arr.controls[i].get('custDataMaam').value.custId === item.custId))-->


                                                    <ng-template let-item pTemplate="item">
                                                        <div
                                                                [ngStyle]="
                                (arr.controls[i].get('orderType').value ===
                                'OPEN'
                                  ? arr.controls[i].get('custDataMaam').value &&
                                    arr.controls[i].get('custDataMaam')
                                      .value === item.custId
                                  : arr.controls[i].get('custDataMaam').value &&
                                    arr.controls[i].get('custDataMaam').value
                                      .custId &&
                                    arr.controls[i].get('custDataMaam').value
                                      .custId === item.custId) ||
                                (arr.controls[i].get('indexData').value &&
                                  arr.controls[i].get('indexData').value
                                    .custId &&
                                  arr.controls[i].get('indexData').value
                                    .custId === item.custId)
                                  ? { opacity: '0.4', cursor: 'default' }
                                  : ''
                              "
                                                                class="p-helper-clearfix"
                                                                style="flex-flow: column"
                                                        >
                                                            <div>
                <span class="text-ellipsis">{{
                    item.cartisName
                    }}</span>
                                                            </div>

                                                            <div style="font-size: 12px">
                  <span
                          class="text-ellipsis secondary"
                  >


					  	<ng-container
                                *ngIf="
                                  arr.controls[i].get('indexData').value &&
                                  arr.controls[i].get('indexData').value
                                    .custId &&
                                  arr.controls[i].get('indexData').value
                                    .custId === item.custId
                                "
                                style="
                                  flex: none;
                                  width: 100%;
                                  height: auto;
                                  line-height: normal;
                                "
                        >
																הכרטיס כבר נבחר בכרטיס ספק/לקוח
															</ng-container>
															<ng-container
                                                                    *ngIf="
                                  arr.controls[i].get('orderType').value ===
                                  'OPEN'
                                    ? arr.controls[i].get('custDataMaam')
                                        .value &&
                                      arr.controls[i].get('custDataMaam')
                                        .value === item.custId
                                    : arr.controls[i].get('custDataMaam')
                                        .value &&
                                      arr.controls[i].get('custDataMaam').value
                                        .custId &&
                                      arr.controls[i].get('custDataMaam').value
                                        .custId === item.custId
                                "
                                                                    style="
                                  flex: none;
                                  width: 100%;
                                  height: auto;
                                  line-height: normal;
                                "
                                                            >
																הכרטיס כבר נבחר בשדה כרטיס מע״מ
															</ng-container>

</span>


                                                            </div>

                                                        </div>
                                                    </ng-template>


                                                    <!--                                                    <ng-template pTemplate="noItem">-->
                                                    <!--                                                        <div class="p-helper-clearfix"-->
                                                    <!--                                                             style="font-size: .95em; padding: .3em 1em;">-->
                                                    <!--                                                            <div>לא מצאת את הכרטיס שחיפשת?</div>-->
                                                    <!--                                                            <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                    <!--                                                            <button class="button-link"-->
                                                    <!--                                                                    style="padding: 0; font-size: inherit;">-->
                                                    <!--                                                                ולחצו על-->
                                                    <!--                                                                רענון הנתונים-->
                                                    <!--                                                            </button>-->
                                                    <!--                                                        </div>-->
                                                    <!--                                                    </ng-template>-->

                                                    <ng-template pTemplate="empty">
                                                        <div
                                                                class="p-helper-clearfix"
                                                                style="font-size: 0.95em; padding: 0.3em 1em"
                                                        >
                                                            <!--                                                            <ng-container *ngIf="!loaderGetCompanyCustomerDetails; else loader">-->
                                                            <!--                                                                <div>לא מצאת את הכרטיס שחיפשת?</div>-->
                                                            <!--                                                                <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                            <!--                                                                <button class="button-link" style="padding: 0; font-size: inherit;"-->
                                                            <!--                                                                        (click)="getCompanyCustomerDetailsTimer(); $event.stopPropagation()">-->
                                                            <!--                                                                    ולחצו על-->
                                                            <!--                                                                    רענון הנתונים-->
                                                            <!--                                                                </button>-->
                                                            <!--                                                            </ng-container>-->

                                                            <!--                                                            <ng-container-->
                                                            <!--                                                                    *ngIf="!loaderGetCompanyCustomerDetails; else loader">-->
                                                            <!--                                                                <div>לא מצאתם את הכרטיס שחיפשתם?</div>-->
                                                            <!--                                                                <div>צרו כרטיס חדש בחשבשבת.</div>-->
                                                            <!--                                                                <div>-->
                                                            <!--                                                                    בנתיים ניתן לעדכן ידנית עד שנמשוך <br>-->
                                                            <!--                                                                    את פרטי הכרטיס.-->
                                                            <!--                                                                </div>-->
                                                            <!--                                                                <button class="button-link"-->
                                                            <!--                                                                        style="padding: 0; font-size: inherit;"-->
                                                            <!--                                                                        (click)="setValCartisModal(formDropdowns, arr.controls[i].get('custData')); formDropdowns.putStyle(); getCompanyCustomerDetailsTimer(); $event.stopPropagation()">-->
                                                            <!--                                                                    לעדכון ידני לחצו פה-->
                                                            <!--                                                                </button>-->
                                                            <!--                                                            </ng-container>-->
                                                            <!--                                                            <ng-template #loader>-->
                                                            <!--                                                                <div style="height: 84px;">-->
                                                            <!--                                                                    <div class="loaderPercent blueCircle"-->
                                                            <!--                                                                         style="background: #e6e5e5;">-->
                                                            <!--                                                                        <div class="circle"></div>-->
                                                            <!--                                                                    </div>-->
                                                            <!--                                                                </div>-->
                                                            <!--                                                                <div style="-->
                                                            <!--    z-index: 999;-->
                                                            <!--    position: absolute;-->
                                                            <!--    bottom: 26px;-->
                                                            <!--    font-size: 14.5px;-->
                                                            <!--    text-align: center;-->
                                                            <!--    font-weight: 600;-->
                                                            <!--    left: 0;-->
                                                            <!--    right: 0;-->
                                                            <!--">-->
                                                            <!--                                                                    מתבצע סינכרון-->
                                                            <!--                                                                </div>-->
                                                            <!--                                                            </ng-template>-->

                                                            <ng-container>
                                                                <!--                                                                <div>לא מצאת את הכרטיס?</div>-->
                                                                <!--                                                                <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                                <!--                                                                <div>-->
                                                                <!--                                                                    ובנתיים-->
                                                                <!--                                                                    <button class="button-link"-->
                                                                <!--                                                                            style="padding: 0; font-size: inherit; text-decoration: underline"-->
                                                                <!--                                                                            (click)="setValCartisModal(formDropdowns, arr.controls[i].get('custData'));  getCompanyCustomerDetailsTimer();">-->
                                                                <!--                                                                        לחצו לעדכון-->
                                                                <!--                                                                    </button>-->
                                                                <!--                                                                </div>-->

                                                                <div>לא מצאתם את הכרטיס שחיפשתם?</div>
                                                                <div>צרו כרטיס חדש בחשבשבת.</div>
                                                                <div>
                                                                    בינתיים ניתן לעדכן ידנית את
                                                                    <strong style="font-weight: 700">
                                                                        מפתח הכרטיס במדויק
                                                                    </strong>
                                                                    <br/>
                                                                    עד שנמשוך את פרטי הכרטיס.
                                                                </div>
                                                                <button
                                                                        (click)="
                                    setValCartisModal(
                                      formDropdowns,
                                      arr.controls[i].get('custData')
                                    );
                                    getCompanyCustomerDetailsTimer()
                                  "
                                                                        class="button-link"
                                                                        style="
                                    padding: 0;
                                    font-size: inherit;
                                    text-decoration: underline;
                                  "
                                                                >
                                                                    לעדכון ידני לחצו פה
                                                                </button>
                                                            </ng-container>
                                                        </div>
                                                    </ng-template>
                                                    <ng-template pTemplate="emptyfilter">
                                                        <div
                                                                class="p-helper-clearfix"
                                                                style="font-size: 0.95em; padding: 0.3em 1em"
                                                        >
                                                            <!--                                                            <ng-container *ngIf="!loaderGetCompanyCustomerDetails; else loader">-->
                                                            <!--                                                                <div>לא מצאת את הכרטיס שחיפשת?</div>-->
                                                            <!--                                                                <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                            <!--                                                                <button class="button-link" style="padding: 0; font-size: inherit;"-->
                                                            <!--                                                                        (click)="getCompanyCustomerDetailsTimer(); $event.stopPropagation()">-->
                                                            <!--                                                                    ולחצו על-->
                                                            <!--                                                                    רענון הנתונים-->
                                                            <!--                                                                </button>-->
                                                            <!--                                                            </ng-container>-->

                                                            <!--                                                            <ng-container-->
                                                            <!--                                                                    *ngIf="!loaderGetCompanyCustomerDetails; else loader">-->
                                                            <!--                                                                <div>לא מצאתם את הכרטיס שחיפשתם?</div>-->
                                                            <!--                                                                <div>צרו כרטיס חדש בחשבשבת.</div>-->
                                                            <!--                                                                <div>-->
                                                            <!--                                                                    בנתיים ניתן לעדכן ידנית עד שנמשוך <br>-->
                                                            <!--                                                                    את פרטי הכרטיס.-->
                                                            <!--                                                                </div>-->
                                                            <!--                                                                <button class="button-link"-->
                                                            <!--                                                                        style="padding: 0; font-size: inherit;"-->
                                                            <!--                                                                        (click)="setValCartisModal(formDropdowns, arr.controls[i].get('custData')); formDropdowns.putStyle(); getCompanyCustomerDetailsTimer(); $event.stopPropagation()">-->
                                                            <!--                                                                    לעדכון ידני לחצו פה-->
                                                            <!--                                                                </button>-->
                                                            <!--                                                            </ng-container>-->
                                                            <!--                                                            <ng-template #loader>-->
                                                            <!--                                                                <div style="height: 84px;">-->
                                                            <!--                                                                    <div class="loaderPercent blueCircle"-->
                                                            <!--                                                                         style="background: #e6e5e5;">-->
                                                            <!--                                                                        <div class="circle"></div>-->
                                                            <!--                                                                    </div>-->
                                                            <!--                                                                </div>-->
                                                            <!--                                                                <div style="-->
                                                            <!--    z-index: 999;-->
                                                            <!--    position: absolute;-->
                                                            <!--    bottom: 26px;-->
                                                            <!--    font-size: 14.5px;-->
                                                            <!--    text-align: center;-->
                                                            <!--    font-weight: 600;-->
                                                            <!--    left: 0;-->
                                                            <!--    right: 0;-->
                                                            <!--">-->
                                                            <!--                                                                    מתבצע סינכרון-->
                                                            <!--                                                                </div>-->
                                                            <!--                                                            </ng-template>-->

                                                            <ng-container>
                                                                <!--                                                                <div>לא מצאת את הכרטיס?</div>-->
                                                                <!--                                                                <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                                <!--                                                                <div>-->
                                                                <!--                                                                    ובנתיים-->
                                                                <!--                                                                    <button class="button-link"-->
                                                                <!--                                                                            style="padding: 0; font-size: inherit; text-decoration: underline"-->
                                                                <!--                                                                            (click)="setValCartisModal(formDropdowns, arr.controls[i].get('custData'));  getCompanyCustomerDetailsTimer();">-->
                                                                <!--                                                                        לחצו לעדכון-->
                                                                <!--                                                                    </button>-->
                                                                <!--                                                                </div>-->

                                                                <div>לא מצאתם את הכרטיס שחיפשתם?</div>
                                                                <div>צרו כרטיס חדש בחשבשבת.</div>
                                                                <div>
                                                                    בינתיים ניתן לעדכן ידנית את
                                                                    <strong style="font-weight: 700">
                                                                        מפתח הכרטיס במדויק
                                                                    </strong>
                                                                    <br/>
                                                                    עד שנמשוך את פרטי הכרטיס.
                                                                </div>
                                                                <button
                                                                        (click)="
                                    setValCartisModal(
                                      formDropdowns,
                                      arr.controls[i].get('custData')
                                    );
                                    getCompanyCustomerDetailsTimer()
                                  "
                                                                        class="button-link"
                                                                        style="
                                    padding: 0;
                                    font-size: inherit;
                                    text-decoration: underline;
                                  "
                                                                >
                                                                    לעדכון ידני לחצו פה
                                                                </button>
                                                            </ng-container>
                                                        </div>
                                                    </ng-template>
                                                </app-dropdown-wrap>
                                            </ng-container>
                                        </div>
                                        <div
                                                style="align-self: stretch; width: 11px; height: auto"
                                        ></div>
                                        <div
                                                *ngIf="!isMatah"
                                                [class.disabled]="
                        arr.controls[i].get('totalWithoutMaam').disabled
                      "
                                                [class.invalid]="
                        arr.controls[i].get('totalWithoutMaam').enabled &&
                        ((arr.controls[0].get('orderType').value === 'OPEN' &&
                          isShowAlert(i)) ||
                          arr.controls[i].get('totalWithoutMaam').invalid ||
                          getNum(
                            arr.controls[i].get('totalWithoutMaam').value
                          ) === 0)
                      "
                                                class="input setPaddingAndBorder"
                                                style="width: 85px; display: flex"
                                        >
                                            <input
                                                    (keyup)="
                          calcByTypeChange(false, i, true, 'totalWithoutMaam')
                        "
                                                    appNumbersOnly="numWithTwoDec"
                                                    autocomplete="off"
                                                    formControlName="totalWithoutMaam"
                                            />

                                            <app-sum-view
                                                    *ngIf="arr.controls[i].get('totalWithoutMaam').value"
                                                    [sum]="arr.controls[i].get('totalWithoutMaam').value"
                                                    class="text-item text-ellipsis"
                                                    style="padding-left: 0"
                                            ></app-sum-view>

                                            <p
                                                    *ngIf="
                          showNegative &&
                          arr.controls[i].get('totalWithoutMaam').value
                        "
                                            >
                                                -
                                            </p>

                                            <p
                                                    *ngIf="!arr.controls[i].get('totalWithoutMaam').value"
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>
                                        </div>
                                    </div>
                                    <div
                                            *ngIf="arr.controls[i].get('orderType').value !== 'NONE'"
                                            class="flex"
                                            style="justify-content: space-between; width: max-content"
                                    >
                                        <div
                                                *ngIf="!arr.controls[i].get('orderType').dirty"
                                                [ngStyle]="{
                        width: isMatah ? '170px' : '185px',
                        'min-width': isMatah ? '170px' : '185px'
                      }"
                                        >
                                            <p
                                                #spanElement
                                                *ngIf="
                          arr.controls[i].get('orderType').value !== 'OPEN'
                        "
                                                [pTooltip]="spanElement.textContent"
                                                [tooltipDisabled]="
                          spanElement.offsetWidth >= spanElement.scrollWidth
                        "
                                                class="text-ellipsis"
                                                tooltipPosition="top"
                                            >
                                                {{
                                                arr.controls[i].get('custDataMaam').value
                                                    ? arr.controls[i].get('custDataMaam').value.cartisName
                                                    : ''
                                                }}
                                            </p>

                                            <app-dropdown-wrap
                                                    #formDropdownsMaamCustids
                                                    *ngIf="
                          arr.controls[i].get('orderType').value === 'OPEN'
                        "
                                                    [autoDisplayFirst]="false"
                                                    [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                                    [options]="setDisabledDD_custDataMaam(userService.appData.userData.maamCustids, i)"
                                                    [style]="{ width: isMatah ? '170px' : '185px' }"
                                                    [scrollHeight]="'152px'"
                                                    [virtualScroll]="true"
                                                    [virtualScrollItemSize]="38"
                                                    appendTo="body"
                                                    formControlName="custDataMaam"
                                                    name="custDataMaam"

                                                    panelStyleClass="company-customer-dropdown-panel cardsDD card195 cardsDD40"
                                                    placeholder="בחירה"
                                            >
                                                <ng-template let-item pTemplate="selectedItem">
                                                    <div
                                                            style="
                              display: flex;
                              display: -ms-flexbox;
                              align-items: center;
                            "
                                                    >
                                                        <div
                                                            #spanElement
                                                            [pTooltip]="item?.label"
                                                            [tooltipDisabled]="
                                spanElement.offsetWidth >=
                                spanElement.scrollWidth
                              "
                                                            class="text-ellipsis"
                                                            tooltipPosition="top"
                                                        >
                                                            {{ item?.label }}
                                                        </div>
                                                    </div>
                                                </ng-template>

                                                <ng-template let-item pTemplate="item">
                                                    <div
                                                            [ngStyle]="
                              (arr.controls[i].get('custData').value &&
                                arr.controls[i].get('custData').value.custId &&
                                arr.controls[i].get('custData').value.custId ===
                                  (arr.controls[i].get('orderType').value ===
                                  'OPEN'
                                    ? item.value
                                    : item.custId)) ||
                              (arr.controls[i].get('indexData').value &&
                                arr.controls[i].get('indexData').value.custId &&
                                arr.controls[i].get('indexData').value
                                  .custId ===
                                  (arr.controls[i].get('orderType').value ===
                                  'OPEN'
                                    ? item.value
                                    : item.custId))
                                ? { opacity: '0.4', cursor: 'default' }
                                : ''
                            "
                                                            class="p-helper-clearfix"
                                                            style="flex-flow: column"
                                                    >
                                                        <div>
                <span class="text-ellipsis">{{
                    item.label
                    }}</span>
                                                        </div>

                                                        <div style="font-size: 12px">
                  <span
                          class="text-ellipsis secondary"
                  >

					  	<ng-container
                                *ngIf="
                                arr.controls[i].get('custData').value &&
                                arr.controls[i].get('custData').value.custId &&
                                arr.controls[i].get('custData').value.custId ===
                                  (arr.controls[i].get('orderType').value ===
                                  'OPEN'
                                    ? item.value
                                    : item.custId)
                              "
                                style="
                                flex: none;
                                width: 100%;
                                height: auto;
                                line-height: normal;
                              "
                        >
															הכרטיס כבר נבחר בכרטיס ספק/לקוח
														</ng-container>
														<ng-container
                                                                *ngIf="
                                arr.controls[i].get('indexData').value &&
                                arr.controls[i].get('indexData').value.custId &&
                                arr.controls[i].get('indexData').value
                                  .custId ===
                                  (arr.controls[i].get('orderType').value ===
                                  'OPEN'
                                    ? item.value
                                    : item.custId)
                              "
                                                                style="
                                flex: none;
                                width: 100%;
                                height: auto;
                                line-height: normal;
                              "
                                                        >
															הכרטיס כבר נבחר בכרטיס ספק/לקוח
														</ng-container>
</span>


                                                        </div>

                                                    </div>
                                                </ng-template>

                                                <ng-template pTemplate="empty">
                                                    <div
                                                            class="p-helper-clearfix"
                                                            style="font-size: 0.95em; padding: 0.3em 1em"
                                                    >
                                                        <div>לא נמצאו נתונים</div>
                                                    </div>
                                                </ng-template>
                                            </app-dropdown-wrap>
                                        </div>

                                        <ng-container
                                                *ngIf="arr.controls[i].get('orderType').dirty"
                                        >
                                            <div
                                                    *ngIf="
                          fileFieldsForm.get('21')?.get('effectiveValue')
                            .value === 1;
                          else incomeCartisMaam
                        "
                                                    [ngStyle]="{
                          width: isMatah ? '170px' : '185px',
                          'min-width': isMatah ? '170px' : '185px'
                        }"
                                            >
                                                <ng-container
                                                        [ngSwitch]="arr.controls[i].get('orderType').value"
                                                >
                                                    <ng-container *ngSwitchCase="'OPEN'">
                                                        <app-dropdown-wrap
                                                                #formDropdownsMaamCustids
                                                                *ngIf="
                                arr.controls[i].get('orderType').value ===
                                'OPEN'
                              "
                                                                [autoDisplayFirst]="false"
                                                                [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                                                [options]="setDisabledDD_custDataMaam_open(userService.appData.userData.maamCustids, i)"
                                                                [style]="{ width: isMatah ? '170px' : '185px' }"
                                                                [virtualScroll]="true"
                                                                [virtualScrollItemSize]="38"
                                                                appendTo="body"
                                                                [scrollHeight]="'152px'"
                                                                formControlName="custDataMaam"
                                                                name="custDataMaam"

                                                                panelStyleClass="company-customer-dropdown-panel cardsDD card195 cardsDD40"
                                                                placeholder="בחירה"
                                                        >
                                                            <ng-template let-item pTemplate="selectedItem">
                                                                <div
                                                                    #spanElement
                                                                    [pTooltip]="item?.label"
                                                                    [tooltipDisabled]="
                                    spanElement.offsetWidth >=
                                    spanElement.scrollWidth
                                  "
                                                                    style="
                                    display: flex;
                                    display: -ms-flexbox;
                                    align-items: center;
                                  "
                                                                    tooltipPosition="top"
                                                                >
                                                                    <div class="text-ellipsis">
                                                                        {{ item?.label }}
                                                                    </div>
                                                                </div>
                                                            </ng-template>


                                                            <ng-template let-item pTemplate="item">
                                                                <div
                                                                        [ngStyle]="
                                    (arr.controls[i].get('custData').value &&
                                      arr.controls[i].get('custData').value
                                        .custId &&
                                      arr.controls[i].get('custData').value
                                        .custId === item.custId) ||
                                    (arr.controls[i].get('indexData').value &&
                                      arr.controls[i].get('indexData').value
                                        .custId &&
                                      arr.controls[i].get('indexData').value
                                        .custId === item.custId)
                                      ? { opacity: '0.4', cursor: 'default' }
                                      : ''
                                  "
                                                                        class="p-helper-clearfix"
                                                                        style="flex-flow: column"
                                                                >
                                                                    <div>
                <span class="text-ellipsis">{{
                    item.label
                    }}</span>
                                                                    </div>

                                                                    <div style="font-size: 12px">
                  <span
                          class="text-ellipsis secondary"
                  >

					  		<ng-container
                                    *ngIf="
                                      arr.controls[i].get('custData').value &&
                                      arr.controls[i].get('custData').value
                                        .custId &&
                                      arr.controls[i].get('custData').value
                                        .custId === item.custId
                                    "
                                    style="
                                      flex: none;
                                      width: 100%;
                                      height: auto;
                                      line-height: normal;
                                    "
                            >
																		הכרטיס כבר נבחר בכרטיס ספק/לקוח
																	</ng-container>
																	<ng-container
                                                                            *ngIf="
                                      arr.controls[i].get('indexData').value &&
                                      arr.controls[i].get('indexData').value
                                        .custId &&
                                      arr.controls[i].get('indexData').value
                                        .custId === item.custId
                                    "
                                                                            style="
                                      flex: none;
                                      width: 100%;
                                      height: auto;
                                      line-height: normal;
                                    "
                                                                    >
																		הכרטיס כבר נבחר בכרטיס ספק/לקוח
																	</ng-container>







</span>


                                                                    </div>

                                                                </div>
                                                            </ng-template>


                                                            <ng-template pTemplate="empty">
                                                                <div
                                                                        class="p-helper-clearfix"
                                                                        style="font-size: 0.95em; padding: 0.3em 1em"
                                                                >
                                                                    <div>לא נמצאו נתונים</div>
                                                                </div>
                                                            </ng-template>

                                                        </app-dropdown-wrap>

                                                        <!--                                                    <ng-container-->
                                                        <!--                                                            *ngIf="userService.appData.userData.companyCustomerDetails.all">-->
                                                        <!--                                                        <p-dropdown-->
                                                        <!--                                                                (hideOutput)="hideDropCartis();"-->
                                                        <!--                                                                formControlName="custDataMaam"-->
                                                        <!--                                                                [options]="userService.appData.userData.companyCustomerDetails.all"-->
                                                        <!--                                                                [autoDisplayFirst]="false"-->
                                                        <!--                                                                placeholder="בחירה"-->
                                                        <!--                                                                [filter]="true" filterBy="value.lName,value.custId"-->
                                                        <!--                                                                emptyFilterMessage="לא נמצאו תוצאות"-->
                                                        <!--                                                                optionLabel="custId" dataKey="custId" -->
                                                        <!--                                                                appendTo="body"-->
                                                        <!--                                                                [style]="{'width': '100%'}"-->
                                                        <!--                                                                panelStyleClass="company-customer-dropdown-panel cardsDD"-->
                                                        <!--                                                                #formDropdowns>-->
                                                        <!--                                                            <ng-template let-item pTemplate="selectedItem">-->
                                                        <!--                                    <span style="vertical-align:middle;display: block;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;"-->
                                                        <!--                                          #spanElement-->
                                                        <!--                                          [tooltipDisabled]="spanElement.offsetWidth >= spanElement.scrollWidth"-->
                                                        <!--                                          [pTooltip]="arr.controls[i].get('custDataMaam').value.cartisName"-->
                                                        <!--                                          tooltipPosition="top">{{item.cartisName}}</span>-->
                                                        <!--                                                            </ng-template>-->

                                                        <!--                                                            <ng-template let-item pTemplate="item">-->
                                                        <!--                                                                <div class="p-helper-clearfix"-->
                                                        <!--                                                                     style="flex-flow: row wrap"-->
                                                        <!--                                                                     [ngStyle]="((arr.controls[i].get('custDataMaam').value && arr.controls[i].get('custDataMaam').value.custId && arr.controls[i].get('custDataMaam').value.custId === item.custId)-->
                                                        <!--                                                                      ) ? {'opacity': '0.4', 'cursor': 'default'} : ''"-->
                                                        <!--                                                                     (click)="((arr.controls[i].get('custDataMaam').value && arr.controls[i].get('custDataMaam').value.custId && arr.controls[i].get('custDataMaam').value.custId === item.custId)-->
                                                        <!--                                                                     ) ? $event.stopPropagation() : null">-->
                                                        <!--                                                                    <div>-->
                                                        <!--                                                                        <span class="text-ellipsis">{{item.cartisName}}</span>-->
                                                        <!--                                                                    </div>-->
                                                        <!--                                                                    <div style="flex: none;width: 100%;height: auto;line-height: normal;"-->
                                                        <!--                                                                         *ngIf="(arr.controls[i].get('custDataMaam').value && arr.controls[i].get('custDataMaam').value.custId && arr.controls[i].get('custDataMaam').value.custId === item.custId)">-->
                                                        <!--                                                                        הכרטיס כבר נבחר בשדה כרטיס מע״מ-->
                                                        <!--                                                                    </div>-->
                                                        <!--                                                                </div>-->
                                                        <!--                                                            </ng-template>-->

                                                        <!--                                                            <ng-template pTemplate="noItem">-->
                                                        <!--                                                                <div class="p-helper-clearfix"-->
                                                        <!--                                                                     style="font-size: .95em; padding: .3em 1em;">-->
                                                        <!--&lt;!&ndash;                                                                    <ng-container *ngIf="!loaderGetCompanyCustomerDetails; else loader">&ndash;&gt;-->
                                                        <!--&lt;!&ndash;                                                                        <div>לא מצאת את הכרטיס שחיפשת?</div>&ndash;&gt;-->
                                                        <!--&lt;!&ndash;                                                                        <div>צרו כרטיס חדש בהנה"ח</div>&ndash;&gt;-->
                                                        <!--&lt;!&ndash;                                                                        <button class="button-link" style="padding: 0; font-size: inherit;"&ndash;&gt;-->
                                                        <!--&lt;!&ndash;                                                                                (click)="getCompanyCustomerDetailsTimer(); $event.stopPropagation()">&ndash;&gt;-->
                                                        <!--&lt;!&ndash;                                                                            ולחצו על&ndash;&gt;-->
                                                        <!--&lt;!&ndash;                                                                            רענון הנתונים&ndash;&gt;-->
                                                        <!--&lt;!&ndash;                                                                        </button>&ndash;&gt;-->
                                                        <!--&lt;!&ndash;                                                                    </ng-container>&ndash;&gt;-->
                                                        <!--                                                                    <ng-container *ngIf="!loaderGetCompanyCustomerDetails; else loader">-->
                                                        <!--                                                                        <div>לא מצאתם את הכרטיס שחיפשתם?</div>-->
                                                        <!--                                                                        <div>צרו כרטיס חדש בחשבשבת.</div>-->
                                                        <!--                                                                        <div>-->
                                                        <!--                                                                            בנתיים ניתן לעדכן ידנית עד שנמשוך <br>-->
                                                        <!--                                                                            את פרטי הכרטיס.-->
                                                        <!--                                                                        </div>-->
                                                        <!--                                                                        <button class="button-link" style="padding: 0; font-size: inherit;"-->
                                                        <!--                                                                                (click)="setValCartisModal(formDropdowns, arr.controls[i].get('custDataMaam')); formDropdowns.putStyle(); getCompanyCustomerDetailsTimer(); $event.stopPropagation()">-->
                                                        <!--                                                                            לעדכון ידני לחצו פה-->
                                                        <!--                                                                        </button>-->
                                                        <!--                                                                    </ng-container>-->
                                                        <!--                                                                    <ng-template #loader>-->
                                                        <!--                                                                        <div style="height: 84px;">-->
                                                        <!--                                                                            <div class="loaderPercent blueCircle" style="background: #e6e5e5;">-->
                                                        <!--                                                                                <div class="circle"></div>-->
                                                        <!--                                                                            </div>-->
                                                        <!--                                                                        </div>-->
                                                        <!--                                                                        <div style="-->
                                                        <!--    z-index: 999;-->
                                                        <!--    position: absolute;-->
                                                        <!--    bottom: 26px;-->
                                                        <!--    font-size: 14.5px;-->
                                                        <!--    text-align: center;-->
                                                        <!--    font-weight: 600;-->
                                                        <!--    left: 0;-->
                                                        <!--    right: 0;-->
                                                        <!--">-->
                                                        <!--                                                                            מתבצע סינכרון-->
                                                        <!--                                                                        </div>-->
                                                        <!--                                                                    </ng-template>-->
                                                        <!--                                                                </div>-->
                                                        <!--                                                            </ng-template>-->
                                                        <!--                                                        </p-dropdown>-->
                                                        <!--                                                    </ng-container>-->
                                                    </ng-container>
                                                    <ng-container *ngSwitchCase="'FULL_PROPERTY'">
                                                        <p
                                                            #spanElement
                                                            [pTooltip]="spanElement.textContent"
                                                            [tooltipDisabled]="
                                spanElement.offsetWidth >=
                                spanElement.scrollWidth
                              "
                                                            class="text-ellipsis"
                                                            tooltipPosition="top"
                                                        >
                                                            {{
                                                            userService.appData.userData
                                                                .companyCustomerDetails?.custMaamNechasim
                                                                ? userService.appData.userData
                                                                    .companyCustomerDetails?.custMaamNechasim
                                                                    ?.cartisName
                                                                : userService.appData.userData
                                                                    .companyCustomerDetails?.custMaamTsumot
                                                                    ? userService.appData.userData
                                                                        .companyCustomerDetails?.custMaamTsumot
                                                                        ?.cartisName
                                                                    : ''
                                                            }}
                                                        </p>
                                                    </ng-container>

                                                    <ng-container *ngSwitchCase="'FULL_IMPORT'">
                                                        <p
                                                            #spanElement
                                                            [pTooltip]="spanElement.textContent"
                                                            [tooltipDisabled]="
                                spanElement.offsetWidth >=
                                spanElement.scrollWidth
                              "
                                                            class="text-ellipsis"
                                                            tooltipPosition="top"
                                                        >
                                                            {{
                                                            userService.appData.userData
                                                                .companyCustomerDetails?.custMaamYevu
                                                                ? userService.appData.userData
                                                                    .companyCustomerDetails?.custMaamYevu
                                                                    ?.cartisName
                                                                : ''
                                                            }}
                                                        </p>
                                                    </ng-container>

                                                    <ng-container *ngSwitchDefault>
                                                        <p
                                                            #spanElement
                                                            [pTooltip]="spanElement.textContent"
                                                            [tooltipDisabled]="
                                spanElement.offsetWidth >=
                                spanElement.scrollWidth
                              "
                                                            class="text-ellipsis"
                                                            tooltipPosition="top"
                                                        >
                                                            {{
                                                            userService.appData.userData
                                                                .companyCustomerDetails?.custMaamTsumot
                                                                ? userService.appData.userData
                                                                    .companyCustomerDetails?.custMaamTsumot
                                                                    ?.cartisName
                                                                : ''
                                                            }}
                                                        </p>
                                                    </ng-container>
                                                </ng-container>
                                            </div>
                                            <ng-template #incomeCartisMaam>
                                                <div
                                                        [ngStyle]="{
                            width: isMatah ? '170px' : '185px',
                            'min-width': isMatah ? '170px' : '185px'
                          }"
                                                >
                                                    <p
                                                        #spanElement
                                                        [pTooltip]="spanElement.textContent"
                                                        [tooltipDisabled]="
                              spanElement.offsetWidth >= spanElement.scrollWidth
                            "
                                                        class="text-ellipsis"
                                                        tooltipPosition="top"
                                                    >
                                                        {{
                                                        userService.appData.userData
                                                            .companyCustomerDetails?.custMaamIska
                                                            ? userService.appData.userData
                                                                .companyCustomerDetails?.custMaamIska
                                                                ?.cartisName
                                                            : ''
                                                        }}
                                                    </p>
                                                </div>
                                            </ng-template>
                                        </ng-container>

                                        <div
                                                *ngIf="!isMatah"
                                                style="align-self: stretch; width: 11px; height: auto"
                                        ></div>
                                        <div
                                                *ngIf="!isMatah"
                                                [class.disabled]="
                        arr.controls[i].get('totalMaam').disabled
                      "
                                                [class.invalid]="
                        arr.controls[i].get('totalMaam').enabled &&
                        ((arr.controls[0].get('orderType').value === 'OPEN' &&
                          isShowAlert(i)) ||
                          (arr.controls[0].get('orderType').value !== 'OPEN' &&
                            (arr.controls[i].get('totalMaam').invalid ||
                              getNum(arr.controls[i].get('totalMaam').value) ===
                                0)))
                      "
                                                class="input setPaddingAndBorder"
                                                style="width: 85px; display: flex"
                                        >
                                            <input
                                                    (keyup)="calcByTypeChange(false, i, true, 'totalMaam')"
                                                    appNumbersOnly="positive"
                                                    autocomplete="off"
                                                    formControlName="totalMaam"
                                            />

                                            <app-sum-view
                                                    *ngIf="arr.controls[i].get('totalMaam').value"
                                                    [sum]="arr.controls[i].get('totalMaam').value"
                                                    class="text-item text-ellipsis"
                                                    style="padding-left: 0"
                                            ></app-sum-view>

                                            <p
                                                    *ngIf="
                          showNegative && arr.controls[i].get('totalMaam').value
                        "
                                            >
                                                -
                                            </p>
                                            <p
                                                    *ngIf="!arr.controls[i].get('totalMaam').value"
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>
                                        </div>
                                    </div>

                                    <ng-container
                                            *ngIf="arr.controls[i].get('orderType').value !== 'NONE'"
                                    >
                                        <div
                                                *ngIf="
                        arr.controls[0].get('orderType').value === 'OPEN' &&
                        isShowAlert16(i)
                      "
                                                class="flex"
                                                style="
                        font-size: 13px;
                        justify-content: space-between;
                        color: #cd1010;
                      "
                                        >
                                            סכום מע”מ בפיצול
                                            <br *ngIf="isMatah"/>
                                            גדול מסכום מע”מ בפקודה
                                        </div>
                                    </ng-container>
                                </div>
                            </ng-template>
                            <ng-template #incomeTemp>
                                <div>
                                    <div
                                            class="flex"
                                            style="
                      margin-bottom: 10px;
                      justify-content: space-between;
                      width: max-content;
                    "
                                    >
                                        <div
                                                [ngStyle]="{
                        width: isMatah ? '170px' : '185px',
                        'min-width': isMatah ? '170px' : '185px'
                      }"
                                        >
                                            <ng-container
                                                    *ngIf="
                          userService.appData.userData.companyCustomerDetails &&
                          userService.appData.userData.companyCustomerDetails
                            .all
                        "
                                            >
                                                <app-dropdown-wrap
                                                        #formDropdowns
                                                        #formDropdownsCartis
                                                        (onChange)="indexDataChange(i)"
                                                        (onHide)="hideDropCartis()"
                                                        [autoDisplayFirst]="false"
                                                        [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                                        [filter]="true"
                                                        [options]="setDisabledDD_indexData(userService.appData.userData.companyCustomerDetails.all, i)"
                                                        [resetFilterOnHide]="true"
                                                        [style]="{ width: isMatah ? '170px' : '185px' }"
                                                        [virtualScroll]="true"
                                                        [virtualScrollItemSize]="38"
                                                        appendTo="body"
                                                        class="indexDataDD"
                                                        dataKey="custId"
                                                        emptyFilterMessage="לא נמצאו תוצאות"
                                                        filterBy="lName,custId"
                                                        formControlName="indexData"
                                                        name="indexData"

                                                        optionLabel="custId"
                                                        panelStyleClass="company-customer-dropdown-panel cardsDD card195 cardsDD40"
                                                        placeholder="בחירה"
                                                >
                                                    <ng-template let-item pTemplate="selectedItem">
                            <span
                                #spanElement
                                [pTooltip]="
                                arr.controls[i].get('indexData').value.cartisName
                              "
                                [tooltipDisabled]="
                                spanElement.offsetWidth >=
                                spanElement.scrollWidth
                              "
                                style="
                                vertical-align: middle;
                                display: block;
                                white-space: nowrap;
                                overflow: hidden;
                                text-overflow: ellipsis;
                              "
                                tooltipPosition="top"
                            >{{ item.cartisName }}</span
                            >
                                                    </ng-template>
                                                    <!--                                                    <ng-template let-item pTemplate="item">-->
                                                    <!--                                                        <div class="p-helper-clearfix">-->
                                                    <!--                                                            <div>-->
                                                    <!--                                                                <span class="text-ellipsis">{{item.custId}}</span>-->
                                                    <!--                                                            </div>-->
                                                    <!--                                                            <div class="separator"-->
                                                    <!--                                                                 *ngIf="item.lName || item.hp">-->
                                                    <!--                                                                <span>-</span></div>-->
                                                    <!--                                                            <div>-->
                                                    <!--                                                                <span class="text-ellipsis"-->
                                                    <!--                                                                      *ngIf="item.lName">{{item.lName}}</span>-->
                                                    <!--                                                                <span class="text-ellipsis secondary"-->
                                                    <!--                                                                      *ngIf="item.hp">-->
                                                    <!--                        ח.פ./ע.מ. {{item.hp}}</span>-->
                                                    <!--                                                            </div>-->
                                                    <!--                                                        </div>-->
                                                    <!--                                                    </ng-template>-->

                                                    <ng-template let-item pTemplate="item">
                                                        <div
                                                                [ngStyle]="
                                (arr.controls[i].get('orderType').value ===
                                'OPEN'
                                  ? arr.controls[i].get('custDataMaam').value &&
                                    arr.controls[i].get('custDataMaam')
                                      .value === item.custId
                                  : arr.controls[i].get('custDataMaam').value &&
                                    arr.controls[i].get('custDataMaam').value
                                      .custId &&
                                    arr.controls[i].get('custDataMaam').value
                                      .custId === item.custId) ||
                                (arr.controls[i].get('custData').value &&
                                  arr.controls[i].get('custData').value
                                    .custId &&
                                  arr.controls[i].get('custData').value
                                    .custId === item.custId)
                                  ? { opacity: '0.4', cursor: 'default' }
                                  : ''
                              "
                                                                class="p-helper-clearfix"
                                                                style="flex-flow: column"
                                                        >
                                                            <div>
                <span class="text-ellipsis">{{
                    item.cartisName
                    }}</span>
                                                            </div>

                                                            <div style="font-size: 12px">
                  <span
                          class="text-ellipsis secondary"
                  >
	<ng-container
            *ngIf="item.hp">
																				 ח.פ./ע.מ. {{ item.hp }}
	</ng-container>


					  	<ng-container
                                *ngIf="
                                  arr.controls[i].get('custData').value &&
                                  arr.controls[i].get('custData').value
                                    .custId &&
                                  arr.controls[i].get('custData').value
                                    .custId === item.custId
                                "
                                style="
                                  flex: none;
                                  width: 100%;
                                  height: auto;
                                  line-height: normal;
                                "
                        >
																הכרטיס כבר נבחר בכרטיס ספק/לקוח
															</ng-container>

															<ng-container
                                                                    *ngIf="
                                  arr.controls[i].get('orderType').value ===
                                  'OPEN'
                                    ? arr.controls[i].get('custDataMaam')
                                        .value &&
                                      arr.controls[i].get('custDataMaam')
                                        .value === item.custId
                                    : arr.controls[i].get('custDataMaam')
                                        .value &&
                                      arr.controls[i].get('custDataMaam').value
                                        .custId &&
                                      arr.controls[i].get('custDataMaam').value
                                        .custId === item.custId
                                "
                                                                    style="
                                  flex: none;
                                  width: 100%;
                                  height: auto;
                                  line-height: normal;
                                "
                                                            >
																הכרטיס כבר נבחר בשדה כרטיס מע״מ
															</ng-container>

</span>


                                                            </div>

                                                        </div>
                                                    </ng-template>


                                                    <ng-template pTemplate="empty">
                                                        <div
                                                                class="p-helper-clearfix"
                                                                style="font-size: 0.95em; padding: 0.3em 1em"
                                                        >
                                                            <!--                                                            <ng-container *ngIf="!loaderGetCompanyCustomerDetails; else loader">-->
                                                            <!--                                                                <div>לא מצאת את הכרטיס שחיפשת?</div>-->
                                                            <!--                                                                <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                            <!--                                                                <button class="button-link" style="padding: 0; font-size: inherit;"-->
                                                            <!--                                                                        (click)="getCompanyCustomerDetailsTimer(); $event.stopPropagation()">-->
                                                            <!--                                                                    ולחצו על-->
                                                            <!--                                                                    רענון הנתונים-->
                                                            <!--                                                                </button>-->
                                                            <!--                                                            </ng-container>-->
                                                            <!--                                                            <ng-container-->
                                                            <!--                                                                    *ngIf="!loaderGetCompanyCustomerDetails; else loader">-->
                                                            <!--                                                                <div>לא מצאתם את הכרטיס שחיפשתם?</div>-->
                                                            <!--                                                                <div>צרו כרטיס חדש בחשבשבת.</div>-->
                                                            <!--                                                                <div>-->
                                                            <!--                                                                    בנתיים ניתן לעדכן ידנית עד שנמשוך <br>-->
                                                            <!--                                                                    את פרטי הכרטיס.-->
                                                            <!--                                                                </div>-->
                                                            <!--                                                                <button class="button-link"-->
                                                            <!--                                                                        style="padding: 0; font-size: inherit;"-->
                                                            <!--                                                                        (click)="setValCartisModal(formDropdowns, arr.controls[i].get('indexData')); formDropdowns.putStyle(); getCompanyCustomerDetailsTimer(); $event.stopPropagation()">-->
                                                            <!--                                                                    לעדכון ידני לחצו פה-->
                                                            <!--                                                                </button>-->
                                                            <!--                                                            </ng-container>-->
                                                            <!--                                                            <ng-template #loader>-->
                                                            <!--                                                                <div style="height: 84px;">-->
                                                            <!--                                                                    <div class="loaderPercent blueCircle"-->
                                                            <!--                                                                         style="background: #e6e5e5;">-->
                                                            <!--                                                                        <div class="circle"></div>-->
                                                            <!--                                                                    </div>-->
                                                            <!--                                                                </div>-->
                                                            <!--                                                                <div style="-->
                                                            <!--    z-index: 999;-->
                                                            <!--    position: absolute;-->
                                                            <!--    bottom: 26px;-->
                                                            <!--    font-size: 14.5px;-->
                                                            <!--    text-align: center;-->
                                                            <!--    font-weight: 600;-->
                                                            <!--    left: 0;-->
                                                            <!--    right: 0;-->
                                                            <!--">-->
                                                            <!--                                                                    מתבצע סינכרון-->
                                                            <!--                                                                </div>-->
                                                            <!--                                                            </ng-template>-->

                                                            <ng-container>
                                                                <!--                                                                <div>לא מצאת את הכרטיס?</div>-->
                                                                <!--                                                                <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                                <!--                                                                <div>-->
                                                                <!--                                                                    ובנתיים-->
                                                                <!--                                                                    <button class="button-link"-->
                                                                <!--                                                                            style="padding: 0; font-size: inherit; text-decoration: underline"-->
                                                                <!--                                                                            (click)="setValCartisModal(formDropdowns, arr.controls[i].get('indexData'));  getCompanyCustomerDetailsTimer();">-->
                                                                <!--                                                                        לחצו לעדכון-->
                                                                <!--                                                                    </button>-->
                                                                <!--                                                                </div>-->

                                                                <div>לא מצאתם את הכרטיס שחיפשתם?</div>
                                                                <div>צרו כרטיס חדש בחשבשבת.</div>
                                                                <div>
                                                                    בינתיים ניתן לעדכן ידנית את
                                                                    <strong style="font-weight: 700">
                                                                        מפתח הכרטיס במדויק
                                                                    </strong>
                                                                    <br/>
                                                                    עד שנמשוך את פרטי הכרטיס.
                                                                </div>
                                                                <button
                                                                        (click)="
                                    setValCartisModal(
                                      formDropdowns,
                                      arr.controls[i].get('indexData')
                                    );
                                    getCompanyCustomerDetailsTimer()
                                  "
                                                                        class="button-link"
                                                                        style="
                                    padding: 0;
                                    font-size: inherit;
                                    text-decoration: underline;
                                  "
                                                                >
                                                                    לעדכון ידני לחצו פה
                                                                </button>
                                                            </ng-container>
                                                        </div>
                                                    </ng-template>
                                                    <ng-template pTemplate="emptyfilter">
                                                        <div
                                                                class="p-helper-clearfix"
                                                                style="font-size: 0.95em; padding: 0.3em 1em"
                                                        >
                                                            <!--                                                            <ng-container *ngIf="!loaderGetCompanyCustomerDetails; else loader">-->
                                                            <!--                                                                <div>לא מצאת את הכרטיס שחיפשת?</div>-->
                                                            <!--                                                                <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                            <!--                                                                <button class="button-link" style="padding: 0; font-size: inherit;"-->
                                                            <!--                                                                        (click)="getCompanyCustomerDetailsTimer(); $event.stopPropagation()">-->
                                                            <!--                                                                    ולחצו על-->
                                                            <!--                                                                    רענון הנתונים-->
                                                            <!--                                                                </button>-->
                                                            <!--                                                            </ng-container>-->
                                                            <!--                                                            <ng-container-->
                                                            <!--                                                                    *ngIf="!loaderGetCompanyCustomerDetails; else loader">-->
                                                            <!--                                                                <div>לא מצאתם את הכרטיס שחיפשתם?</div>-->
                                                            <!--                                                                <div>צרו כרטיס חדש בחשבשבת.</div>-->
                                                            <!--                                                                <div>-->
                                                            <!--                                                                    בנתיים ניתן לעדכן ידנית עד שנמשוך <br>-->
                                                            <!--                                                                    את פרטי הכרטיס.-->
                                                            <!--                                                                </div>-->
                                                            <!--                                                                <button class="button-link"-->
                                                            <!--                                                                        style="padding: 0; font-size: inherit;"-->
                                                            <!--                                                                        (click)="setValCartisModal(formDropdowns, arr.controls[i].get('indexData')); formDropdowns.putStyle(); getCompanyCustomerDetailsTimer(); $event.stopPropagation()">-->
                                                            <!--                                                                    לעדכון ידני לחצו פה-->
                                                            <!--                                                                </button>-->
                                                            <!--                                                            </ng-container>-->
                                                            <!--                                                            <ng-template #loader>-->
                                                            <!--                                                                <div style="height: 84px;">-->
                                                            <!--                                                                    <div class="loaderPercent blueCircle"-->
                                                            <!--                                                                         style="background: #e6e5e5;">-->
                                                            <!--                                                                        <div class="circle"></div>-->
                                                            <!--                                                                    </div>-->
                                                            <!--                                                                </div>-->
                                                            <!--                                                                <div style="-->
                                                            <!--    z-index: 999;-->
                                                            <!--    position: absolute;-->
                                                            <!--    bottom: 26px;-->
                                                            <!--    font-size: 14.5px;-->
                                                            <!--    text-align: center;-->
                                                            <!--    font-weight: 600;-->
                                                            <!--    left: 0;-->
                                                            <!--    right: 0;-->
                                                            <!--">-->
                                                            <!--                                                                    מתבצע סינכרון-->
                                                            <!--                                                                </div>-->
                                                            <!--                                                            </ng-template>-->

                                                            <ng-container>
                                                                <!--                                                                <div>לא מצאת את הכרטיס?</div>-->
                                                                <!--                                                                <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                                <!--                                                                <div>-->
                                                                <!--                                                                    ובנתיים-->
                                                                <!--                                                                    <button class="button-link"-->
                                                                <!--                                                                            style="padding: 0; font-size: inherit; text-decoration: underline"-->
                                                                <!--                                                                            (click)="setValCartisModal(formDropdowns, arr.controls[i].get('indexData'));  getCompanyCustomerDetailsTimer();">-->
                                                                <!--                                                                        לחצו לעדכון-->
                                                                <!--                                                                    </button>-->
                                                                <!--                                                                </div>-->

                                                                <div>לא מצאתם את הכרטיס שחיפשתם?</div>
                                                                <div>צרו כרטיס חדש בחשבשבת.</div>
                                                                <div>
                                                                    בינתיים ניתן לעדכן ידנית את
                                                                    <strong style="font-weight: 700">
                                                                        מפתח הכרטיס במדויק
                                                                    </strong>
                                                                    <br/>
                                                                    עד שנמשוך את פרטי הכרטיס.
                                                                </div>
                                                                <button
                                                                        (click)="
                                    setValCartisModal(
                                      formDropdowns,
                                      arr.controls[i].get('indexData')
                                    );
                                    getCompanyCustomerDetailsTimer()
                                  "
                                                                        class="button-link"
                                                                        style="
                                    padding: 0;
                                    font-size: inherit;
                                    text-decoration: underline;
                                  "
                                                                >
                                                                    לעדכון ידני לחצו פה
                                                                </button>
                                                            </ng-container>
                                                        </div>
                                                    </ng-template>


                                                </app-dropdown-wrap>
                                            </ng-container>
                                        </div>

                                        <div
                                                *ngIf="!isMatah"
                                                style="align-self: stretch; width: 11px; height: auto"
                                        ></div>
                                        <div
                                                *ngIf="!isMatah"
                                                [class.disabled]="
                        arr.controls[i].get('totalIncludedMaam').disabled
                      "
                                                [class.invalid]="
                        arr.controls[i].get('totalIncludedMaam').enabled &&
                        ((arr.controls[0].get('orderType').value === 'OPEN' &&
                          isShowAlert(i)) ||
                          arr.controls[i].get('totalIncludedMaam').invalid ||
                          getNum(
                            arr.controls[i].get('totalIncludedMaam').value
                          ) === 0)
                      "
                                                class="input setPaddingAndBorder"
                                                style="width: 85px; display: flex"
                                        >
                                            <input
                                                    (keyup)="
                          calcByTypeChange(true, i, true, 'totalIncludedMaam')
                        "
                                                    appNumbersOnly="positive"
                                                    autocomplete="off"
                                                    formControlName="totalIncludedMaam"
                                            />

                                            <app-sum-view
                                                    *ngIf="arr.controls[i].get('totalIncludedMaam').value"
                                                    [sum]="arr.controls[i].get('totalIncludedMaam').value"
                                                    class="text-item text-ellipsis"
                                                    style="padding-left: 0"
                                            ></app-sum-view>
                                            <p
                                                    *ngIf="
                          showNegative &&
                          arr.controls[i].get('totalIncludedMaam').value
                        "
                                            >
                                                -
                                            </p>
                                            <p
                                                    *ngIf="!arr.controls[i].get('totalIncludedMaam').value"
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>
                                        </div>
                                    </div>

                                    <div
                                            *ngIf="
                      arr.controls[i].get('indexData').value &&
                      arr.controls[i].get('custData').value &&
                      arr.controls[i].get('indexData').value.custId ===
                        arr.controls[i].get('custData').value.custId
                    "
                                            class="flex"
                                            style="
                      font-size: 13px;
                      justify-content: space-between;
                      color: #cd1010;
                    "
                                    >
                                        לא ניתן לבחור שני כרטיסים זהים
                                    </div>
                                    <div
                                            *ngIf="
                      arr.controls[0].get('orderType').value === 'OPEN' &&
                      isShowAlert17(i)
                    "
                                            class="flex"
                                            style="
                      font-size: 13px;
                      justify-content: space-between;
                      color: #cd1010;
                    "
                                    >
                                        סכום לפני מע"מ + סכום
                                        <br *ngIf="isMatah"/>
                                        מע"מ ≠ סכום כולל מע"מ בפקודה
                                    </div>
                                </div>
                            </ng-template>

                            <ng-template #expenseTempSums>
                                <div>
                                    <div>
                                        <div
                                                [class.disabled]="
                        arr.controls[i].get('totalWithoutMaam').disabled
                      "
                                                [class.invalid]="
                        arr.controls[i].get('totalWithoutMaam').enabled &&
                        ((arr.controls[0].get('orderType').value === 'OPEN' &&
                          isShowAlert(i)) ||
                          arr.controls[i].get('totalWithoutMaam').invalid ||
                          getNum(
                            arr.controls[i].get('totalWithoutMaam').value
                          ) === 0)
                      "
                                                class="input"
                                                style="width: 85px; display: flex"
                                        >
                                            <input
                                                    (keyup)="
                          calcByTypeChange(false, i, true, 'totalWithoutMaam')
                        "
                                                    appNumbersOnly="numWithTwoDec"
                                                    autocomplete="off"
                                                    formControlName="totalWithoutMaam"
                                            />

                                            <app-sum-view
                                                    *ngIf="arr.controls[i].get('totalWithoutMaam').value"
                                                    [sum]="arr.controls[i].get('totalWithoutMaam').value"
                                                    class="text-item text-ellipsis"
                                                    style="padding-left: 0"
                                            ></app-sum-view>
                                            <p
                                                    *ngIf="
                          showNegative &&
                          arr.controls[i].get('totalWithoutMaam').value
                        "
                                            >
                                                -
                                            </p>
                                            <p
                                                    *ngIf="!arr.controls[i].get('totalWithoutMaam').value"
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>
                                        </div>
                                    </div>
                                    <div
                                            *ngIf="arr.controls[i].get('orderType').value !== 'NONE'"
                                    >
                                        <div
                                                [class.disabled]="
                        arr.controls[i].get('totalMaam').disabled
                      "
                                                [class.invalid]="
                        arr.controls[i].get('totalMaam').enabled &&
                        (isShowAlert16(i) ||
                          arr.controls[i].get('totalIncludedMaam').invalid ||
                          getNum(
                            arr.controls[i].get('totalIncludedMaam').value
                          ) === 0 ||
                          (arr.controls[0].get('orderType').value !== 'OPEN' &&
                            (arr.controls[i].get('totalMaam').invalid ||
                              getNum(arr.controls[i].get('totalMaam').value) ===
                                0)))
                      "
                                                class="input"
                                                style="width: 85px; display: flex"
                                        >
                                            <input
                                                    (keyup)="calcByTypeChange(false, i, true, 'totalMaam')"
                                                    appNumbersOnly="positive"
                                                    autocomplete="off"
                                                    formControlName="totalMaam"
                                            />

                                            <app-sum-view
                                                    *ngIf="arr.controls[i].get('totalMaam').value"
                                                    [sum]="arr.controls[i].get('totalMaam').value"
                                                    class="text-item text-ellipsis"
                                                    style="padding-left: 0"
                                            ></app-sum-view>
                                            <p
                                                    *ngIf="
                          showNegative && arr.controls[i].get('totalMaam').value
                        "
                                            >
                                                -
                                            </p>
                                            <p
                                                    *ngIf="!arr.controls[i].get('totalMaam').value"
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </ng-template>
                            <ng-template #incomeTempSums>
                                <div>
                                    <div>
                                        <div
                                                [class.disabled]="
                        arr.controls[i].get('totalIncludedMaam').disabled
                      "
                                                [class.invalid]="
                        arr.controls[i].get('totalIncludedMaam').enabled &&
                        ((arr.controls[0].get('orderType').value === 'OPEN' &&
                          isShowAlert(i)) ||
                          arr.controls[i].get('totalIncludedMaam').invalid ||
                          getNum(
                            arr.controls[i].get('totalIncludedMaam').value
                          ) === 0)
                      "
                                                class="input"
                                                style="width: 85px; display: flex"
                                        >
                                            <input
                                                    (keyup)="
                          calcByTypeChange(true, i, true, 'totalIncludedMaam')
                        "
                                                    appNumbersOnly="positive"
                                                    autocomplete="off"
                                                    formControlName="totalIncludedMaam"
                                            />

                                            <app-sum-view
                                                    *ngIf="arr.controls[i].get('totalIncludedMaam').value"
                                                    [sum]="arr.controls[i].get('totalIncludedMaam').value"
                                                    class="text-item text-ellipsis"
                                                    style="padding-left: 0"
                                            ></app-sum-view>
                                            <p
                                                    *ngIf="
                          showNegative &&
                          arr.controls[i].get('totalIncludedMaam').value
                        "
                                            >
                                                -
                                            </p>
                                            <p
                                                    *ngIf="!arr.controls[i].get('totalIncludedMaam').value"
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </ng-template>

                            <ng-template #expenseMatahTemp>
                                <div style="position: relative; align-self: stretch;">
                                    <div>
                                        <div
                                                class="input disabled"
                                                style="width: 85px; display: flex"
                                        >
                                            <app-sum-view
                                                    *ngIf="
                          arr.controls[i].get('totalBeforeMaamMatah').value
                        "
                                                    [sum]="
                          arr.controls[i].get('totalBeforeMaamMatah').value
                        "
                                                    class="text-item text-ellipsis"
                                                    style="padding-left: 0"
                                            ></app-sum-view>
                                            <p
                                                    *ngIf="
                          showNegative &&
                          arr.controls[i].get('totalBeforeMaamMatah').value
                        "
                                            >
                                                -
                                            </p>
                                            <p
                                                    *ngIf="
                          !arr.controls[i].get('totalBeforeMaamMatah').value
                        "
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>
                                        </div>
                                    </div>
                                    <div
                                            *ngIf="arr.controls[i].get('orderType').value !== 'NONE'"
                                    >
                                        <div
                                                class="input disabled"
                                                style="width: 85px; display: flex"
                                        >
                                            <app-sum-view
                                                    *ngIf="arr.controls[i].get('totalMaamMatah').value"
                                                    [sum]="arr.controls[i].get('totalMaamMatah').value"
                                                    class="text-item text-ellipsis"
                                                    style="padding-left: 0"
                                            ></app-sum-view>
                                            <p
                                                    *ngIf="
                          showNegative &&
                          arr.controls[i].get('totalMaamMatah').value
                        "
                                            >
                                                -
                                            </p>
                                            <p
                                                    *ngIf="!arr.controls[i].get('totalMaamMatah').value"
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>
                                        </div>
                                    </div>

                                    <i *ngIf="!(    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'חשבונית זיכוי') ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value !==
                      1 &&
                      !showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'חשבונית זיכוי') ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value !==
                        'חשבונית זיכוי') ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      !showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value !==
                        'חשבונית זיכוי'))"
                                            [matTooltip]="'לפי שער יציג של ' + rate + ' ₪'"
                                            class="fas fa-globe"
                                            matTooltipPosition="below"
                                            style="
                      position: absolute;
                      bottom: 0px;
                      left: 0px;
                      cursor: pointer;
                    "
                                    ></i>
                                </div>
                            </ng-template>
                            <ng-template #incomeMatahTemp>
                                <div style="position: relative; align-self: stretch">
                                    <div
                                            *ngIf="fileDetailsSave.splitType === 'FOREIGN_OPEN'"
                                            [class.disabled]="
                      arr.controls[i].get('matahAmount').disabled
                    "
                                            [class.invalid]="
                      arr.controls[i].get('matahAmount').enabled &&
                      (arr.controls[i].get('matahAmount').invalid ||
                        getNum(arr.controls[i].get('matahAmount').value) === 0)
                    "
                                            class="input"
                                            style="width: 85px; display: flex"
                                    >
                                        <input
                                                (keyup)="calcByTypeChange(true, i, true, 'matahAmount')"
                                                appNumbersOnly="positive"
                                                autocomplete="off"
                                                formControlName="matahAmount"
                                        />

                                        <app-sum-view
                                                *ngIf="arr.controls[i].get('matahAmount').value"
                                                [sum]="arr.controls[i].get('matahAmount').value"
                                                class="text-item text-ellipsis"
                                                style="padding-left: 0"
                                        ></app-sum-view>
                                        <p
                                                *ngIf="
                        showNegative && arr.controls[i].get('matahAmount').value
                      "
                                        >
                                            -
                                        </p>
                                        <p
                                                *ngIf="!arr.controls[i].get('matahAmount').value"
                                                class="text-item text-ellipsis"
                                        >
                                            0
                                        </p>
                                    </div>

                                    <div
                                            *ngIf="fileDetailsSave.splitType !== 'FOREIGN_OPEN'"
                                            class="input disabled"
                                            style="width: 85px; display: flex"
                                    >
                                        <app-sum-view
                                                *ngIf="arr.controls[i].get('matahAmount').value"
                                                [sum]="arr.controls[i].get('matahAmount').value"
                                                class="text-item text-ellipsis"
                                                style="padding-left: 0"
                                        ></app-sum-view>
                                        <p
                                                *ngIf="
                        showNegative && arr.controls[i].get('matahAmount').value
                      "
                                        >
                                            -
                                        </p>
                                        <p
                                                *ngIf="!arr.controls[i].get('matahAmount').value"
                                                class="text-item text-ellipsis"
                                        >
                                            0
                                        </p>
                                    </div>
                                    <i
                                            *ngIf="(    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'חשבונית זיכוי') ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value !==
                      1 &&
                      !showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'חשבונית זיכוי') ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value !==
                        'חשבונית זיכוי') ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      !showNegative &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value !==
                        'חשבונית זיכוי'))"
                                            [matTooltip]="'לפי שער יציג של ' + rate + ' ₪'"
                                            class="fas fa-globe"
                                            matTooltipPosition="below"
                                            style="
                      position: absolute;
                      bottom: 0px;
                      left: 0px;
                      cursor: pointer;
                    "
                                    ></i>
                                </div>
                            </ng-template>

                            <ng-template #expenseRevaluationCurrCodeTemp>
                                <div>
                                    <div>
                                        <div
                                                class="input disabled"
                                                style="width: 85px; display: flex"
                                        >
                                            <app-sum-view
                                                    *ngIf="arr.controls[i].get('totalWithoutMaam').value"
                                                    [sum]="
                          arr.controls[i].get('totalWithoutMaam').value / rate
                        "
                                                    class="text-item text-ellipsis"
                                                    style="padding-left: 0"
                                            ></app-sum-view>
                                            <p
                                                    *ngIf="
                          showNegative &&
                          arr.controls[i].get('totalWithoutMaam').value
                        "
                                            >
                                                -
                                            </p>
                                            <p
                                                    *ngIf="!arr.controls[i].get('totalWithoutMaam').value"
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>
                                        </div>
                                        <div
                                                *ngIf="arr.controls[i].get('orderType').value !== 'NONE'"
                                                class="input disabled"
                                                style="width: 85px; display: flex"
                                        >
                                            <app-sum-view
                                                    *ngIf="arr.controls[i].get('totalMaam').value"
                                                    [sum]="arr.controls[i].get('totalMaam').value / rate"
                                                    class="text-item text-ellipsis"
                                                    style="padding-left: 0"
                                            ></app-sum-view>
                                            <p
                                                    *ngIf="
                          showNegative && arr.controls[i].get('totalMaam').value
                        "
                                            >
                                                -
                                            </p>
                                            <p
                                                    *ngIf="!arr.controls[i].get('totalMaam').value"
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </ng-template>
                            <ng-template #incomeRevaluationCurrCodeTemp>
                                <div style="position: relative; align-self: stretch">
                                    <div
                                            class="input disabled"
                                            style="width: 85px; display: flex"
                                    >
                                        <app-sum-view
                                                *ngIf="arr.controls[i].get('totalIncludedMaam').value"
                                                [sum]="
                        arr.controls[i].get('totalIncludedMaam').value / rate
                      "
                                                class="text-item text-ellipsis"
                                                style="padding-left: 0"
                                        ></app-sum-view>
                                        <p
                                                *ngIf="
                        showNegative &&
                        arr.controls[i].get('totalIncludedMaam').value
                      "
                                        >
                                            -
                                        </p>
                                        <p
                                                *ngIf="!arr.controls[i].get('totalIncludedMaam').value"
                                                class="text-item text-ellipsis"
                                        >
                                            0
                                        </p>
                                    </div>
                                    <i
                                            [matTooltip]="'לפי שער יציג של ' + rate + ' ₪'"
                                            class="fas fa-globe"
                                            matTooltipPosition="below"
                                            style="
                      position: absolute;
                      bottom: 0px;
                      left: 0px;
                      cursor: pointer;
                    "
                                    ></i>
                                </div>
                            </ng-template>
                        </div>
                    </div>
                </div>

                <ng-container *ngIf="getJournalHistory; else loader">
                    <div
                            *ngFor="
              let item of getJournalHistory;
              let i = index;
              first as isFirst
            "
                            [class.first]="isFirst"
                            class="row"
                    >
                        <div class="dateFl">
                            <div
                                    *ngIf="isFirst"
                                    style="font-size: 16px; font-weight: 700; margin-bottom: 5px"
                            >
                                היסטוריה
                            </div>
                            <div class="date flex" style="margin-bottom: 10px">
                                <p>תאריך:</p>

                                <div style="width: 85px">
                                    {{ item.referenceDate | date: 'dd/MM/yyyy' }}
                                </div>
                            </div>
                        </div>
                        <div class="border"></div>
                        <div>
                            <ng-container *ngIf="fileFieldsForm.get('40')">
                                <div *ngIf="item.transTypeCode; else empty">
                                    {{ item.transTypeCode }}
                                </div>
                            </ng-container>

                            <ng-container *ngIf="!fileFieldsForm.get('40')">
                                <div *ngIf="item.maamPrc; else empty">
                                    <!--                                    [options]="((fileFieldsForm.get('21')?.get('effectiveValue').value === 1 && showNegative && fileFieldsForm.get('9')?.get('effectiveValue').value !== 'חשבונית זיכוי')-->
                                    <!--                                    ||-->
                                    <!--                                    (fileFieldsForm.get('21')?.get('effectiveValue').value !== 1 && !showNegative && fileFieldsForm.get('9')?.get('effectiveValue').value === 'חשבונית זיכוי')) ? vatOptions : vatOptionsIncome"-->
                                    <p-dropdown
                                        #formDropdowns
                                        [(ngModel)]="item.maamPrc"
                                        [autoDisplayFirst]="false"
                                        [disabled]="true"
                                        [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                        [options]="!item.expense ? vatOptionsIncome : vatOptionsAll"
                                        [style]="{ width: '100%' }"
                                        appendTo="body"
                                        placeholder="בחירה"
                                    ></p-dropdown>
                                </div>
                            </ng-container>
                        </div>
                        <div class="border"></div>
                        <ng-container
                                *ngTemplateOutlet="item.expense ? expenseTemp : incomeTemp"
                        >
                        </ng-container>
                        <div class="border"></div>
                        <ng-container
                                *ngTemplateOutlet="item.expense ? incomeTemp : expenseTemp"
                        >
                        </ng-container>

                        <ng-container *ngIf="isMatah">
                            <div class="border"></div>
                            <ng-container
                                    *ngTemplateOutlet="
                  item.expense ? expenseTempSums : incomeTempSums
                "
                            >
                            </ng-container>
                            <ng-container
                                    *ngTemplateOutlet="
                  item.expense ? incomeTempSums : expenseTempSums
                "
                            >
                            </ng-container>
                        </ng-container>

                        <ng-container *ngIf="isMatah">
                            <div class="border"></div>
                            <ng-container
                                    *ngTemplateOutlet="
                  item.expense ? expenseMatahTemp : incomeMatahTemp
                "
                            >
                            </ng-container>
                            <ng-container
                                    *ngTemplateOutlet="
                  item.expense ? incomeMatahTemp : expenseMatahTemp
                "
                            >
                            </ng-container>
                        </ng-container>

                        <ng-container *ngIf="revaluationCurrCode">
                            <div class="border"></div>
                            <ng-container
                                    *ngTemplateOutlet="
                  item.expense
                    ? expenseRevaluationCurrCodeTemp
                    : incomeRevaluationCurrCodeTemp
                "
                            >
                            </ng-container>
                            <ng-container
                                    *ngTemplateOutlet="
                  item.expense
                    ? incomeRevaluationCurrCodeTemp
                    : expenseRevaluationCurrCodeTemp
                "
                            >
                            </ng-container>
                        </ng-container>

                        <!--                            totalMaamMatah-->
                        <!--                            totalBeforeMaamMatah-->
                        <div class="border"></div>
                        <div style="position: relative">
                            <div class="flex" style="margin-bottom: 10px">
                                <p style="width: 64px">אסמכתא</p>
                                <div style="width: 65px; margin-left: 20px">
                                    <input
                                            [(ngModel)]="item.asmachta1"
                                            appNumbersOnly="positive"
                                            autocomplete="off"
                                            class="input-show"
                                            disabled
                                            readonly
                                    />
                                </div>
                                <p style="width: 40px">מנה</p>
                                <div style="width: 65px">
                                    <input
                                            [(ngModel)]="item.batchNum"
                                            autocomplete="off"
                                            class="input-show"
                                            disabled
                                            readonly
                                    />
                                </div>
                            </div>
                            <div class="flex" style="margin-bottom: 10px">
                                <p style="width: 64px">אסמכ. 2</p>
                                <div style="width: 65px; margin-left: 20px">
                                    <input
                                            [(ngModel)]="item.asmachta2"
                                            appNumbersOnly="positive"
                                            autocomplete="off"
                                            class="input-show"
                                            disabled
                                            readonly
                                    />
                                </div>
                                <p style="width: 40px">פקודה</p>
                                <div style="width: 65px">
                                    <input
                                            [(ngModel)]="item.misparTnua"
                                            autocomplete="off"
                                            class="input-show"
                                            disabled
                                            readonly
                                    />
                                </div>
                            </div>
                            <div class="flex">
                                <p style="width: 64px">פרטים</p>
                                <div style="max-width: 200px">
                                    <input
                                        #inputElement
                                        [(ngModel)]="item.details"
                                        [pTooltip]="item.details"
                                        [tooltipDisabled]="
                      inputElement.offsetWidth >= inputElement.scrollWidth
                    "
                                        autocomplete="off"
                                        class="input-show text-ellipsis"
                                        disabled
                                        readonly
                                        tooltipPosition="top"
                                    />
                                </div>
                            </div>
                        </div>
                        <ng-template #expenseTemp>
                            <div>
                                <div
                                        class="flex"
                                        style="
                    margin-bottom: 10px;
                    justify-content: space-between;
                    width: max-content;
                  "
                                >
                                    <div style="width: 185px; min-width: 185px">
                                        <div *ngIf="item.custData; else empty" class="p-dropdown">
                                            <label class="p-dropdown-label">
                        <span
                            #spanElement
                            [pTooltip]="item.custData.cartisName"
                            [tooltipDisabled]="
                            spanElement.offsetWidth >= spanElement.scrollWidth
                          "
                            style="
                            vertical-align: middle;
                            display: block;
                            white-space: nowrap;
                            overflow: hidden;
                            text-overflow: ellipsis;
                          "
                            tooltipPosition="top"
                        >{{ item.custData.cartisName }}</span
                        >
                                            </label>
                                        </div>
                                    </div>

                                    <div
                                            style="align-self: stretch; width: 11px; height: auto"
                                    ></div>
                                    <div
                                            *ngIf="!isMatah"
                                            class="input disabled"
                                            style="width: 85px"
                                    >
                                        <app-sum-view
                                                *ngIf="item.totalBeforeMaam"
                                                [sum]="item.totalBeforeMaam"
                                                class="text-item text-ellipsis"
                                        ></app-sum-view>

                                        <p
                                                *ngIf="!item.totalBeforeMaam"
                                                class="text-item text-ellipsis"
                                        >
                                            0
                                        </p>
                                    </div>
                                    <!--                                        <div style="width: 85px;" class="input disabled" *ngIf="isMatah">-->
                                    <!--                                            <app-sum-view *ngIf="item.matahAmount"-->
                                    <!--                                                          class="text-item text-ellipsis"-->
                                    <!--                                                          [sum]="item.matahAmount"></app-sum-view>-->

                                    <!--                                            <p *ngIf="!item.matahAmount"-->
                                    <!--                                               class="text-item text-ellipsis">-->
                                    <!--                                                0-->
                                    <!--                                            </p>-->
                                    <!--                                        </div>-->
                                </div>
                                <div
                                        *ngIf="item.maamPrc !== 'NONE' && item.cartisMaam !== null"
                                        class="flex"
                                        style="justify-content: space-between; width: max-content"
                                >
                                    <div
                                            [ngStyle]="{
                      width: isMatah ? '170px' : '185px',
                      'min-width': isMatah ? '170px' : '185px'
                    }"
                                    >
                                        <!--                                        *ngIf="(fileFieldsForm.get('21')?.get('effectiveValue').value === 1); else incomeCartisMaam"-->
                                        <!--                                        <ng-container [ngSwitch]="item.maamPrc">-->
                                        <!--                                            <ng-container *ngSwitchCase="'OPEN'">-->
                                        <!--                                                <div class="p-dropdown" *ngIf="item.cartisMaam;else empty">-->
                                        <!--                                                    <label class="p-dropdown-label">-->
                                        <!--                                                <span style="vertical-align:middle;display: block;white-space: nowrap;overflow: hidden;text-overflow: ellipsis;"-->
                                        <!--                                                      #spanElement-->
                                        <!--                                                      [tooltipDisabled]="spanElement.offsetWidth >= spanElement.scrollWidth"-->
                                        <!--                                                      [pTooltip]="item.cartisMaam.cartisName"-->
                                        <!--                                                      tooltipPosition="top">{{item.cartisMaam.cartisName}}</span>-->
                                        <!--                                                    </label>-->
                                        <!--                                                </div>-->
                                        <!--                                            </ng-container>-->
                                        <!--                                            <ng-container *ngSwitchCase="'FULL_PROPERTY'">-->
                                        <!--                                                <p>-->
                                        <!--                                                    {{userService.appData.userData.companyCustomerDetails?.custMaamNechasim ? (userService.appData.userData.companyCustomerDetails?.custMaamNechasim?.cartisName) :-->
                                        <!--                                                    (userService.appData.userData.companyCustomerDetails?.custMaamTsumot ? (userService.appData.userData.companyCustomerDetails?.custMaamTsumot?.cartisName) : '')}}-->
                                        <!--                                                </p>-->
                                        <!--                                            </ng-container>-->

                                        <!--                                            <ng-container *ngSwitchCase="'FULL_IMPORT'">-->
                                        <!--                                                <p>-->
                                        <!--                                                    {{(userService.appData.userData.companyCustomerDetails?.custMaamYevu ? (userService.appData.userData.companyCustomerDetails?.custMaamYevu?.cartisName) : '')}}-->
                                        <!--                                                </p>-->
                                        <!--                                            </ng-container>-->

                                        <!--                                            <ng-container *ngSwitchDefault>-->
                                        <!--                                                <p>-->
                                        <!--                                                    {{(userService.appData.userData.companyCustomerDetails?.custMaamTsumot ? (userService.appData.userData.companyCustomerDetails?.custMaamTsumot?.cartisName) : '')}}-->
                                        <!--                                                </p>-->
                                        <!--                                            </ng-container>-->
                                        <!--                                        </ng-container>-->

                                        <div
                                                *ngIf="item.cartisMaam; else empty"
                                                class="p-dropdown"
                                        >
                                            <label class="p-dropdown-label">
                        <span
                            #spanElement
                            [pTooltip]="item.cartisMaam.cartisName"
                            [tooltipDisabled]="
                            spanElement.offsetWidth >= spanElement.scrollWidth
                          "
                            style="
                            vertical-align: middle;
                            display: block;
                            white-space: nowrap;
                            overflow: hidden;
                            text-overflow: ellipsis;
                          "
                            tooltipPosition="top"
                        >{{ item.cartisMaam.cartisName }}</span
                        >
                                            </label>
                                        </div>
                                    </div>
                                    <!--                                    <ng-template #incomeCartisMaam>-->
                                    <!--                                        <div [ngStyle]="{'width': (isMatah ? '170px': '195px'), 'min-width': (isMatah ? '170px': '195px')}">-->
                                    <!--                                            <p>-->
                                    <!--                                                {{(userService.appData.userData.companyCustomerDetails?.custMaamIska ? (userService.appData.userData.companyCustomerDetails?.custMaamIska?.cartisName) : '')}}-->
                                    <!--                                            </p>-->
                                    <!--                                        </div>-->
                                    <!--                                    </ng-template>-->

                                    <div
                                            *ngIf="!isMatah"
                                            style="align-self: stretch; width: 11px; height: auto"
                                    ></div>
                                    <div
                                            *ngIf="!isMatah"
                                            class="input disabled"
                                            style="width: 85px"
                                    >
                                        <app-sum-view
                                                *ngIf="item.totalMaam"
                                                [sum]="item.totalMaam"
                                                class="text-item text-ellipsis"
                                        ></app-sum-view>

                                        <p *ngIf="!item.totalMaam" class="text-item text-ellipsis">
                                            0
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                        <ng-template #incomeTemp>
                            <div>
                                <div
                                        class="flex"
                                        style="
                    margin-bottom: 10px;
                    justify-content: space-between;
                    width: max-content;
                  "
                                >
                                    <div
                                            [ngStyle]="{
                      width: isMatah ? '170px' : '185px',
                      'min-width': isMatah ? '170px' : '185px'
                    }"
                                    >
                                        <div *ngIf="item.custId; else empty" class="p-dropdown">
                                            <label class="p-dropdown-label">
                        <span
                            #spanElement
                            [pTooltip]="item.custId.cartisName"
                            [tooltipDisabled]="
                            spanElement.offsetWidth >= spanElement.scrollWidth
                          "
                            style="
                            vertical-align: middle;
                            display: block;
                            white-space: nowrap;
                            overflow: hidden;
                            text-overflow: ellipsis;
                          "
                            tooltipPosition="top"
                        >{{ item.custId.cartisName }}</span
                        >
                                            </label>
                                        </div>
                                    </div>

                                    <div
                                            *ngIf="!isMatah"
                                            style="align-self: stretch; width: 11px; height: auto"
                                    ></div>
                                    <div
                                            *ngIf="!isMatah"
                                            class="input disabled"
                                            style="width: 85px"
                                    >
                                        <app-sum-view
                                                *ngIf="item.totalIncludeMaam"
                                                [sum]="item.totalIncludeMaam"
                                                class="text-item text-ellipsis"
                                        ></app-sum-view>

                                        <p
                                                *ngIf="!item.totalIncludeMaam"
                                                class="text-item text-ellipsis"
                                        >
                                            0
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </ng-template>

                        <ng-template #expenseTempSums>
                            <div>
                                <div>
                                    <div class="input disabled" style="width: 85px">
                                        <app-sum-view
                                                *ngIf="item.totalBeforeMaam"
                                                [sum]="item.totalBeforeMaam"
                                                class="text-item text-ellipsis"
                                        ></app-sum-view>

                                        <p
                                                *ngIf="!item.totalBeforeMaam"
                                                class="text-item text-ellipsis"
                                        >
                                            0
                                        </p>
                                    </div>
                                </div>
                                <div *ngIf="item.maamPrc !== 'NONE'">
                                    <div class="input disabled" style="width: 85px">
                                        <app-sum-view
                                                *ngIf="item.totalMaam"
                                                [sum]="item.totalMaam"
                                                class="text-item text-ellipsis"
                                        ></app-sum-view>

                                        <p *ngIf="!item.totalMaam" class="text-item text-ellipsis">
                                            0
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                        <ng-template #incomeTempSums>
                            <div>
                                <div>
                                    <div class="input disabled" style="width: 85px">
                                        <app-sum-view
                                                *ngIf="item.totalIncludeMaam"
                                                [sum]="item.totalIncludeMaam"
                                                class="text-item text-ellipsis"
                                        ></app-sum-view>

                                        <p
                                                *ngIf="!item.totalIncludeMaam"
                                                class="text-item text-ellipsis"
                                        >
                                            0
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </ng-template>

                        <ng-template #expenseMatahTemp>
                            <div>
                                <div>
                                    <div class="input disabled" style="width: 85px">
                                        <app-sum-view
                                                *ngIf="item.totalBeforeMaamMatah"
                                                [sum]="item.totalBeforeMaamMatah"
                                                class="text-item text-ellipsis"
                                        ></app-sum-view>

                                        <p
                                                *ngIf="!item.totalBeforeMaamMatah"
                                                class="text-item text-ellipsis"
                                        >
                                            0
                                        </p>
                                    </div>
                                </div>
                                <div *ngIf="item.maamPrc !== 'NONE'">
                                    <div class="input disabled" style="width: 85px">
                                        <app-sum-view
                                                *ngIf="item.totalMaamMatah"
                                                [sum]="item.totalMaamMatah"
                                                class="text-item text-ellipsis"
                                        ></app-sum-view>

                                        <p
                                                *ngIf="!item.totalMaamMatah"
                                                class="text-item text-ellipsis"
                                        >
                                            0
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                        <ng-template #incomeMatahTemp>
                            <div style="position: relative; align-self: stretch">
                                <div class="input disabled" style="width: 85px">
                                    <app-sum-view
                                            *ngIf="item.matahAmount"
                                            [sum]="item.matahAmount"
                                            class="text-item text-ellipsis"
                                    ></app-sum-view>

                                    <p *ngIf="!item.matahAmount" class="text-item text-ellipsis">
                                        0
                                    </p>
                                </div>
                            </div>
                        </ng-template>

                        <ng-template #expenseRevaluationCurrCodeTemp>
                            <div>
                                <div>
                                    <div class="input disabled" style="width: 85px">
                                        <app-sum-view
                                                *ngIf="item.totalBeforeMaam"
                                                [sum]="item.totalBeforeMaam / rate"
                                                class="text-item text-ellipsis"
                                        ></app-sum-view>

                                        <p
                                                *ngIf="!item.totalBeforeMaam"
                                                class="text-item text-ellipsis"
                                        >
                                            0
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                        <ng-template #incomeRevaluationCurrCodeTemp>
                            <div style="position: relative; align-self: stretch">
                                <div class="input disabled" style="width: 85px">
                                    <app-sum-view
                                            *ngIf="item.totalIncludeMaam"
                                            [sum]="item.totalIncludeMaam / rate"
                                            class="text-item text-ellipsis"
                                    ></app-sum-view>

                                    <p
                                            *ngIf="!item.totalIncludeMaam"
                                            class="text-item text-ellipsis"
                                    >
                                        0
                                    </p>
                                </div>
                                <i
                                        [matTooltip]="'לפי שער יציג של ' + rate + ' ₪'"
                                        class="fas fa-globe"
                                        matTooltipPosition="below"
                                        style="
                    position: absolute;
                    bottom: 0px;
                    left: 0px;
                    cursor: pointer;
                  "
                                ></i>
                            </div>
                        </ng-template>

                        <ng-template #empty>
                            <div>&nbsp;</div>
                        </ng-template>
                    </div>
                </ng-container>
            </div>
        </div>

        <div *ngIf="showDocumentListStorageDataFired"
                [style.height.px]="scrHeight - editOrderModal.container.clientHeight - 10"
                [style.top.px]="editOrderModal.container.clientHeight"
                class="showDocumentListStorageDataFired">
            <div class="zoom-controls-inside">
                <button (click)="imageScaleNewInvoice = 1" mat-icon-button>
                    <mat-icon class="rotate-90">height</mat-icon>
                </button>
                <button
                        (click)="rotateInside(); $event.stopPropagation()"
                        mat-icon-button
                >
                    <mat-icon
                            style="width: 17px; height: 17px"
                            svgIcon="rotate"
                    ></mat-icon>
                </button>
                <button
                        (click)="zoomStepInside(1, 'imageScaleNewInvoice')"
                        mat-icon-button
                >
                    <mat-icon>add</mat-icon>
                </button>
                <button
                        (click)="zoomStepInside(-1, 'imageScaleNewInvoice')"
                        mat-icon-button
                >
                    <mat-icon>remove</mat-icon>
                </button>
            </div>
            <div
                    [style.height.px]="scrHeight - editOrderModal.container.clientHeight - 10"
                    class="scrollbar-dynamic scroll-chrome"
                    style="overflow: auto; background: #ffffff"
            >
                <ng-container
                        *ngIf="{ pages: (fileDetails$ | async)?.pages } as pagesNavData"
                >
                    <ng-container
                            *ngFor="let page of pagesNavData.pages; index as i; last as isLast"
                    >
                        <ng-container
                                *ngIf="(cachedContent$ | async)[i] | async as imgBlob"
                        >
                            <div>
                                <img
                                        [ngStyle]="{ transform: 'rotate(' + degRotateImg + 'deg)' }"
                                        [src]="imgBlob"
                                        [style.zoom.%]="imageScaleNewInvoice * 100"
                                        alt="pageImage"

                                        style="height: auto; width: 676px;
					  display: block; margin: 0 auto"
                                />
                            </div>
                        </ng-container>
                    </ng-container>
                </ng-container>
            </div>
        </div>

        <!--        <div *ngIf="showDocumentListStorageDataFired">-->
        <!--            <div class="showDocumentListStorageDataFired scrollbar-dynamic scroll-chrome"-->
        <!--                 style="overflow-y:auto; overflow-x: auto;"-->
        <!--                 [ngStyle]="{-->
        <!--                 top: (editOrderModal.container.clientHeight) - 46 + 'px',-->
        <!--                 height: ((scrHeight - (editOrderModal.container.clientHeight)) - 10) + 'px'}">-->
        <!--                <div class="zoom-controls-inside">-->
        <!--                    <button mat-icon-button-->
        <!--                            [ngStyle]="{'opacity': imageScaleNewInvoice >= 1.5 ? 0.4 : 1}"-->
        <!--                            (click)="zoomStepInside(1, 'imageScaleNewInvoice')">-->
        <!--                        <mat-icon>add</mat-icon>-->
        <!--                    </button>-->
        <!--                    <button mat-icon-button-->
        <!--                            [ngStyle]="{'opacity': imageScaleNewInvoice <= 0.25 ? 0.4 : 1}"-->
        <!--                            (click)="zoomStepInside(-1, 'imageScaleNewInvoice')">-->
        <!--                        <mat-icon>remove</mat-icon>-->
        <!--                    </button>-->
        <!--                </div>-->
        <!--                <ng-container *ngIf="{ pages: (fileDetails$| async)?.pages } as pagesNavData">-->
        <!--                    <ng-container *ngFor="let page of pagesNavData.pages; index as i; last as isLast">-->
        <!--                        <ng-container *ngIf="((cachedContent$| async)[i]| async) as imgBlob">-->
        <!--                            <div>-->
        <!--                                <img [style.zoom.%]="imageScaleNewInvoice * 100"-->
        <!--                                     style="display:block;margin: 0 auto;"-->
        <!--                                     height="auto"-->
        <!--                                     width="676"-->
        <!--                                     alt="pageImage"-->
        <!--                                     style="height: auto; width: auto; position: relative;" fill [ngSrc]="imgBlob">-->
        <!--                            </div>-->
        <!--                        </ng-container>-->
        <!--                    </ng-container>-->
        <!--                </ng-container>-->

        <!--            </div>-->
        <!--        </div>-->

        <!--        <div *ngIf="showDocumentListStorageDataFired && showDocumentListStorageDataFired !== 'showDocumentAtleft'">-->
        <!--&lt;!&ndash;            <div class="bg_showDocumentListStorageDataFired" (click)="showDocumentListStorageDataFired=false"></div>&ndash;&gt;-->
        <!--            <div class="showDocumentListStorageDataFired scrollbar-dynamic scroll-chrome"-->
        <!--                 style="overflow-y:auto; overflow-x: hidden;"-->
        <!--                 [ngStyle]="{top: showDocumentListStorageDataFired === 'showDocumentAtSecond' ?  (arr.controls.length === 2 && getJournalHistory.length ? '224px' : '307px') : ((editOrderModal.container.clientHeight - 47) + 'px'),-->
        <!--                 height: (scrHeight - ((showDocumentListStorageDataFired === 'showDocumentAtSecond') ? (arr.controls.length === 2 && getJournalHistory.length ? '224' : '307') : ((editOrderModal.container.clientHeight + 10)))) + 'px'}">-->
        <!--                    <ng-container *ngIf="{ pages: (fileDetails$| async)?.pages } as pagesNavData">-->
        <!--                        <ng-container *ngFor="let page of pagesNavData.pages; index as i; last as isLast">-->
        <!--                            <ng-container *ngIf="((cachedContent$| async)[i]| async) as imgBlob">-->
        <!--                                <div>-->
        <!--                                    <img width="100%"-->
        <!--                                         alt="pageImage"-->
        <!--                                         height="auto"-->
        <!--                                         style="height: auto; width: auto; position: relative;" fill [ngSrc]="imgBlob">-->
        <!--                                </div>-->
        <!--                            </ng-container>-->
        <!--                        </ng-container>-->
        <!--                    </ng-container>-->

        <!--            </div>-->
        <!--        </div>-->

        <p-overlayPanel
            #alertBeforeSplitOvP
            (onHide)="onAlertBeforeSplitHide()"
            [dismissable]="true"
            [style]="{ 'padding-top': '0' }"
            appendTo="body"
            styleClass="beneficiarySelectionGuideDialog alertBeforeSplitOvP"
        >
            <div class="p-dialog-header p-helper-clearfix p-corner-top">
        <span
                class="p-dialog-title ng-tns-c13-48 ng-star-inserted"
                id="p-dialog-3-label"
        >
          <div>{{ 'guides.beneficiary.title' | translate }}</div>
        </span>
                <a
                        (click)="alertBeforeSplitOvP.hide()"
                        class="p-dialog-header-icon p-dialog-header-close p-corner-all"
                        role="button"
                >
                    <span class="fa fa-fw fa-times"></span>
                </a>
            </div>
            <div class="p-dialog-content mat-typography">
                <h3 style="padding-top: 10px; margin-bottom: 10px">
                    לאחר הוספת פקודה מפוצלת, אין אפשרות לשנות את סך סכום החשבונית
                </h3>
            </div>
            <div class="p-dialog-footer">
                <p-checkbox [binary]="true"
                            [label]="'guides.beneficiary.stopDisplaying' | translate"
                            [ngModel]="alertBeforeSplit.stopIt"
                            checkboxIcon="fa fa-check"
                ></p-checkbox>
                <button (click)="alertBeforeSplitOvP.hide()" class="button-dark">
                    {{ 'guides.beneficiary.gotIt' | translate }}
                </button>
            </div>
        </p-overlayPanel>

        <p-footer>
            <button (click)="editOrderModalShow = false" class="button-link">
                {{ 'actions.cancellation' | translate }}
            </button>
            <button
                    (click)="splitJourTrans()"
                    [disabled]="isDisabledSplitJourTrans()"
                    class="button-dark"
            >
                {{ 'actions.save' | translate }}
            </button>
        </p-footer>
    </p-dialog>
</ng-container>

<ng-container *ngIf="showEditModalPreSplit">
    <p-dialog #editOrderModal
              (visibleChange)="showEditModalPreSplit = false"
              [draggable]="false"
              [modal]="true"
              [resizable]="false"
              [visible]="(
showEditModalPreSplit
        )"
              appendTo="body"
              styleClass="showEditModalPreSplit"
    >
        <p-header>{{
            showEditModalPreSplit === 1
                ? 'עריכה, פיצול פקודה וצפייה בהיסטוריה'
                : 'עריכת/ פיצול קבלה'
            }}</p-header>
        <div>
            <p class="title">
                על מנת לערוך את
                {{ showEditModalPreSplit === 1 ? 'הפקודה ' : 'הקבלה ' }}
                יש למלא את השדה הבא:
                <!--                {{-->
                <!--                (!fileFieldsForm.get('21').get('effectiveValue').value && !fileFieldsForm.get('9').get('effectiveValue').value)?-->
                <!--                    'השדות הבאים:' :-->
                <!--                    'השדה הבא:'-->
                <!--                }}-->
            </p>
            <!--            <div style="display: flex;align-items: center;" *ngIf="!fileFieldsForm.get('21').get('effectiveValue').value">-->
            <!--                <p style="width: 100px"  class="label">-->
            <!--                    הוצאה/ הכנסה-->
            <!--                </p>-->
            <!--                <p-dropdown [(ngModel)]="setIncomeOrExpenseDoc21"-->
            <!--                            [styleClass]="fileFieldsForm.get('21')?.get('effectiveValue').value === 1 ? 'ddTypeExpense': (fileFieldsForm.get('21')?.get('effectiveValue').value === 0 ? 'ddTypeIncome' : 'ddTypeChoose')"-->
            <!--                            placeholder="בחירה"-->
            <!--                            [style]="{'width': '165px'}"-->
            <!--                            [options]="invoiceTypeOptions"-->
            <!--                            [autoDisplayFirst]="false"-->
            <!--                             appendTo="body"-->
            <!--                            #formDropdowns></p-dropdown>-->
            <!--            </div>-->
            <div
                    *ngIf="!fileFieldsForm.get('9').get('effectiveValue').value"
                    style="display: flex; align-items: center"
            >
                <p class="label" style="width: 100px">סוג מסמך</p>
                <p-dropdown
                    #formDropdowns
                    [(ngModel)]="setValuesOfDocType9"
                    [autoDisplayFirst]="false"
                    [dropdownIcon]="'fa fa-fw fa-caret-down'"
                    [options]="
            fileFieldsForm.get('21')?.get('effectiveValue').value === 1
              ? docTypeOptions
              : docTypeOptionsIncome
          "
                    [style]="{ width: '165px' }"
                    appendTo="body"
                    placeholder="בחירה"
                ></p-dropdown>
            </div>
        </div>

        <p-footer>
            <button (click)="showEditModalPreSplit = false" class="button-link">
                {{ 'actions.cancellation' | translate }}
            </button>
            <!--            [disabled]="!setValuesOfDocType9 || !setIncomeOrExpenseDoc21"-->
            <button
                    (click)="nextAfterSetDocTypes()"
                    [disabled]="!setValuesOfDocType9"
                    class="button-dark"
            >
                {{ 'actions.approve' | translate }}
            </button>
        </p-footer>
    </p-dialog>
</ng-container>

<ng-container *ngIf="editReceiptModalShow">
    <p-dialog #editOrderModal
              (visibleChange)="editReceiptModalShow = false"
              [draggable]="false"
              [modal]="true"
              [resizable]="false"
              [visible]="(
editReceiptModalShow
        )"
              appendTo="body"
              styleClass="editReceiptModalDoc {{ isMatah ? 'isMatah' : '' }} {{
      showDocumentListStorageDataFired
        ? 'isShowDocumentListStorageDataFired'
        : ''
    }} {{ fileFieldsForm.get('41') ? 'isTransTypeReceiptCode' : '' }}"
    >
        <p-header>{{ 'עריכת/ פיצול קבלה' }}</p-header>

        <div class="table" style="position: relative">
            <div class="header">
                <div>תאריך</div>
                <div class="border"></div>
                <ng-container *ngIf="fileFieldsForm.get('41')">
                    <div>ס.תנועה</div>
                    <div class="border"></div>
                </ng-container>
                <div>חובה</div>
                <div class="border"></div>
                <div>זכות</div>
                <ng-container *ngIf="isMatah">
                    <div class="border"></div>
                    <div>(₪)</div>
                    <div>(₪)</div>
                </ng-container>
                <ng-container *ngIf="isMatah">
                    <div class="border"></div>
                    <div>({{ currencySign }})</div>
                    <div>({{ currencySign }})</div>
                </ng-container>
                <ng-container *ngIf="revaluationCurrCode">
                    <div class="border"></div>
                    <div>חובה ({{ currencySign | currencySymbol }})</div>
                    <div>זכות ({{ currencySign | currencySymbol }})</div>
                </ng-container>
                <div class="border"></div>
                <div>פרטים נוספים</div>
            </div>

            <div
                    [style.max-height.px]="
          showDocumentListStorageDataFired ? 252 : scrHeight - 350
        "
                    class="scroll-chrome scrollbar-dynamic"
                    style="overflow-y: auto"
            >
                <ng-template #loader>
                    <div style="height: 84px">
                        <div class="loaderPercent">
                            <div class="circle"></div>
                        </div>
                    </div>
                </ng-template>
                <div *ngIf="receipt; else loader" [formGroup]="receipt">
                    <div formArrayName="arr">
                        <div
                                *ngFor="
                let item of arrReceipt.controls;
                let i = index;
                last as isLast
              "
                                [class.last]="isLast"
                                [formGroupName]="i"
                                class="row main"
                        >
                            <div>
                                <div
                                        class="date flex"
                                        style="margin-bottom: 10px; justify-content: space-between"
                                >
                                    <p style="min-width: 74px">תאריך</p>

                                    <div style="width: 85px">
                                        <p-calendar
                                                [dateFormat]="'dd/mm/yy'"
                                                [locale]="'langCalendar' | translate"
                                                [style]="{ width: '85px' }"
                                                appendTo="body"
                                                formControlName="invoiceDate"
                                                placeholder="בחירה"
                                        ></p-calendar>
                                    </div>
                                </div>

                                <div
                                        class="date flex"
                                        style="
                    margin-bottom: 10px;
                    position: relative;
                    justify-content: space-between;
                  "
                                >
                                    <img
                                            (click)="
                      !item.get('thirdDateOpen').value
                        ? thirdDateOpenItem(item, true)
                        : null
                    "
                                            [ngStyle]="{
                      cursor: !item.get('thirdDateOpen').value ? 'pointer' : 'default'
                    }"
                                            [src]="
                      !item.get('thirdDateOpen').value
                        ? '/assets/images/thirdDateActive.png'
                        : '/assets/images/thirdDateNotActive.png'
                    "
                                            class="plusIconAsmachta"
                                            style="
											height: auto; width: auto;
                      position: absolute;
                      right: -17px;
                      top: 4px;
                      cursor: pointer;
                    "
                                    />
                                    <p style="min-width: 74px">תאריך ערך</p>

                                    <div style="width: 85px">
                                        <p-calendar
                                                [dateFormat]="'dd/mm/yy'"
                                                [locale]="'langCalendar' | translate"
                                                [style]="{ width: '85px' }"
                                                appendTo="body"
                                                formControlName="dateValue"
                                                placeholder="בחירה"
                                        ></p-calendar>
                                    </div>
                                </div>

                                <div
                                        *ngIf="item.get('thirdDateOpen').value"
                                        class="date flex"
                                        style="
                    margin-bottom: 10px;
                    position: relative;
                    justify-content: space-between;
                  "
                                >
                                    <mat-icon
                                            (click)="
                      thirdDateOpenItem(item, false);
                      item.get('thirdDate').patchValue('')
                    "
                                            style="
                      color: #022258;
                      cursor: pointer;
                      position: absolute;
                      right: -17px;
                      top: 1px;
                      width: 14px;
                      height: 14px;
                      display: block;
                    "
                                            svgIcon="trash"
                                    >
                                    </mat-icon>

                                    <p style="min-width: 74px">תאריך נוסף</p>

                                    <div style="width: 85px">
                                        <p-calendar
                                                [dateFormat]="'dd/mm/yy'"
                                                [locale]="'langCalendar' | translate"
                                                [style]="{ width: '85px' }"
                                                appendTo="body"
                                                formControlName="thirdDate"
                                                placeholder="בחירה"
                                        ></p-calendar>
                                    </div>
                                </div>

                                <div class="flex">
                                    <p (click)="addReceipt()" *ngIf="i === 0" class="addOrder">
                                        <img
                                                height="15"
                                                src="/assets/images/iconCopy.png"
                                                style="margin-left: 5px"
                                                width="13"
                                        />
                                        פיצול קבלה
                                    </p>
                                    <p
                                            (click)="removeReceipt(i)"
                                            *ngIf="i > 0"
                                            class="removeOrder"
                                    >
                                        <mat-icon
                                                style="
                        color: #038ed6;
                        margin-left: 4px;
                        width: 15px;
                        height: 15px;
                      "
                                                svgIcon="trash"
                                        >
                                        </mat-icon>
                                        מחיקה
                                    </p>
                                </div>
                            </div>
                            <div class="border"></div>

                            <ng-container *ngIf="fileFieldsForm.get('41')">
                                <div>
                                    <p-dropdown
                                        #formDropdowns
                                        (onChange)="receiptTypeChange(i, formDropdowns)"
                                        [autoDisplayFirst]="false"
                                        [class.invalid]="
                      arrReceipt.controls[i].get('transTypeReceiptCode')
                        .enabled &&
                      arrReceipt.controls[i].get('transTypeReceiptCode').invalid
                    "
                                        [dropdownIcon]="'fa fa-fw fa-caret-down'"

                                        [options]="
                      fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1
                        ? companyCustomerDetailsData.transTypeDefinedExpense41
                        : companyCustomerDetailsData.transTypeDefinedIncome41
                    "
                                        [scrollHeight]="'185px'"
                                        [style]="{ width: '100%' }"
                                        appendTo="body"
                                        formControlName="transTypeReceiptCode"
                                        name="transTypeReceiptCode"

                                        panelStyleClass="company-customer-dropdown-panel cardsDD card195"
                                        placeholder="בחירה"
                                    >
                                        <ng-template let-item pTemplate="selectedItem">
                      <span
                          #spanElement
                          [pTooltip]="item.label + ' ' + item.value"
                          [tooltipDisabled]="
                          spanElement.offsetWidth >= spanElement.scrollWidth
                        "
                          style="
                          vertical-align: middle;
                          display: block;
                          white-space: nowrap;
                          overflow: hidden;
                          text-overflow: ellipsis;
                        "
                          tooltipPosition="top"
                      >{{ item.onlyName ? item.label : item.value }}</span
                      >
                                        </ng-template>
                                        <ng-template let-item pTemplate="item">
                                            <div class="p-helper-clearfix cust-item">
                                                <div
                                                        style="
                            display: flex;
                            align-items: center;
                            flex-direction: row;
                            justify-content: space-between;
                          "
                                                >
                                                    <span class="text-ellipsis">{{ item.label }}</span>
                                                    <span
                                                            *ngIf="!item.onlyName"
                                                            class="text-ellipsis"
                                                            style="
                              width: 60px;
                              display: inline-block;
                              margin-right: 10px;
                            "
                                                    >{{ item.value }}</span
                                                    >
                                                </div>
                                            </div>
                                        </ng-template>
                                        <ng-template pTemplate="empty">
                                            <div
                                                    class="p-helper-clearfix"
                                                    style="font-size: 0.95em; padding: 0.3em 1em"
                                            >
                                                <div>לא נמצאו נתונים</div>
                                            </div>
                                        </ng-template>
                                        <ng-template pTemplate="footer">
                                            <ng-container *ngIf="isTransTypeStatus">
                                                <div
                                                        class="p-helper-clearfix"
                                                        style="height: 34px; line-height: 34px"
                                                >
                                                    <div
                                                            [routerLinkActiveOptions]="{ exact: true }"
                                                            [routerLink]="[
                              '/accountants/companies/general/transType'
                            ]"
                                                            class="link"
                                                            queryParamsHandling="merge"
                                                            routerLinkActive="active"
                                                            style="text-align: center"
                                                    >
                                                        <span> לשינוי והוספה לחצו כאן </span>
                                                    </div>
                                                </div>
                                            </ng-container>
                                        </ng-template>
                                    </p-dropdown>
                                </div>
                                <div class="border"></div>
                            </ng-container>

                            <ng-container
                                    *ngTemplateOutlet="
                  (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                    1 &&
                    !(
                      fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'חשבונית זיכוי' && !showNegative
                    )) ||
                  (fileFieldsForm.get('21')?.get('effectiveValue').value !==
                    1 &&
                    fileFieldsForm.get('9')?.get('effectiveValue').value ===
                      'חשבונית זיכוי' &&
                    !showNegative)
                    ? expenseTemp
                    : incomeTemp
                "
                            >
                            </ng-container>
                            <div class="border"></div>

                            <ng-container
                                    *ngTemplateOutlet="
                  (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                    1 &&
                    !(
                      fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'חשבונית זיכוי' && !showNegative
                    )) ||
                  (fileFieldsForm.get('21')?.get('effectiveValue').value !==
                    1 &&
                    fileFieldsForm.get('9')?.get('effectiveValue').value ===
                      'חשבונית זיכוי' &&
                    !showNegative)
                    ? incomeTemp
                    : expenseTemp
                "
                            >
                            </ng-container>

                            <ng-container *ngIf="isMatah">
                                <div class="border"></div>
                                <ng-container
                                        *ngTemplateOutlet="
                    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      !(
                        fileFieldsForm.get('9')?.get('effectiveValue').value ===
                          'חשבונית זיכוי' && !showNegative
                      )) ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value !==
                      1 &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'חשבונית זיכוי' &&
                      !showNegative)
                      ? expenseTempSums
                      : incomeTempSums
                  "
                                >
                                </ng-container>
                                <ng-container
                                        *ngTemplateOutlet="
                    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      !(
                        fileFieldsForm.get('9')?.get('effectiveValue').value ===
                          'חשבונית זיכוי' && !showNegative
                      )) ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value !==
                      1 &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'חשבונית זיכוי' &&
                      !showNegative)
                      ? incomeTempSums
                      : expenseTempSums
                  "
                                >
                                </ng-container>
                            </ng-container>

                            <ng-container *ngIf="isMatah">
                                <div class="border"></div>
                                <ng-container
                                        *ngTemplateOutlet="
                    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      !(
                        fileFieldsForm.get('9')?.get('effectiveValue').value ===
                          'חשבונית זיכוי' && !showNegative
                      )) ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value !==
                      1 &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'חשבונית זיכוי' &&
                      !showNegative)
                      ? expenseMatahTemp
                      : incomeMatahTemp
                  "
                                >
                                </ng-container>
                                <ng-container
                                        *ngTemplateOutlet="
                    (fileFieldsForm.get('21')?.get('effectiveValue').value ===
                      1 &&
                      !(
                        fileFieldsForm.get('9')?.get('effectiveValue').value ===
                          'חשבונית זיכוי' && !showNegative
                      )) ||
                    (fileFieldsForm.get('21')?.get('effectiveValue').value !==
                      1 &&
                      fileFieldsForm.get('9')?.get('effectiveValue').value ===
                        'חשבונית זיכוי' &&
                      !showNegative)
                      ? incomeMatahTemp
                      : expenseMatahTemp
                  "
                                >
                                </ng-container>
                            </ng-container>

                            <div class="border"></div>
                            <div style="position: relative">
                                <img
                                        (click)="item.showAsmachta3 = true"
                                        *ngIf="
                    (!item.get('asmachta3').value ||
                      item.get('asmachta3').value === '') &&
                    !item.showAsmachta3
                  "
                                        class="plusIconAsmachta"
                                        src="/assets/images/thirdDateActive.png"
                                />

                                <img
                                        (click)="
                    arrReceipt.controls.length === 1
                      ? (showDocumentListStorageDataFired =
                          'showDocumentAtleft')
                      : arrReceipt.controls.length > 3 ||
                        getJournalHistory.length
                      ? (showDocumentListStorageDataFired =
                          'showDocumentAtSecond')
                      : (showDocumentListStorageDataFired =
                          'showDocumentAtBottom');
                    dialogMaskListen()
                  "
                                        *ngIf="i === 0"
                                        class="openInvoiceModal"
                                        src="/assets/images/openInvoiceModal.png"
                                />

                                <div class="flex" style="margin-bottom: 10px">
                                    <p style="width: 90px">
                                        {{ fieldNameAsmachta }}
                                    </p>
                                    <div style="max-width: 200px">
                                        <input
                                                appNumbersOnly="positive"
                                                autocomplete="off"
                                                class="input-show"
                                                formControlName="asmachta"
                                        />
                                    </div>
                                </div>
                                <div class="flex" style="margin-bottom: 10px">
                                    <p style="width: 90px">אסמכ. תשלום</p>
                                    <div
                                            style="max-width: 185px; display: flex; align-items: center"
                                    >
                                        <input
                                                [size]="
                        item.get('paymentAsmachta').value
                          ? item.get('paymentAsmachta').value.length
                          : 26
                      "
                                                appNumbersOnly="positive"
                                                autocomplete="off"
                                                class="input-show"
                                                formControlName="paymentAsmachta"
                                                maxlength="14"
                                                style="cursor: text"
                                        />
                                    </div>
                                </div>
                                <div
                                        *ngIf="
                    (item.get('asmachta3').value &&
                      item.get('asmachta3').value !== '') ||
                    item['showAsmachta3']
                  "
                                        class="flex"
                                        style="margin-bottom: 10px"
                                >
                                    <p style="width: 90px">אסמכ. 3</p>
                                    <div
                                            style="max-width: 185px; display: flex; align-items: center"
                                    >
                                        <input
                                                [size]="
                        item.get('asmachta3').value
                          ? item.get('asmachta3').value.length
                          : 26
                      "
                                                appNumbersOnly="positive"
                                                autocomplete="off"
                                                class="input-show"
                                                formControlName="asmachta3"
                                                maxlength="14"
                                                style="cursor: text"
                                        />
                                        <mat-icon
                                                (click)="
                        item.showAsmachta3 = false;
                        item.get('asmachta3').patchValue('')
                      "
                                                style="
                        color: #022258;
                        margin-right: 3px;
                        cursor: pointer;
                        width: 15px;
                        height: 15px;
                        display: block;
                      "
                                                svgIcon="trash"
                                        >
                                        </mat-icon>
                                    </div>
                                </div>

                                <div class="flex">
                                    <p style="width: 90px">פרטים</p>
                                    <div style="max-width: 200px">
                                        <input
                                            #inputElement
                                            (blur)="inputElement.elemNotReadonly = false"
                                            (click)="
                        inputElement.elemNotReadonly = true;
                        inputElement.focus()
                      "
                                            [pTooltip]="item.get('details').value"
                                            [readonly]="!inputElement.elemNotReadonly"
                                            [size]="
                        item.get('details').value
                          ? item.get('details').value.length
                          : 26
                      "
                                            [tooltipDisabled]="
                        inputElement.offsetWidth >= inputElement.scrollWidth
                      "
                                            autocomplete="off"
                                            class="input-show text-ellipsis"
                                            formControlName="details"
                                            style="cursor: text"
                                            tooltipPosition="top"
                                        />
                                    </div>
                                </div>
                            </div>

                            <ng-template #expenseTemp>
                                <div style="position: relative; align-self: stretch">
                                    <div
                                            class="flex"
                                            style="margin-bottom: 10px; justify-content: space-between"
                                    >
                                        <div
                                                [ngStyle]="{
                        width: isMatah ? '170px' : '195px',
                        'min-width': isMatah ? '170px' : '195px'
                      }"
                                        >
                                            <!-- ספק לקוח custId  -->
                                            <!-- 											(refresh)="cupaAllTheOptions_custId = false" -->


                                            <app-dropdown-wrap
                                                #aaa
                                                #formDropdowns
                                                #formDropdownsCartis
                                                (onChange)="setCustIdReceipt()"
                                                [autoDisplayFirst]="false"
                                                [class.invalid]="
                          arrReceipt.controls[i].get('custId').enabled &&
                          arrReceipt.controls[i].get('custId').invalid
                        "
                                                [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                                [filter]="true"
                                                [options]="userService.appData.userData.companyCustomerDetails ? disabled_custId(userService.appData.userData.companyCustomerDetails.all, i) : []"
                                                [resetFilterOnHide]="true"
                                                [style]="{ width: isMatah ? '170px' : '195px' }"
                                                [virtualScroll]="true"
                                                [virtualScrollItemSize]="38"
                                                appendTo="body"
                                                dataKey="custId"
                                                emptyFilterMessage="לא נמצאו תוצאות"
                                                filterBy="lName,custId,hp"
                                                formControlName="custId"
                                                name="custId"

                                                optionLabel="custId"
                                                panelStyleClass="company-customer-dropdown-panel cardsDD card195 cardsDD40"
                                                placeholder="בחירה"
                                            >
                                                <ng-template let-item pTemplate="selectedItem">
                          <span
                              #spanElement
                              [pTooltip]="item.cartisName"
                              [tooltipDisabled]="
                              spanElement.offsetWidth >= spanElement.scrollWidth
                            "
                              style="
                              vertical-align: middle;
                              display: block;
                              white-space: nowrap;
                              overflow: hidden;
                              text-overflow: ellipsis;
                            "
                              tooltipPosition="top"
                          >{{ item.cartisName }}</span
                          >
                                                </ng-template>

                                                <ng-template let-item pTemplate="item">
                                                    <div

                                                            [ngStyle]="
                              (fileFieldsForm.get('6').get('effectiveValue') &&
                                fileFieldsForm.get('6').get('effectiveValue')
                                  .value &&
                                fileFieldsForm.get('6').get('effectiveValue')
                                  .value.custId &&
                                fileFieldsForm.get('6').get('effectiveValue')
                                  .value.custId === item.custId) ||
                              (arrReceipt.controls[i].get('paymentCustId')
                                .value &&
                                arrReceipt.controls[i].get('paymentCustId')
                                  .value.custId &&
                                arrReceipt.controls[i].get('paymentCustId')
                                  .value.custId === item.custId) ||
                              (arrReceipt.controls[i].get('taxDeductionCustId')
                                .value &&
                                arrReceipt.controls[i].get('taxDeductionCustId')
                                  .value.custId &&
                                arrReceipt.controls[i].get('taxDeductionCustId')
                                  .value.custId === item.custId)
                                ? { opacity: '0.4', cursor: 'default' }
                                : ''
                            "
                                                            class="p-helper-clearfix"
                                                            style="flex-flow: column"
                                                    >
                                                        <div>
                <span class="text-ellipsis">{{
                    item.cartisName
                    }}</span>
                                                        </div>

                                                        <div style="font-size: 12px">
                  <span
                          class="text-ellipsis secondary"
                  >
	<ng-container
            *ngIf="item.hp">
																				 ח.פ./ע.מ. {{ item.hp }}
	</ng-container>



					  	<ng-container
                                *ngIf="
                                fileFieldsForm.get('6').get('effectiveValue') &&
                                fileFieldsForm.get('6').get('effectiveValue')
                                  .value &&
                                fileFieldsForm.get('6').get('effectiveValue')
                                  .value.custId &&
                                fileFieldsForm.get('6').get('effectiveValue')
                                  .value.custId === item.custId
                              "
                                style="
                                flex: none;
                                width: 100%;
                                height: auto;
                                line-height: normal;
                              "
                        >
															הכרטיס כבר נבחר בכרטיס נגדי
														</ng-container>
														<ng-container
                                                                *ngIf="
                                arrReceipt.controls[i].get('paymentCustId')
                                  .value &&
                                arrReceipt.controls[i].get('paymentCustId')
                                  .value.custId &&
                                arrReceipt.controls[i].get('paymentCustId')
                                  .value.custId === item.custId
                              "
                                                                style="
                                flex: none;
                                width: 100%;
                                height: auto;
                                line-height: normal;
                              "
                                                        >
															הכרטיס כבר נבחר בשדה כרטיס קופה
														</ng-container>
														<ng-container
                                                                *ngIf="
                                arrReceipt.controls[i].get('taxDeductionCustId')
                                  .value &&
                                arrReceipt.controls[i].get('taxDeductionCustId')
                                  .value.custId &&
                                arrReceipt.controls[i].get('taxDeductionCustId')
                                  .value.custId === item.custId
                              "
                                                                style="
                                flex: none;
                                width: 100%;
                                height: auto;
                                line-height: normal;
                              "
                                                        >
															הכרטיס כבר נבחר בשדה כרטיס ניכוי מס
														</ng-container>

</span>


                                                        </div>

                                                    </div>
                                                </ng-template>


                                                <!--                                                <ng-template pTemplate="noItem">-->
                                                <!--                                                    <div class="p-helper-clearfix"-->
                                                <!--                                                         style="font-size: .95em; padding: .3em 1em;">-->
                                                <!--                                                        <div>לא מצאת את הכרטיס שחיפשת?</div>-->
                                                <!--                                                        <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                <!--                                                        <button class="button-link"-->
                                                <!--                                                                style="padding: 0; font-size: inherit;"-->
                                                <!--                                                                (click)="getCompanyCustomerDetails();aaa.putStyle(); $event.stopPropagation()">-->
                                                <!--                                                            ולחצו על-->
                                                <!--                                                            רענון הנתונים-->
                                                <!--                                                        </button>-->
                                                <!--                                                    </div>-->
                                                <!--                                                </ng-template>-->

                                                <ng-template pTemplate="empty">
                                                    <div
                                                            class="p-helper-clearfix"
                                                            style="font-size: 0.95em; padding: 0.3em 1em"
                                                    >
                                                        <ng-container>
                                                            <!--                                                            <div>לא מצאת את הכרטיס?</div>-->
                                                            <!--                                                            <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                            <!--                                                            <div>-->
                                                            <!--                                                                ובנתיים-->
                                                            <!--                                                                <button class="button-link"-->
                                                            <!--                                                                        style="padding: 0; font-size: inherit; text-decoration: underline"-->
                                                            <!--                                                                        (click)="setValCartisModal(formDropdowns, arrReceipt.controls[i].get('custId'));  getCompanyCustomerDetailsTimer();">-->
                                                            <!--                                                                    לחצו לעדכון-->
                                                            <!--                                                                </button>-->
                                                            <!--                                                            </div>-->

                                                            <div>לא מצאתם את הכרטיס שחיפשתם?</div>
                                                            <div>צרו כרטיס חדש בחשבשבת.</div>
                                                            <div>
                                                                בינתיים ניתן לעדכן ידנית את
                                                                <strong style="font-weight: 700">
                                                                    מפתח הכרטיס במדויק
                                                                </strong>
                                                                <br/>
                                                                עד שנמשוך את פרטי הכרטיס.
                                                            </div>
                                                            <button
                                                                    (click)="
                                  setValCartisModal(
                                    formDropdowns,
                                    arrReceipt.controls[i].get('custId')
                                  );
                                  getCompanyCustomerDetailsTimer()
                                "
                                                                    class="button-link"
                                                                    style="
                                  padding: 0;
                                  font-size: inherit;
                                  text-decoration: underline;
                                "
                                                            >
                                                                לעדכון ידני לחצו פה
                                                            </button>
                                                        </ng-container>
                                                        <!--                                                        <ng-container-->
                                                        <!--                                                                *ngIf="!loaderGetCompanyCustomerDetails; else loader">-->
                                                        <!--                                                            <div>לא מצאתם את הכרטיס שחיפשתם?</div>-->
                                                        <!--                                                            <div>צרו כרטיס חדש בחשבשבת.</div>-->
                                                        <!--                                                            <div>-->
                                                        <!--                                                                בנתיים ניתן לעדכן ידנית עד שנמשוך <br>-->
                                                        <!--                                                                את פרטי הכרטיס.-->
                                                        <!--                                                            </div>-->
                                                        <!--                                                            <button class="button-link"-->
                                                        <!--                                                                    style="padding: 0; font-size: inherit;"-->
                                                        <!--                                                                    (click)="setValCartisModal(formDropdowns, arrReceipt.controls[i].get('custId')); formDropdowns.putStyle(); getCompanyCustomerDetailsTimer(); $event.stopPropagation()">-->
                                                        <!--                                                                לעדכון ידני לחצו פה-->
                                                        <!--                                                            </button>-->
                                                        <!--                                                        </ng-container>-->
                                                        <!--                                                        <ng-template #loader>-->
                                                        <!--                                                            <div style="height: 84px;">-->
                                                        <!--                                                                <div class="loaderPercent blueCircle"-->
                                                        <!--                                                                     style="background: #e6e5e5;">-->
                                                        <!--                                                                    <div class="circle"></div>-->
                                                        <!--                                                                </div>-->
                                                        <!--                                                            </div>-->
                                                        <!--                                                            <div style="-->
                                                        <!--    z-index: 999;-->
                                                        <!--    position: absolute;-->
                                                        <!--    bottom: 26px;-->
                                                        <!--    font-size: 14.5px;-->
                                                        <!--    text-align: center;-->
                                                        <!--    font-weight: 600;-->
                                                        <!--    left: 0;-->
                                                        <!--    right: 0;-->
                                                        <!--">-->
                                                        <!--                                                                מתבצע סינכרון-->
                                                        <!--                                                            </div>-->
                                                        <!--                                                        </ng-template>-->
                                                    </div>

                                                </ng-template>

                                                <ng-template pTemplate="emptyfilter">
                                                    <div
                                                            class="p-helper-clearfix"
                                                            style="font-size: 0.95em; padding: 0.3em 1em"
                                                    >
                                                        <ng-container>
                                                            <!--                                                            <div>לא מצאת את הכרטיס?</div>-->
                                                            <!--                                                            <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                            <!--                                                            <div>-->
                                                            <!--                                                                ובנתיים-->
                                                            <!--                                                                <button class="button-link"-->
                                                            <!--                                                                        style="padding: 0; font-size: inherit; text-decoration: underline"-->
                                                            <!--                                                                        (click)="setValCartisModal(formDropdowns, arrReceipt.controls[i].get('custId'));  getCompanyCustomerDetailsTimer();">-->
                                                            <!--                                                                    לחצו לעדכון-->
                                                            <!--                                                                </button>-->
                                                            <!--                                                            </div>-->

                                                            <div>לא מצאתם את הכרטיס שחיפשתם?</div>
                                                            <div>צרו כרטיס חדש בחשבשבת.</div>
                                                            <div>
                                                                בינתיים ניתן לעדכן ידנית את
                                                                <strong style="font-weight: 700">
                                                                    מפתח הכרטיס במדויק
                                                                </strong>
                                                                <br/>
                                                                עד שנמשוך את פרטי הכרטיס.
                                                            </div>
                                                            <button
                                                                    (click)="
                                  setValCartisModal(
                                    formDropdowns,
                                    arrReceipt.controls[i].get('custId')
                                  );
                                  getCompanyCustomerDetailsTimer()
                                "
                                                                    class="button-link"
                                                                    style="
                                  padding: 0;
                                  font-size: inherit;
                                  text-decoration: underline;
                                "
                                                            >
                                                                לעדכון ידני לחצו פה
                                                            </button>
                                                        </ng-container>
                                                        <!--                                                        <ng-container-->
                                                        <!--                                                                *ngIf="!loaderGetCompanyCustomerDetails; else loader">-->
                                                        <!--                                                            <div>לא מצאתם את הכרטיס שחיפשתם?</div>-->
                                                        <!--                                                            <div>צרו כרטיס חדש בחשבשבת.</div>-->
                                                        <!--                                                            <div>-->
                                                        <!--                                                                בנתיים ניתן לעדכן ידנית עד שנמשוך <br>-->
                                                        <!--                                                                את פרטי הכרטיס.-->
                                                        <!--                                                            </div>-->
                                                        <!--                                                            <button class="button-link"-->
                                                        <!--                                                                    style="padding: 0; font-size: inherit;"-->
                                                        <!--                                                                    (click)="setValCartisModal(formDropdowns, arrReceipt.controls[i].get('custId')); formDropdowns.putStyle(); getCompanyCustomerDetailsTimer(); $event.stopPropagation()">-->
                                                        <!--                                                                לעדכון ידני לחצו פה-->
                                                        <!--                                                            </button>-->
                                                        <!--                                                        </ng-container>-->
                                                        <!--                                                        <ng-template #loader>-->
                                                        <!--                                                            <div style="height: 84px;">-->
                                                        <!--                                                                <div class="loaderPercent blueCircle"-->
                                                        <!--                                                                     style="background: #e6e5e5;">-->
                                                        <!--                                                                    <div class="circle"></div>-->
                                                        <!--                                                                </div>-->
                                                        <!--                                                            </div>-->
                                                        <!--                                                            <div style="-->
                                                        <!--    z-index: 999;-->
                                                        <!--    position: absolute;-->
                                                        <!--    bottom: 26px;-->
                                                        <!--    font-size: 14.5px;-->
                                                        <!--    text-align: center;-->
                                                        <!--    font-weight: 600;-->
                                                        <!--    left: 0;-->
                                                        <!--    right: 0;-->
                                                        <!--">-->
                                                        <!--                                                                מתבצע סינכרון-->
                                                        <!--                                                            </div>-->
                                                        <!--                                                        </ng-template>-->
                                                    </div>
                                                </ng-template>
                                            </app-dropdown-wrap>
                                        </div>
                                        <div
                                                *ngIf="!isMatah"
                                                style="align-self: stretch; width: 11px; height: auto"
                                        ></div>
                                        <div
                                                *ngIf="!isMatah"
                                                [class.disabled]="
                        arrReceipt.controls[i].get('total').disabled
                      "
                                                [class.invalid]="
                        arrReceipt.controls[i].get('total').enabled &&
                        (arrReceipt.controls[i].get('total').invalid ||
                          getNum(arrReceipt.controls[i].get('total').value) ===
                            0)
                      "
                                                class="input"
                                                style="width: 85px; display: flex"
                                        >
                                            <input
                                                    (keyup)="calcReceipt(false, i, 'total')"
                                                    appNumbersOnly="positive"
                                                    autocomplete="off"
                                                    formControlName="total"
                                            />

                                            <app-sum-view
                                                    *ngIf="arrReceipt.controls[i].get('total').value"
                                                    [sum]="arrReceipt.controls[i].get('total').value"
                                                    class="text-item text-ellipsis"
                                            ></app-sum-view>
                                            <p
                                                    *ngIf="
                          showNegative &&
                          arrReceipt.controls[i].get('total').value
                        "
                                            >
                                                -
                                            </p>
                                            <p
                                                    *ngIf="!arrReceipt.controls[i].get('total').value"
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </ng-template>
                            <ng-template #incomeTemp>
                                <div>
                                    <div
                                            class="flex"
                                            style="margin-bottom: 10px; justify-content: space-between"
                                    >
                                        <div
                                                [ngStyle]="{
                        width: isMatah ? '170px' : '195px',
                        'min-width': isMatah ? '170px' : '195px'
                      }"
                                        >
                                            <!-- paymentCustId קופה-->
                                            <!-- 											(refresh)="cupaAllTheOptions_paymentCustId = false" -->

                                            <app-dropdown-wrap
                                                    #bbb
                                                    #formDropdowns
                                                    #formDropdownsCartis
                                                    [autoDisplayFirst]="false"
                                                    [class.invalid]="
                          arrReceipt.controls[i].get('paymentCustId').enabled &&
                          arrReceipt.controls[i].get('paymentCustId').invalid
                        "
                                                    [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                                    [filter]="true"
                                                    [options]="
                          userService.appData.userData.companyCustomerDetails
                            ? !cupaAllTheOptions_paymentCustId &&
                              disabled_paymentCustId(userService.appData.userData
                                .companyCustomerDetails.cupa, i)
                              ? userService.appData.userData
                                  .companyCustomerDetails.cupa
                              : disabled_paymentCustId(userService.appData.userData
                                  .companyCustomerDetails.all, i)
                            : []
                        "
                                                    [resetFilterOnHide]="true"
                                                    [style]="{ width: '100%' }"
                                                    [virtualScroll]="true"
                                                    [virtualScrollItemSize]="38"
                                                    appendTo="body"
                                                    dataKey="custId"
                                                    emptyFilterMessage="לא נמצאו תוצאות"
                                                    filterBy="lName,custId,hp"
                                                    formControlName="paymentCustId"
                                                    name="paymentCustId"

                                                    optionLabel="custId"
                                                    panelStyleClass="company-customer-dropdown-panel cardsDD card195 cardsDD40"
                                                    placeholder="בחירה"
                                            >
                                                <ng-template let-item pTemplate="selectedItem">
                          <span
                              #spanElement
                              [pTooltip]="item.cartisName"
                              [tooltipDisabled]="
                              spanElement.offsetWidth >= spanElement.scrollWidth
                            "
                              style="
                              vertical-align: middle;
                              display: block;
                              white-space: nowrap;
                              overflow: hidden;
                              text-overflow: ellipsis;
                            "
                              tooltipPosition="top"
                          >{{ item.cartisName }}</span
                          >
                                                </ng-template>
                                                <!--                                                <ng-template let-item pTemplate="item">-->
                                                <!--                                                    <div class="p-helper-clearfix">-->
                                                <!--                                                        <div>-->
                                                <!--                                                            <span class="text-ellipsis">{{item.custId}}</span>-->
                                                <!--                                                        </div>-->
                                                <!--                                                        <div class="separator"-->
                                                <!--                                                             *ngIf="item.lName || item.hp"><span>-</span>-->
                                                <!--                                                        </div>-->
                                                <!--                                                        <div>-->
                                                <!--                                                            <span class="text-ellipsis"-->
                                                <!--                                                                  *ngIf="item.lName">{{item.lName}}</span>-->
                                                <!--                                                            <span class="text-ellipsis secondary" *ngIf="item.hp">-->
                                                <!--                        ח.פ./ע.מ. {{item.hp}}</span>-->
                                                <!--                                                        </div>-->
                                                <!--                                                    </div>-->
                                                <!--                                                </ng-template>-->

                                                <ng-template let-item pTemplate="item">
                                                    <div

                                                            [ngStyle]="
                              (fileFieldsForm.get('6').get('effectiveValue') &&
                                fileFieldsForm.get('6').get('effectiveValue')
                                  .value &&
                                fileFieldsForm.get('6').get('effectiveValue')
                                  .value.custId &&
                                fileFieldsForm.get('6').get('effectiveValue')
                                  .value.custId === item.custId) ||
                              (arrReceipt.controls[i].get('custId').value &&
                                arrReceipt.controls[i].get('custId').value
                                  .custId &&
                                arrReceipt.controls[i].get('custId').value
                                  .custId === item.custId) ||
                              (arrReceipt.controls[i].get('taxDeductionCustId')
                                .value &&
                                arrReceipt.controls[i].get('taxDeductionCustId')
                                  .value.custId &&
                                arrReceipt.controls[i].get('taxDeductionCustId')
                                  .value.custId === item.custId)
                                ? { opacity: '0.4', cursor: 'default' }
                                : ''
                            "
                                                            class="p-helper-clearfix"
                                                            style="flex-flow: column"
                                                    >
                                                        <div>
                <span class="text-ellipsis">{{
                    item.cartisName
                    }}</span>
                                                        </div>

                                                        <div style="font-size: 12px">
                  <span
                          class="text-ellipsis secondary"
                  >
	<ng-container
            *ngIf="item.hp">
																				 ח.פ./ע.מ. {{ item.hp }}
	</ng-container>



							<ng-container
                                    *ngIf="
                                fileFieldsForm.get('6').get('effectiveValue') &&
                                fileFieldsForm.get('6').get('effectiveValue')
                                  .value &&
                                fileFieldsForm.get('6').get('effectiveValue')
                                  .value.custId &&
                                fileFieldsForm.get('6').get('effectiveValue')
                                  .value.custId === item.custId
                              "
                                    style="
                                flex: none;
                                width: 100%;
                                height: auto;
                                line-height: normal;
                              "
                            >
															הכרטיס כבר נבחר בכרטיס נגדי
														</ng-container>
														<ng-container
                                                                *ngIf="
                                arrReceipt.controls[i].get('taxDeductionCustId')
                                  .value &&
                                arrReceipt.controls[i].get('taxDeductionCustId')
                                  .value.custId &&
                                arrReceipt.controls[i].get('taxDeductionCustId')
                                  .value.custId === item.custId
                              "
                                                                style="
                                flex: none;
                                width: 100%;
                                height: auto;
                                line-height: normal;
                              "
                                                        >
															הכרטיס כבר נבחר בשדה כרטיס ניכוי מס
														</ng-container>
														<ng-container
                                                                *ngIf="
                                arrReceipt.controls[i].get('custId').value &&
                                arrReceipt.controls[i].get('custId').value
                                  .custId &&
                                arrReceipt.controls[i].get('custId').value
                                  .custId === item.custId
                              "
                                                                style="
                                flex: none;
                                width: 100%;
                                height: auto;
                                line-height: normal;
                              "
                                                        >
															הכרטיס כבר נבחר בשדה כרטיס ספק לקוח
														</ng-container>

</span>


                                                        </div>

                                                    </div>
                                                </ng-template>


                                                <ng-template pTemplate="empty">
                                                    <div
                                                            class="p-helper-clearfix"
                                                            style="font-size: 0.95em; padding: 0.3em 1em"
                                                    >
                                                        <ng-container>
                                                            <div>לא מצאתם את הכרטיס שחיפשתם?</div>
                                                            <button
                                                                    (click)="
                                  cupaAllTheOptions_paymentCustId = true;
                                  $event.stopPropagation()
                                "
                                                                    *ngIf="!cupaAllTheOptions_paymentCustId"
                                                                    class="button-link"
                                                                    style="padding: 0; font-size: inherit"
                                                            >
                                                                חפשו בין כל הכרטיסים בהנה״ח
                                                            </button>
                                                            <ng-container
                                                                    *ngIf="cupaAllTheOptions_paymentCustId"
                                                            >
                                                                <!--                                                                <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                                <!--                                                                <div>-->
                                                                <!--                                                                    ובנתיים-->
                                                                <!--                                                                    <button class="button-link"-->
                                                                <!--                                                                            style="padding: 0; font-size: inherit; text-decoration: underline"-->
                                                                <!--                                                                            (click)="setValCartisModal(formDropdowns, arrReceipt.controls[i].get('paymentCustId'));  getCompanyCustomerDetailsTimer();">-->
                                                                <!--                                                                        לחצו לעדכון-->
                                                                <!--                                                                    </button>-->
                                                                <!--                                                                </div>-->

                                                                <div>צרו כרטיס חדש בחשבשבת.</div>
                                                                <div>
                                                                    בינתיים ניתן לעדכן ידנית את
                                                                    <strong style="font-weight: 700">
                                                                        מפתח הכרטיס במדויק
                                                                    </strong>
                                                                    <br/>
                                                                    עד שנמשוך את פרטי הכרטיס.
                                                                </div>
                                                                <button
                                                                        (click)="
                                    setValCartisModal(
                                      formDropdowns,
                                      arrReceipt.controls[i].get(
                                        'paymentCustId'
                                      )
                                    );
                                    getCompanyCustomerDetailsTimer()
                                  "
                                                                        class="button-link"
                                                                        style="
                                    padding: 0;
                                    font-size: inherit;
                                    text-decoration: underline;
                                  "
                                                                >
                                                                    לעדכון ידני לחצו פה
                                                                </button>
                                                            </ng-container>
                                                        </ng-container>
                                                        <!--                                                        <ng-template #loader>-->
                                                        <!--                                                            <div style="height: 84px;">-->
                                                        <!--                                                                <div class="loaderPercent blueCircle"-->
                                                        <!--                                                                     style="background: #e6e5e5;">-->
                                                        <!--                                                                    <div class="circle"></div>-->
                                                        <!--                                                                </div>-->
                                                        <!--                                                            </div>-->
                                                        <!--                                                            <div style="-->
                                                        <!--    z-index: 999;-->
                                                        <!--    position: absolute;-->
                                                        <!--    bottom: 26px;-->
                                                        <!--    font-size: 14.5px;-->
                                                        <!--    text-align: center;-->
                                                        <!--    font-weight: 600;-->
                                                        <!--    left: 0;-->
                                                        <!--    right: 0;-->
                                                        <!--">-->
                                                        <!--                                                                מתבצע סינכרון-->
                                                        <!--                                                            </div>-->
                                                        <!--                                                        </ng-template>-->
                                                    </div>


                                                </ng-template>

                                                <ng-template pTemplate="emptyfilter">
                                                    <div
                                                            class="p-helper-clearfix"
                                                            style="font-size: 0.95em; padding: 0.3em 1em"
                                                    >
                                                        <ng-container>
                                                            <div>לא מצאתם את הכרטיס שחיפשתם?</div>
                                                            <button
                                                                    (click)="
                                  cupaAllTheOptions_paymentCustId = true;
                                  $event.stopPropagation()
                                "
                                                                    *ngIf="!cupaAllTheOptions_paymentCustId"
                                                                    class="button-link"
                                                                    style="padding: 0; font-size: inherit"
                                                            >
                                                                חפשו בין כל הכרטיסים בהנה״ח
                                                            </button>
                                                            <ng-container
                                                                    *ngIf="cupaAllTheOptions_paymentCustId"
                                                            >
                                                                <!--                                                                <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                                <!--                                                                <div>-->
                                                                <!--                                                                    ובנתיים-->
                                                                <!--                                                                    <button class="button-link"-->
                                                                <!--                                                                            style="padding: 0; font-size: inherit; text-decoration: underline"-->
                                                                <!--                                                                            (click)="setValCartisModal(formDropdowns, arrReceipt.controls[i].get('paymentCustId'));  getCompanyCustomerDetailsTimer();">-->
                                                                <!--                                                                        לחצו לעדכון-->
                                                                <!--                                                                    </button>-->
                                                                <!--                                                                </div>-->

                                                                <div>צרו כרטיס חדש בחשבשבת.</div>
                                                                <div>
                                                                    בינתיים ניתן לעדכן ידנית את
                                                                    <strong style="font-weight: 700">
                                                                        מפתח הכרטיס במדויק
                                                                    </strong>
                                                                    <br/>
                                                                    עד שנמשוך את פרטי הכרטיס.
                                                                </div>
                                                                <button
                                                                        (click)="
                                    setValCartisModal(
                                      formDropdowns,
                                      arrReceipt.controls[i].get(
                                        'paymentCustId'
                                      )
                                    );
                                    getCompanyCustomerDetailsTimer()
                                  "
                                                                        class="button-link"
                                                                        style="
                                    padding: 0;
                                    font-size: inherit;
                                    text-decoration: underline;
                                  "
                                                                >
                                                                    לעדכון ידני לחצו פה
                                                                </button>
                                                            </ng-container>
                                                        </ng-container>
                                                        <!--                                                        <ng-template #loader>-->
                                                        <!--                                                            <div style="height: 84px;">-->
                                                        <!--                                                                <div class="loaderPercent blueCircle"-->
                                                        <!--                                                                     style="background: #e6e5e5;">-->
                                                        <!--                                                                    <div class="circle"></div>-->
                                                        <!--                                                                </div>-->
                                                        <!--                                                            </div>-->
                                                        <!--                                                            <div style="-->
                                                        <!--    z-index: 999;-->
                                                        <!--    position: absolute;-->
                                                        <!--    bottom: 26px;-->
                                                        <!--    font-size: 14.5px;-->
                                                        <!--    text-align: center;-->
                                                        <!--    font-weight: 600;-->
                                                        <!--    left: 0;-->
                                                        <!--    right: 0;-->
                                                        <!--">-->
                                                        <!--                                                                מתבצע סינכרון-->
                                                        <!--                                                            </div>-->
                                                        <!--                                                        </ng-template>-->
                                                    </div>

                                                </ng-template>
                                            </app-dropdown-wrap>
                                        </div>

                                        <div
                                                *ngIf="!isMatah"
                                                style="align-self: stretch; width: 11px; height: auto"
                                        ></div>
                                        <div
                                                *ngIf="!isMatah"
                                                [class.disabled]="
                        arrReceipt.controls[i].get('paymentTotal').disabled
                      "
                                                [class.invalid]="
                        arrReceipt.controls[i].get('paymentTotal').enabled &&
                        (arrReceipt.controls[i].get('paymentTotal').invalid ||
                          getNum(
                            arrReceipt.controls[i].get('paymentTotal').value
                          ) === 0)
                      "
                                                class="input"
                                                style="width: 85px; display: flex"
                                        >
                                            <input
                                                    (keyup)="calcReceipt(false, i, 'paymentTotal')"
                                                    appNumbersOnly="positive"
                                                    autocomplete="off"
                                                    formControlName="paymentTotal"
                                            />

                                            <app-sum-view
                                                    *ngIf="arrReceipt.controls[i].get('paymentTotal').value"
                                                    [sum]="arrReceipt.controls[i].get('paymentTotal').value"
                                                    class="text-item text-ellipsis"
                                            ></app-sum-view>
                                            <p
                                                    *ngIf="
                          showNegative &&
                          arrReceipt.controls[i].get('paymentTotal').value
                        "
                                            >
                                                -
                                            </p>
                                            <p
                                                    *ngIf="
                          !arrReceipt.controls[i].get('paymentTotal').value
                        "
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>
                                        </div>
                                    </div>

                                    <div
                                            *ngIf="
                      item.show_taxDeductionCustId === true ||
                      (item.show_taxDeductionCustId !== false &&
                        ((fileFieldsForm.get('33') &&
                          arrReceipt.controls[i].get('paymentNikui').value) ||
                          (fileFieldsForm.get('41') &&
                            arrReceipt.controls[i].get('transTypeReceiptCode')
                              .value &&
                            arrReceipt.controls[i].get('taxDeductionCustId')
                              .value)))
                    "
                                            class="flex"
                                            style="margin-bottom: 10px; justify-content: space-between"
                                    >
                                        <div
                                                [ngStyle]="{
                        width: isMatah ? '170px' : '195px',
                        'min-width': isMatah ? '170px' : '195px'
                      }"
                                        >
                                            <!-- taxDeductionCustId ניקוי מס-->
                                            <app-dropdown-wrap
                                                    #ccc
                                                    #formDropdowns
                                                    #formDropdownsCartis
                                                    [autoDisplayFirst]="false"
                                                    [class.invalid]="
                          arrReceipt.controls[i].get('taxDeductionCustId')
                            .enabled &&
                          arrReceipt.controls[i].get('taxDeductionCustId')
                            .invalid
                        "
                                                    [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                                    [filter]="true"
                                                    [options]="
                          userService.appData.userData.companyCustomerDetails
                            ? fileFieldsForm.get('21')?.get('effectiveValue')
                                .value !== 1
                              ? disabledDD_taxDeductionCustId(userService.appData.userData
                                  .companyCustomerDetails
                                  .customerTaxDeductionCustIdArr, i)
                              : disabledDD_taxDeductionCustId(userService.appData.userData
                                  .companyCustomerDetails
                                  .customerTaxDeductionCustIdExpenseArr, i)
                            : []
                        "
                                                    [resetFilterOnHide]="true"
                                                    [style]="{ width: '100%' }"
                                                    [virtualScroll]="true"
                                                    [virtualScrollItemSize]="38"
                                                    appendTo="body"
                                                    dataKey="custId"
                                                    emptyFilterMessage="לא נמצאו תוצאות"
                                                    filterBy="lName,custId,hp"
                                                    formControlName="taxDeductionCustId"
                                                    name="taxDeductionCustId"

                                                    optionLabel="custId"
                                                    panelStyleClass="company-customer-dropdown-panel cardsDD card195 cardsDD40"
                                                    placeholder="בחירה"
                                            >
                                                <ng-template let-item pTemplate="selectedItem">
                          <span
                              #spanElement
                              [pTooltip]="item.cartisName"
                              [tooltipDisabled]="
                              spanElement.offsetWidth >= spanElement.scrollWidth
                            "
                              style="
                              vertical-align: middle;
                              display: block;
                              white-space: nowrap;
                              overflow: hidden;
                              text-overflow: ellipsis;
                            "
                              tooltipPosition="top"
                          >{{ item.cartisName }}</span
                          >
                                                </ng-template>

                                                <ng-template let-item pTemplate="item">
                                                    <div
                                                            [ngStyle]="
                              (fileFieldsForm.get('6').get('effectiveValue') &&
                                fileFieldsForm.get('6').get('effectiveValue')
                                  .value &&
                                fileFieldsForm.get('6').get('effectiveValue')
                                  .value.custId &&
                                fileFieldsForm.get('6').get('effectiveValue')
                                  .value.custId === item.custId) ||
                              (arrReceipt.controls[i].get('custId').value &&
                                arrReceipt.controls[i].get('custId').value
                                  .custId &&
                                arrReceipt.controls[i].get('custId').value
                                  .custId === item.custId) ||
                              (arrReceipt.controls[i].get('paymentCustId')
                                .value &&
                                arrReceipt.controls[i].get('paymentCustId')
                                  .value.custId &&
                                arrReceipt.controls[i].get('paymentCustId')
                                  .value.custId === item.custId)
                                ? { opacity: '0.4', cursor: 'default' }
                                : ''
                            "
                                                            class="p-helper-clearfix"
                                                            style="flex-flow: column"
                                                    >
                                                        <div>
                <span class="text-ellipsis">{{
                    item.cartisName
                    }}</span>
                                                        </div>

                                                        <div style="font-size: 12px">
                  <span
                          class="text-ellipsis secondary"
                  >
	<ng-container
            *ngIf="item.hp">
																				 ח.פ./ע.מ. {{ item.hp }}
	</ng-container>


					  			<ng-container
                                        *ngIf="
                                fileFieldsForm.get('6').get('effectiveValue') &&
                                fileFieldsForm.get('6').get('effectiveValue')
                                  .value &&
                                fileFieldsForm.get('6').get('effectiveValue')
                                  .value.custId &&
                                fileFieldsForm.get('6').get('effectiveValue')
                                  .value.custId === item.custId
                              "
                                        style="
                                flex: none;
                                width: 100%;
                                height: auto;
                                line-height: normal;
                              "
                                >
															הכרטיס כבר נבחר בכרטיס נגדי
														</ng-container>
														<ng-container
                                                                *ngIf="
                                arrReceipt.controls[i].get('custId').value &&
                                arrReceipt.controls[i].get('custId').value
                                  .custId &&
                                arrReceipt.controls[i].get('custId').value
                                  .custId === item.custId
                              "
                                                                style="
                                flex: none;
                                width: 100%;
                                height: auto;
                                line-height: normal;
                              "
                                                        >
															הכרטיס כבר נבחר בשדה כרטיס ספק לקוח
														</ng-container>
														<ng-container
                                                                *ngIf="
                                arrReceipt.controls[i].get('paymentCustId')
                                  .value &&
                                arrReceipt.controls[i].get('paymentCustId')
                                  .value.custId &&
                                arrReceipt.controls[i].get('paymentCustId')
                                  .value.custId === item.custId
                              "
                                                                style="
                                flex: none;
                                width: 100%;
                                height: auto;
                                line-height: normal;
                              "
                                                        >
															הכרטיס כבר נבחר בשדה כרטיס קופה
														</ng-container>

</span>


                                                        </div>

                                                    </div>
                                                </ng-template>


                                                <!--                                                <ng-template pTemplate="noItem">-->
                                                <!--                                                    <div class="p-helper-clearfix"-->
                                                <!--                                                         style="font-size: .95em; padding: .3em 1em;">-->
                                                <!--                                                        <div>לא מצאת את הכרטיס שחיפשת?</div>-->
                                                <!--                                                        <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                <!--                                                        <button class="button-link"-->
                                                <!--                                                                style="padding: 0; font-size: inherit;"-->
                                                <!--                                                                (click)="getCompanyCustomerDetails();ccc.putStyle(); $event.stopPropagation()">-->
                                                <!--                                                            ולחצו על-->
                                                <!--                                                            רענון הנתונים-->
                                                <!--                                                        </button>-->
                                                <!--                                                    </div>-->
                                                <!--                                                </ng-template>-->


                                                <ng-template pTemplate="empty">
                                                    <div
                                                            class="p-helper-clearfix"
                                                            style="font-size: 0.95em; padding: 0.3em 1em"
                                                    >
                                                        <!--                                                        <ng-container *ngIf="!loaderGetCompanyCustomerDetails; else loader">-->
                                                        <!--                                                            <div>לא מצאת את הכרטיס שחיפשת?</div>-->
                                                        <!--                                                            <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                        <!--                                                            <button class="button-link" style="padding: 0; font-size: inherit;"-->
                                                        <!--                                                                    (click)="getCompanyCustomerDetailsTimer();ccc.putStyle(); $event.stopPropagation()">-->
                                                        <!--                                                                ולחצו על-->
                                                        <!--                                                                רענון הנתונים-->
                                                        <!--                                                            </button>-->
                                                        <!--                                                        </ng-container>-->

                                                        <ng-container>
                                                            <!--                                                                                                                    <div>לא מצאתם את הכרטיס שחיפשתם?</div>-->
                                                            <!--                                                                                                                    <div>צרו כרטיס חדש בחשבשבת.</div>-->
                                                            <!--                                                                                                                    <div>-->
                                                            <!--                                                                                                                        בנתיים ניתן לעדכן ידנית עד שנמשוך <br>-->
                                                            <!--                                                                                                                        את פרטי הכרטיס.-->
                                                            <!--                                                                                                                    </div>-->
                                                            <!--                                                                                                                    <button class="button-link"-->
                                                            <!--                                                                                                                            style="padding: 0; font-size: inherit;"-->
                                                            <!--                                                                                                                            (click)="setValCartisModal(formDropdowns, arrReceipt.controls[i].get('taxDeductionCustId'));  getCompanyCustomerDetailsTimer();">-->
                                                            <!--                                                                                                                        לעדכון ידני לחצו פה-->
                                                            <!--                                                                                                                    </button>-->

                                                            <div>לא מצאתם את הכרטיס שחיפשתם?</div>
                                                            <div>צרו כרטיס חדש בחשבשבת.</div>
                                                            <div>
                                                                בינתיים ניתן לעדכן ידנית את
                                                                <strong style="font-weight: 700">
                                                                    מפתח הכרטיס במדויק
                                                                </strong>
                                                                <br/>
                                                                עד שנמשוך את פרטי הכרטיס.
                                                            </div>
                                                            <button
                                                                    (click)="
                                  setValCartisModal(
                                    formDropdowns,
                                    arrReceipt.controls[i].get(
                                      'taxDeductionCustId'
                                    )
                                  );
                                  getCompanyCustomerDetailsTimer()
                                "
                                                                    class="button-link"
                                                                    style="
                                  padding: 0;
                                  font-size: inherit;
                                  text-decoration: underline;
                                "
                                                            >
                                                                לעדכון ידני לחצו פה
                                                            </button>
                                                        </ng-container>
                                                        <!--                                                        <ng-container>-->
                                                        <!--                                                            <div>לא מצאת את הכרטיס?</div>-->
                                                        <!--                                                            <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                        <!--                                                            <div>-->
                                                        <!--                                                                ובנתיים-->
                                                        <!--                                                                <button class="button-link"-->
                                                        <!--                                                                        style="padding: 0; font-size: inherit; text-decoration: underline"-->
                                                        <!--                                                                        (click)="setValCartisModal(formDropdowns, arrReceipt.controls[i].get('taxDeductionCustId'));  getCompanyCustomerDetailsTimer();">-->
                                                        <!--                                                                    לחצו לעדכון-->
                                                        <!--                                                                </button>-->
                                                        <!--                                                            </div>-->
                                                        <!--                                                        </ng-container>-->
                                                        <!--                                                        <ng-template #loader>-->
                                                        <!--                                                            <div style="height: 84px;">-->
                                                        <!--                                                                <div class="loaderPercent blueCircle"-->
                                                        <!--                                                                     style="background: #e6e5e5;">-->
                                                        <!--                                                                    <div class="circle"></div>-->
                                                        <!--                                                                </div>-->
                                                        <!--                                                            </div>-->
                                                        <!--                                                            <div style="-->
                                                        <!--    z-index: 999;-->
                                                        <!--    position: absolute;-->
                                                        <!--    bottom: 26px;-->
                                                        <!--    font-size: 14.5px;-->
                                                        <!--    text-align: center;-->
                                                        <!--    font-weight: 600;-->
                                                        <!--    left: 0;-->
                                                        <!--    right: 0;-->
                                                        <!--">-->
                                                        <!--                                                                מתבצע סינכרון-->
                                                        <!--                                                            </div>-->
                                                        <!--                                                        </ng-template>-->
                                                    </div>


                                                </ng-template>

                                                <ng-template pTemplate="emptyfilter">
                                                    <div
                                                            class="p-helper-clearfix"
                                                            style="font-size: 0.95em; padding: 0.3em 1em"
                                                    >
                                                        <!--                                                        <ng-container *ngIf="!loaderGetCompanyCustomerDetails; else loader">-->
                                                        <!--                                                            <div>לא מצאת את הכרטיס שחיפשת?</div>-->
                                                        <!--                                                            <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                        <!--                                                            <button class="button-link" style="padding: 0; font-size: inherit;"-->
                                                        <!--                                                                    (click)="getCompanyCustomerDetailsTimer();ccc.putStyle(); $event.stopPropagation()">-->
                                                        <!--                                                                ולחצו על-->
                                                        <!--                                                                רענון הנתונים-->
                                                        <!--                                                            </button>-->
                                                        <!--                                                        </ng-container>-->

                                                        <ng-container>
                                                            <!--                                                                                                                    <div>לא מצאתם את הכרטיס שחיפשתם?</div>-->
                                                            <!--                                                                                                                    <div>צרו כרטיס חדש בחשבשבת.</div>-->
                                                            <!--                                                                                                                    <div>-->
                                                            <!--                                                                                                                        בנתיים ניתן לעדכן ידנית עד שנמשוך <br>-->
                                                            <!--                                                                                                                        את פרטי הכרטיס.-->
                                                            <!--                                                                                                                    </div>-->
                                                            <!--                                                                                                                    <button class="button-link"-->
                                                            <!--                                                                                                                            style="padding: 0; font-size: inherit;"-->
                                                            <!--                                                                                                                            (click)="setValCartisModal(formDropdowns, arrReceipt.controls[i].get('taxDeductionCustId'));  getCompanyCustomerDetailsTimer();">-->
                                                            <!--                                                                                                                        לעדכון ידני לחצו פה-->
                                                            <!--                                                                                                                    </button>-->

                                                            <div>לא מצאתם את הכרטיס שחיפשתם?</div>
                                                            <div>צרו כרטיס חדש בחשבשבת.</div>
                                                            <div>
                                                                בינתיים ניתן לעדכן ידנית את
                                                                <strong style="font-weight: 700">
                                                                    מפתח הכרטיס במדויק
                                                                </strong>
                                                                <br/>
                                                                עד שנמשוך את פרטי הכרטיס.
                                                            </div>
                                                            <button
                                                                    (click)="
                                  setValCartisModal(
                                    formDropdowns,
                                    arrReceipt.controls[i].get(
                                      'taxDeductionCustId'
                                    )
                                  );
                                  getCompanyCustomerDetailsTimer()
                                "
                                                                    class="button-link"
                                                                    style="
                                  padding: 0;
                                  font-size: inherit;
                                  text-decoration: underline;
                                "
                                                            >
                                                                לעדכון ידני לחצו פה
                                                            </button>
                                                        </ng-container>
                                                        <!--                                                        <ng-container>-->
                                                        <!--                                                            <div>לא מצאת את הכרטיס?</div>-->
                                                        <!--                                                            <div>צרו כרטיס חדש בהנה"ח</div>-->
                                                        <!--                                                            <div>-->
                                                        <!--                                                                ובנתיים-->
                                                        <!--                                                                <button class="button-link"-->
                                                        <!--                                                                        style="padding: 0; font-size: inherit; text-decoration: underline"-->
                                                        <!--                                                                        (click)="setValCartisModal(formDropdowns, arrReceipt.controls[i].get('taxDeductionCustId'));  getCompanyCustomerDetailsTimer();">-->
                                                        <!--                                                                    לחצו לעדכון-->
                                                        <!--                                                                </button>-->
                                                        <!--                                                            </div>-->
                                                        <!--                                                        </ng-container>-->
                                                        <!--                                                        <ng-template #loader>-->
                                                        <!--                                                            <div style="height: 84px;">-->
                                                        <!--                                                                <div class="loaderPercent blueCircle"-->
                                                        <!--                                                                     style="background: #e6e5e5;">-->
                                                        <!--                                                                    <div class="circle"></div>-->
                                                        <!--                                                                </div>-->
                                                        <!--                                                            </div>-->
                                                        <!--                                                            <div style="-->
                                                        <!--    z-index: 999;-->
                                                        <!--    position: absolute;-->
                                                        <!--    bottom: 26px;-->
                                                        <!--    font-size: 14.5px;-->
                                                        <!--    text-align: center;-->
                                                        <!--    font-weight: 600;-->
                                                        <!--    left: 0;-->
                                                        <!--    right: 0;-->
                                                        <!--">-->
                                                        <!--                                                                מתבצע סינכרון-->
                                                        <!--                                                            </div>-->
                                                        <!--                                                        </ng-template>-->
                                                    </div>


                                                </ng-template>
                                            </app-dropdown-wrap>
                                        </div>

                                        <div
                                                *ngIf="!isMatah"
                                                style="align-self: stretch; width: 11px; height: auto"
                                        ></div>
                                        <div
                                                *ngIf="!isMatah"
                                                [class.disabled]="
                        arrReceipt.controls[i].get('paymentNikui').disabled
                      "
                                                [class.invalid]="
                        arrReceipt.controls[i].get('paymentNikui').enabled &&
                        arrReceipt.controls[i].get('paymentNikui').invalid
                      "
                                                class="input"
                                                style="width: 85px; display: flex; position: relative"
                                        >
                                            <input
                                                    (keyup)="calcReceipt(false, i, 'paymentNikui')"
                                                    appNumbersOnly="positive"
                                                    autocomplete="off"
                                                    formControlName="paymentNikui"
                                            />

                                            <app-sum-view
                                                    *ngIf="arrReceipt.controls[i].get('paymentNikui').value"
                                                    [sum]="arrReceipt.controls[i].get('paymentNikui').value"
                                                    class="text-item text-ellipsis"
                                            ></app-sum-view>
                                            <p
                                                    *ngIf="
                          showNegative &&
                          arrReceipt.controls[i].get('paymentNikui').value
                        "
                                            >
                                                -
                                            </p>
                                            <p
                                                    *ngIf="
                          !arrReceipt.controls[i].get('paymentNikui').value
                        "
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>

                                            <mat-icon
                                                    (click)="
                          item.show_taxDeductionCustId = false;
                          item.get('paymentNikui').patchValue(0);
                          calcReceipt(false, i, 'paymentNikui')
                        "
                                                    style="
                          color: #022258;
                          margin-right: 3px;
                          cursor: pointer;
                          width: 15px;
                          height: 15px;
                          display: block;
                          position: absolute;
                          left: -17px;
                          top: 4px;
                        "
                                                    svgIcon="trash"
                                            >
                                            </mat-icon>
                                        </div>
                                    </div>

                                    <div
                                            *ngIf="
                      item.show_taxDeductionCustId === false ||
                      (item.show_taxDeductionCustId === undefined &&
                        !(
                          (fileFieldsForm.get('33') &&
                            arrReceipt.controls[i].get('paymentNikui').value) ||
                          (fileFieldsForm.get('41') &&
                            arrReceipt.controls[i].get('transTypeReceiptCode')
                              .value &&
                            arrReceipt.controls[i].get('taxDeductionCustId')
                              .value)
                        ))
                    "
                                            class="flex"
                                            style="margin-bottom: 10px; justify-content: space-between"
                                    >
                    <span
                            (click)="
                        item.show_taxDeductionCustId = true;
                        item.get('paymentNikui').patchValue(0);
                        calcReceipt()
                      "
                            class="link_add_nikui"
                    >
                      <img fill ngSrc="/assets/images/thirdDateActive.png"
                           style="height: auto; width: auto; position: relative;"/>
                      הוספת ניכוי
                    </span>
                                    </div>

                                    <div
                                            *ngIf="
                      arrReceipt.controls[i].get('custId').value &&
                      arrReceipt.controls[i].get('paymentCustId').value &&
                      arrReceipt.controls[i].get('custId').value.custId ===
                        arrReceipt.controls[i].get('paymentCustId').value.custId
                    "
                                            class="flex"
                                            style="
                      margin-bottom: 10px;
                      justify-content: space-between;
                      color: #cd1010;
                    "
                                    >
                                        לא ניתן לבחור שני כרטיסים זהים
                                    </div>
                                </div>
                            </ng-template>

                            <ng-template #expenseTempSums>
                                <div style="position: relative; align-self: stretch">
                                    <div style="overflow: hidden">
                                        <div
                                                [class.disabled]="
                        arrReceipt.controls[i].get('total').disabled
                      "
                                                [class.invalid]="
                        arrReceipt.controls[i].get('total').enabled &&
                        (arrReceipt.controls[i].get('total').invalid ||
                          getNum(arrReceipt.controls[i].get('total').value) ===
                            0)
                      "
                                                class="input"
                                                style="width: 85px; display: flex"
                                        >
                                            <input
                                                    (keyup)="calcReceipt(false, i, 'total')"
                                                    appNumbersOnly="positive"
                                                    autocomplete="off"
                                                    formControlName="total"
                                            />

                                            <app-sum-view
                                                    *ngIf="arrReceipt.controls[i].get('total').value"
                                                    [sum]="arrReceipt.controls[i].get('total').value"
                                                    class="text-item text-ellipsis"
                                            ></app-sum-view>
                                            <p
                                                    *ngIf="
                          showNegative &&
                          arrReceipt.controls[i].get('total').value
                        "
                                            >
                                                -
                                            </p>
                                            <p
                                                    *ngIf="!arrReceipt.controls[i].get('total').value"
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </ng-template>
                            <ng-template #incomeTempSums>
                                <div>
                                    <div style="overflow: hidden">
                                        <div
                                                [class.disabled]="
                        arrReceipt.controls[i].get('paymentTotal').disabled
                      "
                                                [class.invalid]="
                        arrReceipt.controls[i].get('paymentTotal').enabled &&
                        (arrReceipt.controls[i].get('paymentTotal').invalid ||
                          getNum(
                            arrReceipt.controls[i].get('paymentTotal').value
                          ) === 0)
                      "
                                                class="input"
                                                style="width: 85px; display: flex; margin-bottom: 10px"
                                        >
                                            <input
                                                    (keyup)="calcReceipt(false, i, 'paymentTotal')"
                                                    appNumbersOnly="positive"
                                                    autocomplete="off"
                                                    formControlName="paymentTotal"
                                            />

                                            <app-sum-view
                                                    *ngIf="arrReceipt.controls[i].get('paymentTotal').value"
                                                    [sum]="arrReceipt.controls[i].get('paymentTotal').value"
                                                    class="text-item text-ellipsis"
                                            ></app-sum-view>
                                            <p
                                                    *ngIf="
                          showNegative &&
                          arrReceipt.controls[i].get('paymentTotal').value
                        "
                                            >
                                                -
                                            </p>
                                            <p
                                                    *ngIf="
                          !arrReceipt.controls[i].get('paymentTotal').value
                        "
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>
                                        </div>

                                        <div
                                                *ngIf="
                        (fileFieldsForm.get('33') &&
                          arrReceipt.controls[i].get('paymentNikui').value) ||
                        (fileFieldsForm.get('41') &&
                          arrReceipt.controls[i].get('transTypeReceiptCode')
                            .value)
                      "
                                                [class.disabled]="
                        arrReceipt.controls[i].get('paymentNikui').disabled
                      "
                                                [class.invalid]="
                        arrReceipt.controls[i].get('paymentNikui').enabled &&
                        arrReceipt.controls[i].get('paymentNikui').invalid
                      "
                                                class="input"
                                                style="width: 85px; display: flex"
                                        >
                                            <input
                                                    (keyup)="calcReceipt(false, i, 'paymentNikui')"
                                                    appNumbersOnly="positive"
                                                    autocomplete="off"
                                                    formControlName="paymentNikui"
                                            />

                                            <app-sum-view
                                                    *ngIf="arrReceipt.controls[i].get('paymentNikui').value"
                                                    [sum]="arrReceipt.controls[i].get('paymentNikui').value"
                                                    class="text-item text-ellipsis"
                                            ></app-sum-view>
                                            <p
                                                    *ngIf="
                          showNegative &&
                          arrReceipt.controls[i].get('paymentNikui').value
                        "
                                            >
                                                -
                                            </p>
                                            <p
                                                    *ngIf="
                          !arrReceipt.controls[i].get('paymentNikui').value
                        "
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </ng-template>

                            <ng-template #expenseMatahTemp>
                                <div style="position: relative; align-self: stretch">
                                    <div style="overflow: hidden">
                                        <div
                                                class="input disabled"
                                                style="width: 85px; display: flex"
                                        >
                                            <app-sum-view
                                                    *ngIf="arrReceipt.controls[i].get('totalMatah').value"
                                                    [sum]="arrReceipt.controls[i].get('totalMatah').value"
                                                    class="text-item text-ellipsis"
                                            ></app-sum-view>
                                            <p
                                                    *ngIf="
                          showNegative &&
                          arrReceipt.controls[i].get('totalMatah').value
                        "
                                            >
                                                -
                                            </p>
                                            <p
                                                    *ngIf="!arrReceipt.controls[i].get('totalMatah').value"
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>
                                        </div>
                                    </div>

                                    <i
                                            *ngIf="
                      fileFieldsForm.get('21')?.get('effectiveValue').value !==
                      1
                    "
                                            [matTooltip]="'לפי שער יציג של ' + rate + ' ₪'"
                                            class="fas fa-globe"
                                            matTooltipPosition="below"
                                            style="
                      position: absolute;
                      bottom: 0px;
                      left: 0px;
                      cursor: pointer;
                    "
                                    ></i>
                                </div>
                            </ng-template>
                            <ng-template #incomeMatahTemp>
                                <div style="position: relative; align-self: stretch">
                                    <div style="overflow: hidden">
                                        <div
                                                [class.disabled]="
                        arrReceipt.controls[i].get('paymentTotalMatah').disabled
                      "
                                                [class.invalid]="
                        arrReceipt.controls[i].get('paymentTotalMatah')
                          .enabled &&
                        (arrReceipt.controls[i].get('paymentTotalMatah')
                          .invalid ||
                          getNum(
                            arrReceipt.controls[i].get('paymentTotalMatah')
                              .value
                          ) === 0)
                      "
                                                class="input"
                                                style="width: 85px; display: flex; margin-bottom: 10px"
                                        >
                                            <input
                                                    (keyup)="calcReceipt(false, i, 'paymentTotalMatah')"
                                                    appNumbersOnly="positive"
                                                    autocomplete="off"
                                                    formControlName="paymentTotalMatah"
                                            />

                                            <app-sum-view
                                                    *ngIf="
                          arrReceipt.controls[i].get('paymentTotalMatah').value
                        "
                                                    [sum]="
                          arrReceipt.controls[i].get('paymentTotalMatah').value
                        "
                                                    class="text-item text-ellipsis"
                                            ></app-sum-view>
                                            <p
                                                    *ngIf="
                          showNegative &&
                          arrReceipt.controls[i].get('paymentTotalMatah').value
                        "
                                            >
                                                -
                                            </p>
                                            <p
                                                    *ngIf="
                          !arrReceipt.controls[i].get('paymentTotalMatah').value
                        "
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>
                                        </div>

                                        <div
                                                *ngIf="
                        (fileFieldsForm.get('33') &&
                          arrReceipt.controls[i].get('paymentNikui').value) ||
                        (fileFieldsForm.get('41') &&
                          arrReceipt.controls[i].get('transTypeReceiptCode')
                            .value)
                      "
                                                [class.disabled]="
                        arrReceipt.controls[i].get('paymentNikuiMatah').disabled
                      "
                                                class="input"
                                                style="width: 85px; display: flex"
                                        >
                                            <input
                                                    (keyup)="calcReceipt(false, i, 'paymentNikuiMatah')"
                                                    appNumbersOnly="positive"
                                                    autocomplete="off"
                                                    formControlName="paymentNikuiMatah"
                                            />

                                            <app-sum-view
                                                    *ngIf="
                          arrReceipt.controls[i].get('paymentNikuiMatah').value
                        "
                                                    [sum]="
                          arrReceipt.controls[i].get('paymentNikuiMatah').value
                        "
                                                    class="text-item text-ellipsis"
                                            ></app-sum-view>
                                            <p
                                                    *ngIf="
                          showNegative &&
                          arrReceipt.controls[i].get('paymentNikuiMatah').value
                        "
                                            >
                                                -
                                            </p>
                                            <p
                                                    *ngIf="
                          !arrReceipt.controls[i].get('paymentNikuiMatah').value
                        "
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>
                                        </div>
                                        <i
                                                *ngIf="
                        fileFieldsForm.get('21')?.get('effectiveValue')
                          .value === 1
                      "
                                                [matTooltip]="'לפי שער יציג של ' + rate + ' ₪'"
                                                class="fas fa-globe"
                                                matTooltipPosition="below"
                                                style="
                        position: absolute;
                        bottom: 0px;
                        left: 0px;
                        cursor: pointer;
                      "
                                        ></i>
                                    </div>
                                </div>
                            </ng-template>
                        </div>
                    </div>
                </div>
                <ng-container *ngIf="getJournalHistory; else loader">
                    <div
                            *ngFor="
              let item of getJournalHistory;
              let i = index;
              first as isFirst
            "
                            [class.first]="isFirst"
                            class="row"
                    >
                        <div class="dateFl">
                            <div
                                    *ngIf="isFirst"
                                    style="font-size: 16px; font-weight: 700; margin-bottom: 5px"
                            >
                                היסטוריה
                            </div>
                            <div
                                    class="date flex"
                                    style="margin-bottom: 10px; justify-content: space-between"
                            >
                                <p>תאריך</p>

                                <div style="width: 85px">
                                    {{ item.referenceDate | date: 'dd/MM/yyyy' }}
                                </div>
                            </div>
                            <div
                                    class="date flex"
                                    style="margin-bottom: 10px; justify-content: space-between"
                            >
                                <p>תאריך ערך</p>

                                <div style="width: 85px">
                                    {{ item.paymentDate | date: 'dd/MM/yyyy' }}
                                </div>
                            </div>
                        </div>
                        <div class="border"></div>

                        <ng-container *ngIf="fileFieldsForm.get('41')">
                            <div>
                                {{ item.transTypeCode }}
                            </div>
                            <div class="border"></div>
                        </ng-container>

                        <ng-container
                                *ngTemplateOutlet="!item.expense ? expenseTemp : incomeTemp"
                        >
                        </ng-container>
                        <div class="border"></div>
                        <ng-container
                                *ngTemplateOutlet="!item.expense ? incomeTemp : expenseTemp"
                        >
                        </ng-container>

                        <ng-container *ngIf="isMatah">
                            <div class="border"></div>
                            <ng-container
                                    *ngTemplateOutlet="
                  !item.expense ? expenseTempSums : incomeTempSums
                "
                            >
                            </ng-container>
                            <ng-container
                                    *ngTemplateOutlet="
                  !item.expense ? incomeTempSums : expenseTempSums
                "
                            >
                            </ng-container>
                        </ng-container>
                        <ng-container *ngIf="isMatah">
                            <div class="border"></div>
                            <ng-container
                                    *ngTemplateOutlet="
                  !item.expense ? expenseMatahTemp : incomeMatahTemp
                "
                            >
                            </ng-container>
                            <ng-container
                                    *ngTemplateOutlet="
                  !item.expense ? incomeMatahTemp : expenseMatahTemp
                "
                            >
                            </ng-container>
                        </ng-container>
                        <div class="border"></div>
                        <div style="position: relative">
                            <div class="flex" style="margin-bottom: 10px">
                                <p style="width: 90px">
                                    {{ fieldNameAsmachta }}
                                </p>
                                <div style="width: 91px; margin-left: 20px">
                                    <input
                                            [(ngModel)]="item.asmachta1"
                                            appNumbersOnly="positive"
                                            autocomplete="off"
                                            class="input-show"
                                            disabled
                                            readonly
                                    />
                                </div>
                                <p style="width: 40px">מנה</p>
                                <div style="width: 65px">
                                    <input
                                            [(ngModel)]="item.batchNum"
                                            autocomplete="off"
                                            class="input-show"
                                            disabled
                                            readonly
                                    />
                                </div>
                            </div>
                            <div class="flex" style="margin-bottom: 10px">
                                <p style="width: 90px">אסמכ. תשלום</p>
                                <div style="width: 91px; margin-left: 20px">
                                    <input
                                            [(ngModel)]="item.asmachta2"
                                            appNumbersOnly="positive"
                                            autocomplete="off"
                                            class="input-show"
                                            disabled
                                            readonly
                                    />
                                </div>
                                <p style="width: 40px">פקודה</p>
                                <div style="width: 65px">
                                    <input
                                            [(ngModel)]="item.misparTnua"
                                            autocomplete="off"
                                            class="input-show"
                                            disabled
                                            readonly
                                    />
                                </div>
                            </div>
                            <div class="flex">
                                <p style="width: 90px">פרטים</p>
                                <div style="max-width: 200px">
                                    <input
                                        #inputElement
                                        [(ngModel)]="item.details"
                                        [pTooltip]="item.details"
                                        [tooltipDisabled]="
                      inputElement.offsetWidth >= inputElement.scrollWidth
                    "
                                        autocomplete="off"
                                        class="input-show text-ellipsis"
                                        disabled
                                        readonly
                                        tooltipPosition="top"
                                    />
                                </div>
                            </div>
                        </div>
                        <ng-template #empty>
                            <div>&nbsp;</div>
                        </ng-template>
                        <ng-template #expenseTemp>
                            <div style="position: relative; align-self: stretch">
                                <div
                                        class="flex"
                                        style="margin-bottom: 10px; justify-content: space-between"
                                >
                                    <div style="width: 195px; min-width: 195px">
                                        <div *ngIf="item.cust; else empty" class="p-dropdown">
                                            <label class="p-dropdown-label">
                        <span
                            #spanElement
                            [pTooltip]="item.cust.cartisName"
                            [tooltipDisabled]="
                            spanElement.offsetWidth >= spanElement.scrollWidth
                          "
                            style="
                            vertical-align: middle;
                            display: block;
                            white-space: nowrap;
                            overflow: hidden;
                            text-overflow: ellipsis;
                          "
                            tooltipPosition="top"
                        >{{ item.cust.cartisName }}</span
                        >
                                            </label>
                                        </div>
                                    </div>

                                    <div
                                            style="align-self: stretch; width: 11px; height: auto"
                                    ></div>
                                    <div
                                            *ngIf="!isMatah"
                                            class="input disabled"
                                            style="width: 85px"
                                    >
                                        <app-sum-view
                                                *ngIf="item.totalIncludeMaam"
                                                [sum]="item.totalIncludeMaam"
                                                class="text-item text-ellipsis"
                                        ></app-sum-view>

                                        <p
                                                *ngIf="!item.totalIncludeMaam"
                                                class="text-item text-ellipsis"
                                        >
                                            0
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                        <ng-template #incomeTemp>
                            <div>
                                <div
                                        class="flex"
                                        style="margin-bottom: 10px; justify-content: space-between"
                                >
                                    <div
                                            [ngStyle]="{
                      width: isMatah ? '170px' : '195px',
                      'min-width': isMatah ? '170px' : '195px'
                    }"
                                    >
                                        <div
                                                *ngIf="item.oppositCust; else empty"
                                                class="p-dropdown"
                                        >
                                            <label class="p-dropdown-label">
                        <span
                            #spanElement
                            [pTooltip]="item.oppositCust.cartisName"
                            [tooltipDisabled]="
                            spanElement.offsetWidth >= spanElement.scrollWidth
                          "
                            style="
                            vertical-align: middle;
                            display: block;
                            white-space: nowrap;
                            overflow: hidden;
                            text-overflow: ellipsis;
                          "
                            tooltipPosition="top"
                        >{{ item.oppositCust.cartisName }}</span
                        >
                                            </label>
                                        </div>
                                    </div>

                                    <div
                                            *ngIf="!isMatah"
                                            style="align-self: stretch; width: 11px; height: auto"
                                    ></div>
                                    <div
                                            *ngIf="!isMatah"
                                            class="input disabled"
                                            style="width: 85px"
                                    >
                                        <app-sum-view
                                                *ngIf="item.totalBeforeMaam"
                                                [sum]="item.totalBeforeMaam"
                                                class="text-item text-ellipsis"
                                        ></app-sum-view>

                                        <p
                                                *ngIf="!item.totalBeforeMaam"
                                                class="text-item text-ellipsis"
                                        >
                                            0
                                        </p>
                                    </div>
                                </div>

                                <div
                                        *ngIf="item.taxDeductionCustId !== null"
                                        class="flex"
                                        style="justify-content: space-between"
                                >
                                    <div
                                            [ngStyle]="{
                      width: isMatah ? '170px' : '195px',
                      'min-width': isMatah ? '170px' : '195px'
                    }"
                                    >
                                        <div
                                                *ngIf="item.taxDeductionCustId !== null; else empty"
                                                class="p-dropdown"
                                        >
                                            <label class="p-dropdown-label">
                        <span
                            #spanElement
                            [pTooltip]="item.taxDeductionCustId.cartisName"
                            [tooltipDisabled]="
                            spanElement.offsetWidth >= spanElement.scrollWidth
                          "
                            style="
                            vertical-align: middle;
                            display: block;
                            white-space: nowrap;
                            overflow: hidden;
                            text-overflow: ellipsis;
                          "
                            tooltipPosition="top"
                        >{{ item.taxDeductionCustId.cartisName }}</span
                        >
                                            </label>
                                        </div>
                                    </div>
                                    <div
                                            *ngIf="!isMatah"
                                            style="align-self: stretch; width: 11px; height: auto"
                                    ></div>
                                    <div
                                            *ngIf="!isMatah"
                                            class="input disabled"
                                            style="width: 85px"
                                    >
                                        <app-sum-view
                                                *ngIf="item.paymentNikui"
                                                [sum]="item.paymentNikui"
                                                class="text-item text-ellipsis"
                                        ></app-sum-view>

                                        <p
                                                *ngIf="!item.paymentNikui"
                                                class="text-item text-ellipsis"
                                        >
                                            0
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </ng-template>

                        <ng-template #expenseTempSums>
                            <div style="position: relative; align-self: stretch">
                                <div style="overflow: hidden">
                                    <div class="input disabled" style="width: 85px">
                                        <app-sum-view
                                                *ngIf="item.totalIncludeMaam"
                                                [sum]="item.totalIncludeMaam"
                                                class="text-item text-ellipsis"
                                        ></app-sum-view>

                                        <p
                                                *ngIf="!item.totalIncludeMaam"
                                                class="text-item text-ellipsis"
                                        >
                                            0
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                        <ng-template #incomeTempSums>
                            <div>
                                <div style="overflow: hidden; margin-bottom: 10px">
                                    <div class="input disabled" style="width: 85px">
                                        <app-sum-view
                                                *ngIf="item.totalBeforeMaam"
                                                [sum]="item.totalBeforeMaam"
                                                class="text-item text-ellipsis"
                                        ></app-sum-view>

                                        <p
                                                *ngIf="!item.totalBeforeMaam"
                                                class="text-item text-ellipsis"
                                        >
                                            0
                                        </p>
                                    </div>
                                </div>
                                <div
                                        *ngIf="item.taxDeductionCustId !== null"
                                        style="overflow: hidden"
                                >
                                    <div class="input disabled" style="width: 85px">
                                        <app-sum-view
                                                *ngIf="item.paymentNikui"
                                                [sum]="item.paymentNikui"
                                                class="text-item text-ellipsis"
                                        ></app-sum-view>

                                        <p
                                                *ngIf="!item.paymentNikui"
                                                class="text-item text-ellipsis"
                                        >
                                            0
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </ng-template>

                        <ng-template #expenseMatahTemp>
                            <div style="position: relative; align-self: stretch">
                                <div class="input disabled" style="width: 85px">
                                    <app-sum-view
                                            *ngIf="item.matahAmount"
                                            [sum]="item.matahAmount"
                                            class="text-item text-ellipsis"
                                    ></app-sum-view>

                                    <p *ngIf="!item.matahAmount" class="text-item text-ellipsis">
                                        0
                                    </p>
                                </div>
                            </div>
                        </ng-template>
                        <ng-template #incomeMatahTemp>
                            <div>
                                <div style="overflow: hidden; margin-bottom: 10px">
                                    <div class="input disabled" style="width: 85px">
                                        <app-sum-view
                                                *ngIf="item.totalBeforeMaamMatah"
                                                [sum]="item.totalBeforeMaamMatah"
                                                class="text-item text-ellipsis"
                                        ></app-sum-view>

                                        <p
                                                *ngIf="!item.totalBeforeMaamMatah"
                                                class="text-item text-ellipsis"
                                        >
                                            0
                                        </p>
                                    </div>
                                </div>
                                <div style="overflow: hidden">
                                    <div class="input disabled" style="width: 85px">
                                        <app-sum-view
                                                *ngIf="item.totalMaamMatah"
                                                [sum]="item.totalMaamMatah"
                                                class="text-item text-ellipsis"
                                        ></app-sum-view>

                                        <p
                                                *ngIf="!item.totalMaamMatah"
                                                class="text-item text-ellipsis"
                                        >
                                            0
                                        </p>
                                    </div>
                                </div>
                            </div>
                        </ng-template>
                        <ng-template #empty>
                            <div>&nbsp;</div>
                        </ng-template>
                    </div>
                </ng-container>
            </div>
        </div>

        <div
                *ngIf="showDocumentListStorageDataFired"
                [style.height.px]="scrHeight - editOrderModal.container.clientHeight - 10"
                [style.top.px]="editOrderModal.container.clientHeight"
                class="showDocumentListStorageDataFired"
        >
            <div class="zoom-controls-inside">
                <button (click)="imageScaleNewInvoice = 1" mat-icon-button>
                    <mat-icon class="rotate-90">height</mat-icon>
                </button>
                <button
                        (click)="rotateInside(); $event.stopPropagation()"
                        mat-icon-button
                >
                    <mat-icon
                            style="width: 17px; height: 17px"
                            svgIcon="rotate"
                    ></mat-icon>
                </button>
                <button
                        (click)="zoomStepInside(1, 'imageScaleNewInvoice')"
                        mat-icon-button
                >
                    <mat-icon>add</mat-icon>
                </button>
                <button
                        (click)="zoomStepInside(-1, 'imageScaleNewInvoice')"
                        mat-icon-button
                >
                    <mat-icon>remove</mat-icon>
                </button>
            </div>
            <div
                    [style.height.px]="scrHeight - editOrderModal.container.clientHeight - 10"
                    class="scrollbar-dynamic scroll-chrome"
                    style="overflow: auto; background: #ffffff"
            >
                <ng-container
                        *ngIf="{ pages: (fileDetails$ | async)?.pages } as pagesNavData"
                >
                    <ng-container
                            *ngFor="let page of pagesNavData.pages; index as i; last as isLast"
                    >
                        <ng-container
                                *ngIf="(cachedContent$ | async)[i] | async as imgBlob"
                        >
                            <div>
                                <img
                                        [ngStyle]="{ transform: 'rotate(' + degRotateImg + 'deg)' }"
                                        [src]="imgBlob"
                                        [style.zoom.%]="imageScaleNewInvoice * 100"
                                        alt="pageImage"
                                        style="height: auto; width: 676px;
					  display: block; margin: 0 auto"
                                />
                            </div>
                        </ng-container>
                    </ng-container>
                </ng-container>
            </div>
        </div>

        <!--        <p-overlayPanel styleClass="beneficiarySelectionGuideDialog alertBeforeSplitOvP"-->
        <!--                        appendTo="body"-->
        <!--                        [dismissable]="true"-->
        <!--                        [style]="{'padding-top': '0'}"-->
        <!--                        (onHide)="onAlertBeforeSplitHide()"-->
        <!--                        #alertBeforeSplitOvP>-->
        <!--            <div class="p-dialog-header p-helper-clearfix p-corner-top">-->
        <!--        <span class="p-dialog-title ng-tns-c13-48 ng-star-inserted" id="p-dialog-3-label">-->
        <!--            <div> {{'guides.beneficiary.title'| translate}} </div>-->
        <!--        </span>-->
        <!--                <a role="button" class="p-dialog-header-icon p-dialog-header-close p-corner-all"-->
        <!--                   (click)="alertBeforeSplitOvP.hide()">-->
        <!--                    <span class="fa fa-fw fa-times"></span>-->
        <!--                </a>-->
        <!--            </div>-->
        <!--            <div class="p-dialog-content mat-typography">-->
        <!--                <h3 style="padding-top: 10px;margin-bottom: 10px;">לאחר הוספת פקודה מפוצלת, אין אפשרות לשנות את סך סכום-->
        <!--                    החשבונית</h3>-->
        <!--            </div>-->
        <!--            <div class="p-dialog-footer">-->
        <!--                <p-checkbox checkboxIcon="fa fa-check" [label]="'guides.beneficiary.stopDisplaying'| translate"-->
        <!--                            [(ngModel)]="alertBeforeSplit.stopIt" [binary]="true"></p-checkbox>-->
        <!--                <button class="button-dark" (click)="alertBeforeSplitOvP.hide()">-->
        <!--                    {{'guides.beneficiary.gotIt'| translate}}-->
        <!--                </button>-->
        <!--            </div>-->
        <!--        </p-overlayPanel>-->

        <p-footer>
            <button (click)="editReceiptModalShow = false" class="button-link">
                {{ 'actions.cancellation' | translate }}
            </button>
            <button
                    (click)="splitReceiptJournalTrans()"
                    [disabled]="isDisabledSplitReceiptJournalTrans() || calcProgress"
                    class="button-dark"
            >
                {{ 'actions.save' | translate }}
            </button>
        </p-footer>
    </p-dialog>
</ng-container>

<!--<ng-container *ngIf="modalEditCardsBeforeSend && !modalEditCardsBeforeSend?.fired">-->
<!--    <p-dialog (visibleChange)="aaa = false" [visible]="modalEditCardsBeforeSend && !modalEditCardsBeforeSend.fired"-->
<!--                (onHide)="modalEditCardsBeforeSend = false; fireIndexDataAfterClosePopUpFunc()"-->
<!--                appendTo="body"-->
<!--                [modal]="true"-->
<!--                [resizable]="false"-->
<!--                styleClass="modalEditCardsBeforeSend">-->
<!--        <p-header>-->
<!--            <h1>שיוך כרטיס-->
<!--                {{modalEditCardsBeforeSend?.type === 6 ? 'נגדי' : ''}}</h1>-->
<!--        </p-header>-->

<!--        <p>-->
<!--            האם ברצונך לשייך את כרטיס-->

<!--            {{modalEditCardsBeforeSend?.type === 2 ? ' ספק/ לקוח' : ' נגדי'}}-->

<!--            <strong>{{modalEditCardsBeforeSend.newVal.custId ? modalEditCardsBeforeSend.newVal.custId : ''}}</strong>-->

<!--            &lt;!&ndash;        <p style="text-align: right;margin-right: 15px;">&ndash;&gt;-->
<!--            &lt;!&ndash;            האם ברצונך לבטל את שיוך כרטיס&ndash;&gt;-->

<!--            &lt;!&ndash;            {{modalCancel.fieldId === 2 ? ' ספק/ לקוח' : ' נגדי'}}&ndash;&gt;-->

<!--            &lt;!&ndash;            <strong>&ndash;&gt;-->
<!--            &lt;!&ndash;                {{fileFieldsForm.get(modalCancel.fieldId.toString()).get('effectiveValue').value.cartisName}}&ndash;&gt;-->
<!--            &lt;!&ndash;            </strong>&ndash;&gt;-->
<!--            &lt;!&ndash;        </p>&ndash;&gt;-->
<!--            &lt;!&ndash;        <p *ngIf="companyIdentificationName" style="text-align: right;&ndash;&gt;-->
<!--            &lt;!&ndash;    margin-right: 15px;">&ndash;&gt;-->
<!--            &lt;!&ndash;            לחברה&ndash;&gt;-->
<!--            &lt;!&ndash;            <strong>&ndash;&gt;-->
<!--            &lt;!&ndash;                {{companyIdentificationName}}&ndash;&gt;-->
<!--            &lt;!&ndash;            </strong>&ndash;&gt;-->
<!--            &lt;!&ndash;        </p>&ndash;&gt;-->

<!--            &lt;!&ndash;            <strong *ngIf="modalEditCardsBeforeSend?.type === 2">ח.פ/&ndash;&gt;-->
<!--            &lt;!&ndash;                ע.מ {{modalEditCardsBeforeSend.hp}}</strong>&ndash;&gt;-->
<!--            &lt;!&ndash;            <strong *ngIf="modalEditCardsBeforeSend?.type === 2">ח.פ/&ndash;&gt;-->
<!--            &lt;!&ndash;                ע.מ {{modalEditCardsBeforeSend?.newVal?.effectiveValue?.hp}}</strong>&ndash;&gt;-->
<!--            <br>-->
<!--            &lt;!&ndash;            <strong *ngIf="modalEditCardsBeforeSend?.type === 6">&ndash;&gt;-->
<!--            &lt;!&ndash;                לכרטיס נגדי&ndash;&gt;-->

<!--            &lt;!&ndash;                {{modalEditCardsBeforeSend.newVal.custId}}&ndash;&gt;-->
<!--            &lt;!&ndash;                - {{modalEditCardsBeforeSend.newVal.lName}}&ndash;&gt;-->
<!--            &lt;!&ndash;            </strong>&ndash;&gt;-->
<!--            &lt;!&ndash;            <strong *ngIf="modalEditCardsBeforeSend?.type === 2">&ndash;&gt;-->
<!--            &lt;!&ndash;                לכרטיס&ndash;&gt;-->

<!--            &lt;!&ndash;                {{modalEditCardsBeforeSend.newVal.custId}}&ndash;&gt;-->
<!--            &lt;!&ndash;                - {{modalEditCardsBeforeSend.newVal.lName}}&ndash;&gt;-->
<!--            &lt;!&ndash;            </strong>&ndash;&gt;-->
<!--            <strong *ngIf="companyIdentificationName">-->
<!--                לחברה-->

<!--                {{companyIdentificationName}}-->
<!--            </strong>-->
<!--            <strong *ngIf="!companyIdentificationName && fileFieldsForm.get('3').get('effectiveValue').value">-->
<!--                לח.פ-->

<!--                {{fileFieldsForm.get('3').get('effectiveValue').value}}-->
<!--            </strong>-->

<!--            עבור:-->
<!--        </p>-->

<!--        <ul>-->
<!--            <li>-->
<!--                <p-radioButton name="changeOption"-->
<!--                               [label]="'חשבונית זו בלבד'"-->
<!--                               [value]="false"-->
<!--                               [(ngModel)]="modalEditCardsBeforeSend.setFieldValueForFuture"-->
<!--                               [inputId]="'setFieldValueForFuture1'"></p-radioButton>-->
<!--            </li>-->
<!--            <li>-->
<!--                <p-radioButton name="changeOption"-->
<!--                               [label]="'כל החשבוניות העתידיות (מהיום קדימה)'"-->
<!--                               [value]="true"-->
<!--                               [(ngModel)]="modalEditCardsBeforeSend.setFieldValueForFuture"-->
<!--                               [inputId]="'setFieldValueForFuture2'"></p-radioButton>-->
<!--            </li>-->
<!--        </ul>-->
<!--        <p-footer>-->
<!--            <button class="button-link" (click)="modalEditCardsBeforeSend = false; fireIndexDataAfterClosePopUpFunc()">-->
<!--                {{'actions.cancellation'| translate}}-->
<!--            </button>-->
<!--            <button class="button-dark"-->
<!--                    (click)="cardsChangeSelected()">-->
<!--                {{'actions.approve'| translate}}-->
<!--            </button>-->
<!--        </p-footer>-->
<!--    </p-dialog>-->
<!--</ng-container>-->

<ng-container
        *ngIf="modalEditCardsBeforeSend && !modalEditCardsBeforeSend?.fired"
>
    <p-dialog (onHide)="
      modalEditCardsBeforeSend = false; fireIndexDataAfterClosePopUpFunc()
    "
              (visibleChange)="modalEditCardsBeforeSend = false; fireIndexDataAfterClosePopUpFunc()"
              [modal]="true"
              [resizable]="false"
              [visible]="(
modalEditCardsBeforeSend && !modalEditCardsBeforeSend.fired
        )"
              appendTo="body"
              styleClass="modalEditCardsBeforeSendAuto"
    >
        <p-header>
            <h1>
                {{
                modalEditCardsBeforeSend?.type &&
                modalEditCardsBeforeSend?.type !== 21
                    ? 'שיוך'
                    : ''
                }}
                <ng-container [ngSwitch]="modalEditCardsBeforeSend?.type">
                    <ng-container *ngSwitchCase="2"> כרטיס ספק/לקוח</ng-container>
                    <ng-container *ngSwitchCase="6"> כרטיס נגדי</ng-container>
                    <ng-container *ngSwitchCase="30"> כרטיס קופה</ng-container>
                    <ng-container *ngSwitchCase="40"> סוג תנועה</ng-container>
                    <ng-container *ngSwitchCase="41"> סוג תנועה</ng-container>
                    <ng-container *ngSwitchCase="21"> הגדרת הוצאה/הכנסה</ng-container>
                </ng-container>
            </h1>
        </p-header>

        <ng-container
                *ngIf="
        modalEditCardsBeforeSend?.type === 2 ||
        modalEditCardsBeforeSend?.type === 6 ||
        modalEditCardsBeforeSend?.type === 30
      "
        >
            <p>
                בחרתם לשנות את

                <strong>
                    כרטיס
                    {{ modalEditCardsBeforeSend.approveUserValue }}
                </strong>

                <br/>

                <strong>
                    ל"כרטיס

                    {{
                    modalEditCardsBeforeSend.newVal.cartisName
                        ? modalEditCardsBeforeSend.newVal.cartisName
                        : ''
                    }}".
                </strong>
                <br/>
                הגדירו לנו מה לעשות -
            </p>

            <ul>
                <li>
                    <p-radioButton
                            [(ngModel)]="modalEditCardsBeforeSend.setFieldValueForFuture"
                            [inputId]="'setFieldValueForFuture1'"
                            [label]="
              'תחליפו ל״' +
              (modalEditCardsBeforeSend.newVal.lName
                ? modalEditCardsBeforeSend.newVal.lName
                : modalEditCardsBeforeSend.newVal.custId) +
              '״ רק הפעם'
            "
                            [value]="1"
                            name="changeOption"
                    ></p-radioButton>
                </li>
                <li>
                    <p-radioButton
                            [(ngModel)]="modalEditCardsBeforeSend.setFieldValueForFuture"
                            [inputId]="'setFieldValueForFuture2'"
                            [label]="
              'תשאירו תמיד את ״' +
              (modalEditCardsBeforeSend.newVal.lName
                ? modalEditCardsBeforeSend.newVal.lName
                : modalEditCardsBeforeSend.newVal.custId) +
              '״'
            "
                            [value]="2"
                            name="changeOption"
                    ></p-radioButton>
                </li>
                <li>
                    <p-radioButton
                            [(ngModel)]="modalEditCardsBeforeSend.setFieldValueForFuture"
                            [inputId]="'setFieldValueForFuture3'"
                            [label]="'תנו לי לבחור כל פעם מחדש (השדה יגיע ריק)'"
                            [value]="3"
                            name="changeOption"
                    ></p-radioButton>
                </li>
            </ul>
        </ng-container>

        <ng-container
                *ngIf="
        modalEditCardsBeforeSend?.type === 40 ||
        modalEditCardsBeforeSend?.type === 41
      "
        >
            <p
                    *ngIf="
          modalEditCardsBeforeSend?.type === 40 ||
          (modalEditCardsBeforeSend?.type === 41 &&
            modalEditCardsBeforeSend?.real_approveUserValue !== -1)
        "
            >
                בחרתם לשנות את

                <strong>
                    סוג תנועה
                    {{ modalEditCardsBeforeSend.approveUserValue }}
                </strong>

                <br/>

                <strong>
                    ל"סוג תנועה

                    {{
                    modalEditCardsBeforeSend.newValText
                        ? modalEditCardsBeforeSend.newValText
                        : ''
                    }}".
                </strong>
                <br/>

                הגדירו לנו מה לעשות -
            </p>
            <p
                    *ngIf="
          modalEditCardsBeforeSend?.type === 41 &&
          modalEditCardsBeforeSend?.real_approveUserValue === -1
        "
            >
                בחרתם לשנות

                <strong>
                    ל"סוג תנועה

                    {{
                    modalEditCardsBeforeSend.newValText
                        ? modalEditCardsBeforeSend.newValText
                        : ''
                    }}".
                </strong>
                <br/>

                הגדירו לנו מה לעשות -
            </p>
            <ul>
                <li>
                    <p-radioButton
                            [(ngModel)]="modalEditCardsBeforeSend.setFieldValueForFuture"
                            [inputId]="'setFieldValueForFuture1'"
                            [label]="
              'תחליפו ל״' + modalEditCardsBeforeSend.dataText + '״ רק הפעם'
            "
                            [value]="1"
                            name="changeOption"
                    ></p-radioButton>
                </li>
                <li>
                    <p-radioButton
                            [(ngModel)]="modalEditCardsBeforeSend.setFieldValueForFuture"
                            [inputId]="'setFieldValueForFuture2'"
                            [label]="
              'תשאירו תמיד את ״' + modalEditCardsBeforeSend.dataText + '״'
            "
                            [value]="2"
                            name="changeOption"
                    ></p-radioButton>
                </li>
                <li>
                    <p-radioButton
                            [(ngModel)]="modalEditCardsBeforeSend.setFieldValueForFuture"
                            [inputId]="'setFieldValueForFuture3'"
                            [label]="'תנו לי לבחור כל פעם מחדש (השדה יגיע ריק)'"
                            [value]="3"
                            name="changeOption"
                    ></p-radioButton>
                </li>
            </ul>
        </ng-container>

        <ng-container *ngIf="modalEditCardsBeforeSend?.type === 21">
            <p>
                <strong>
                    בחרתם לשנות את החשבונית ל"{{
                    modalEditCardsBeforeSend.newValText === 0 ? 'הכנסה' : 'הוצאה'
                    }}", הגדירו לנו מה לעשות -
                </strong>
            </p>
            <ul>
                <li>
                    <p-radioButton
                            [(ngModel)]="modalEditCardsBeforeSend.setFieldValueForFuture"
                            [inputId]="'setFieldValueForFuture1'"
                            [label]="
              'תחליפו ל״' +
              (modalEditCardsBeforeSend.dataText === 0 ? 'הכנסה' : 'הוצאה') +
              '״ רק הפעם'
            "
                            [value]="1"
                            name="changeOption"
                    ></p-radioButton>
                </li>
                <li>
                    <p-radioButton
                            [(ngModel)]="modalEditCardsBeforeSend.setFieldValueForFuture"
                            [inputId]="'setFieldValueForFuture2'"
                            [label]="
              'תשאירו תמיד את ״' +
              (modalEditCardsBeforeSend.dataText === 0 ? 'הכנסה' : 'הוצאה') +
              '״'
            "
                            [value]="2"
                            name="changeOption"
                    ></p-radioButton>
                </li>
                <li>
                    <p-radioButton
                            [(ngModel)]="modalEditCardsBeforeSend.setFieldValueForFuture"
                            [inputId]="'setFieldValueForFuture3'"
                            [label]="'תנו לי לבחור כל פעם מחדש (השדה יגיע ריק)'"
                            [value]="3"
                            name="changeOption"
                    ></p-radioButton>
                </li>
            </ul>
        </ng-container>

        <p-footer>
            <button
                    (click)="
          modalEditCardsBeforeSend = false; fireIndexDataAfterClosePopUpFunc()
        "
                    class="button-link"
            >
                {{ 'actions.cancellation' | translate }}
            </button>
            <button
                    (click)="cardsChangeSelected()"
                    class="button-dark"
                    style="width: 121px; height: 33px !important; padding: 0"
            >
                {{ 'actions.approve' | translate }}
            </button>
        </p-footer>
    </p-dialog>
</ng-container>

<ng-container *ngIf="editOrderFromDoubleSuspectModalShow">
    <p-dialog (onHide)="editOrderFromDoubleSuspectModalShow = false"
              (visibleChange)="editOrderFromDoubleSuspectModalShow = false"

              [closeOnEscape]="true"
              [closeOut]="true"
              [dismissableMask]="true"
              [draggable]="false"
              [modal]="true"
              [resizable]="false"
              [visible]="(
editOrderFromDoubleSuspectModalShow
        )"
              appendTo="body"
              styleClass="orderHistoryInvoiceModal"
    >
        <div #headerInvoiceModal class="wrapperTable">
            <div class="header">
                {{ 'פקודה קיימת בהנה״ח' }}

                {{
                getJournalHistory &&
                getJournalHistory.length &&
                getJournalHistory[0].batchNum
                    ? ' - מס׳ מנה ' + getJournalHistory[0].batchNum
                    : ''
                }}

                {{
                getJournalHistory &&
                getJournalHistory.length &&
                getJournalHistory[0].misparTnua
                    ? (!getJournalHistory[0].batchNum ? '-' : '') +
                    (' מס׳ פקודה ' + getJournalHistory[0].misparTnua)
                    : ''
                }}
            </div>

            <div class="table">
                <div class="header">
                    <div>תאריך</div>
                    <div class="border"></div>
                    <div>
                        {{ fileFieldsForm.get('40') ? 'ס.תנועה' : 'אחוז מע"מ' }}
                    </div>
                    <div class="border"></div>
                    <div>חובה</div>
                    <div class="border"></div>
                    <div>זכות</div>
                    <div class="border"></div>
                    <div>פרטים נוספים</div>
                </div>
                <div class="scroll-chrome scrollbar-dynamic" style="max-height: 327px">
                    <ng-template #loader>
                        <div style="height: 84px">
                            <div class="loaderPercent">
                                <div class="circle"></div>
                            </div>
                        </div>
                    </ng-template>
                    <ng-container *ngIf="getJournalHistory; else loader">
                        <div
                                *ngFor="let item of getJournalHistory; let i = index"
                                class="row"
                        >
                            <div>
                                <div class="date flex" style="margin-bottom: 10px">
                                    <p>תאריך:</p>

                                    <div style="width: 85px">
                                        {{ item.referenceDate | date: 'dd/MM/yy' }}
                                    </div>
                                </div>
                            </div>
                            <div class="border"></div>
                            <div>
                                <ng-container *ngIf="fileFieldsForm.get('40')">
                                    <div *ngIf="item.transTypeCode; else empty">
                                        {{ item.transTypeCode }}
                                    </div>
                                </ng-container>

                                <ng-container *ngIf="!fileFieldsForm.get('40')">
                                    <div *ngIf="item.maamPrc; else empty">
                                        <p-dropdown
                                            #formDropdowns
                                            [(ngModel)]="item.maamPrc"
                                            [autoDisplayFirst]="false"
                                            [disabled]="true"
                                            [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                            [options]="item.expense ? vatOptions : vatOptionsIncome"
                                            [style]="{ width: '100%' }"
                                            appendTo="body"
                                            placeholder="בחירה"
                                        ></p-dropdown>
                                    </div>
                                </ng-container>
                            </div>
                            <div class="border"></div>
                            <ng-container
                                    *ngTemplateOutlet="item.expense ? expenseTemp : incomeTemp"
                            >
                            </ng-container>
                            <div class="border"></div>
                            <ng-container
                                    *ngTemplateOutlet="item.expense ? incomeTemp : expenseTemp"
                            >
                            </ng-container>
                            <div class="border"></div>
                            <div style="position: relative">
                                <div class="flex" style="margin-bottom: 10px">
                                    <p style="width: 64px">אסמכתא</p>
                                    <div style="width: 65px; margin-left: 20px">
                                        <input
                                                [(ngModel)]="item.asmachta1"
                                                appNumbersOnly="positive"
                                                autocomplete="off"
                                                class="input-show"
                                                disabled
                                                readonly
                                        />
                                    </div>
                                    <p style="width: 40px">מנה</p>
                                    <div style="width: 65px">
                                        <input
                                                [(ngModel)]="item.batchNum"
                                                autocomplete="off"
                                                class="input-show"
                                                disabled
                                                readonly
                                        />
                                    </div>
                                </div>
                                <div class="flex" style="margin-bottom: 10px">
                                    <p style="width: 64px">אסמכ. 2</p>
                                    <div style="width: 65px; margin-left: 20px">
                                        <input
                                                [(ngModel)]="item.asmachta2"
                                                appNumbersOnly="positive"
                                                autocomplete="off"
                                                class="input-show"
                                                disabled
                                                readonly
                                        />
                                    </div>
                                    <p style="width: 40px">פקודה</p>
                                    <div style="width: 65px">
                                        <input
                                                [(ngModel)]="item.misparTnua"
                                                autocomplete="off"
                                                class="input-show"
                                                disabled
                                                readonly
                                        />
                                    </div>
                                </div>
                                <div class="flex">
                                    <p style="width: 64px">פרטים</p>
                                    <div style="max-width: 200px">
                                        <input
                                            #inputElement
                                            [(ngModel)]="item.details"
                                            [pTooltip]="item.details"
                                            [tooltipDisabled]="
                        inputElement.offsetWidth >= inputElement.scrollWidth
                      "
                                            autocomplete="off"
                                            class="input-show text-ellipsis"
                                            disabled
                                            readonly
                                            tooltipPosition="top"
                                        />
                                    </div>
                                </div>
                            </div>
                            <ng-template #expenseTemp>
                                <div>
                                    <div
                                            class="flex"
                                            style="margin-bottom: 10px; justify-content: space-between"
                                    >
                                        <div style="width: 195px; min-width: 195px">
                                            <div
                                                    *ngIf="item.custData; else empty"
                                                    class="p-dropdown"
                                            >
                                                <label class="p-dropdown-label">
                          <span
                              #spanElement
                              [pTooltip]="item.custData.cartisName"
                              [tooltipDisabled]="
                              spanElement.offsetWidth >= spanElement.scrollWidth
                            "
                              style="
                              vertical-align: middle;
                              display: block;
                              white-space: nowrap;
                              overflow: hidden;
                              text-overflow: ellipsis;
                            "
                              tooltipPosition="top"
                          >{{ item.custData.cartisName }}</span
                          >
                                                </label>
                                            </div>
                                        </div>
                                        <div
                                                style="align-self: stretch; width: 11px; height: auto"
                                        ></div>
                                        <div class="input disabled" style="width: 85px">
                                            <app-sum-view
                                                    *ngIf="item.totalBeforeMaam"
                                                    [sum]="item.totalBeforeMaam"
                                                    class="text-item text-ellipsis"
                                            ></app-sum-view>

                                            <p
                                                    *ngIf="!item.totalBeforeMaam"
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>
                                        </div>
                                    </div>
                                    <div
                                            *ngIf="item.maamPrc !== 'NONE' && item.totalMaam !== null"
                                            class="flex"
                                            style="justify-content: space-between"
                                    >
                                        <div style="width: 195px; min-width: 195px">
                                            <ng-container [ngSwitch]="item.maamPrc">
                                                <ng-container *ngSwitchCase="'OPEN'">
                                                    <div
                                                            *ngIf="item.cartisMaam; else empty"
                                                            class="p-dropdown"
                                                    >
                                                        <label class="p-dropdown-label">
                              <span
                                  #spanElement
                                  [pTooltip]="item.cartisMaam.cartisName"
                                  [tooltipDisabled]="
                                  spanElement.offsetWidth >=
                                  spanElement.scrollWidth
                                "
                                  style="
                                  vertical-align: middle;
                                  display: block;
                                  white-space: nowrap;
                                  overflow: hidden;
                                  text-overflow: ellipsis;
                                "
                                  tooltipPosition="top"
                              >{{ item.cartisMaam.cartisName }}</span
                              >
                                                        </label>
                                                    </div>
                                                </ng-container>
                                                <ng-container *ngSwitchDefault>
                                                    <p *ngIf="item.cartisMaam; else empty">
                                                        {{ item.cartisMaam.cartisName }}
                                                    </p>
                                                </ng-container>
                                            </ng-container>
                                        </div>

                                        <div
                                                style="align-self: stretch; width: 11px; height: auto"
                                        ></div>
                                        <div class="input disabled" style="width: 85px">
                                            <app-sum-view
                                                    *ngIf="item.totalMaam"
                                                    [sum]="item.totalMaam"
                                                    class="text-item text-ellipsis"
                                            ></app-sum-view>

                                            <p
                                                    *ngIf="!item.totalMaam"
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>
                                        </div>
                                    </div>
                                </div>
                            </ng-template>
                            <ng-template #incomeTemp>
                                <div class="flex">
                                    <div style="width: 195px; min-width: 195px">
                                        <div *ngIf="item.custId; else empty" class="p-dropdown">
                                            <label class="p-dropdown-label">
                        <span
                            #spanElement
                            [pTooltip]="item.custId.cartisName"
                            [tooltipDisabled]="
                            spanElement.offsetWidth >= spanElement.scrollWidth
                          "
                            style="
                            vertical-align: middle;
                            display: block;
                            white-space: nowrap;
                            overflow: hidden;
                            text-overflow: ellipsis;
                          "
                            tooltipPosition="top"
                        >{{ item.custId.cartisName }}</span
                        >
                                            </label>
                                        </div>
                                    </div>

                                    <div
                                            style="align-self: stretch; width: 11px; height: auto"
                                    ></div>
                                    <div class="input disabled" style="width: 85px">
                                        <app-sum-view
                                                *ngIf="item.totalIncludeMaam"
                                                [sum]="item.totalIncludeMaam"
                                                class="text-item text-ellipsis"
                                        ></app-sum-view>

                                        <p
                                                *ngIf="!item.totalIncludeMaam"
                                                class="text-item text-ellipsis"
                                        >
                                            0
                                        </p>
                                    </div>
                                </div>
                            </ng-template>

                            <ng-template #empty>
                                <div>&nbsp;</div>
                            </ng-template>
                        </div>
                    </ng-container>
                </div>
            </div>
        </div>

        <div [style.top.px]="headerInvoiceModal.offsetHeight" class="invoice-page">
            <ng-container
                    *ngIf="{
          currentPage: (currentInsideModalPage | async),
          pages: (fileDetails$ | async)?.pages
        } as pagesNavData"
            >
                <div class="header" style="position: relative">
                    <div *ngIf="pagesNavData.pages?.length" class="pages-navigator">
                        <label style="padding-left: 5px"><b>דף:</b></label>
                        <label class="forceLTR" style="padding-left: 7px"
                        ><b>{{ pagesNavData.currentPage }}</b
                        >/{{ pagesNavData.pages.length }}
                        </label>
                        <button
                                (click)="
                navigateToDocumentPageInsideModal2(pagesNavData.currentPage + 1)
              "
                                [disabled]="pagesNavData.currentPage >= pagesNavData.pages.length"
                                mat-icon-button
                        >
                            <mat-icon>expand_more</mat-icon>
                        </button>
                        <button
                                (click)="
                navigateToDocumentPageInsideModal2(pagesNavData.currentPage - 1)
              "
                                [disabled]="pagesNavData.currentPage < 2"
                                mat-icon-button
                        >
                            <mat-icon>expand_less</mat-icon>
                        </button>
                    </div>

                    <div class="btnGr">
                        <div
                                style="top: 3px; cursor: auto; position: relative; left: 100px"
                        >
                            <img
                                    src="/assets/images/doubleSuspect.png"
                                    style="height: 30px"
                            />
                        </div>
                        <div style="align-self: center">
                            <mat-icon
                                    (click)="
                  docFoldersShow.emit({
                    companyId:
                      userService.appData?.userData?.companySelect?.companyId,
                    fileId: _fileScanView?.fileId
                  })
                "
                                    pTooltip="העברה לארכיון"
                                    style="
                  height: 18px;
                  vertical-align: middle;
                  color: #022258;
                  cursor: pointer;
                "
                                    svgIcon="bizibox_archive"
                                    tooltipPosition="top"
                            ></mat-icon>
                        </div>
                        <div style="align-self: center">
                            <mat-icon
                                    (click)="deleteInvoiceModal = 'fileId'"
                                    pTooltip="מחיקת חשבונית"
                                    style="
                  height: 18px;
                  vertical-align: middle;
                  color: #022258;
                  cursor: pointer;
                "
                                    svgIcon="trash"
                                    tooltipPosition="top"
                            ></mat-icon>
                        </div>
                    </div>
                </div>
                <div
                        (scroll)="setPageNumInsideModal2($event)"
                        [style.height.px]="scrHeight - headerInvoiceModal.offsetHeight - 50"
                        style="
            position: relative;
            max-height: 755px;
            background: #ffffff;
            overflow: auto;
          "
                >
                    <div class="zoom-controls-inside">
                        <button
                                (click)="zoomStepInside(1, 'imageScaleNewInvoice')"
                                mat-icon-button
                        >
                            <mat-icon>add</mat-icon>
                        </button>
                        <button
                                (click)="zoomStepInside(-1, 'imageScaleNewInvoice')"
                                mat-icon-button
                        >
                            <mat-icon>remove</mat-icon>
                        </button>
                    </div>
                    <div class="scrollbar-dynamic scroll-chrome">
                        <div
                            #pageContainerInsideModal2
                            *ngFor="
                let page of pagesNavData.pages;
                index as i;
                last as isLast
              "
                            [id]="page?.id"
                            class="pages"
                        >
                            <ng-container
                                    *ngIf="(cachedContent$ | async)[i] | async as imgBlob"
                            >
                                <img
                                        [src]="imgBlob"
                                        [style.zoom.%]="imageScaleNewInvoice * 100"

                                        style="height: auto; width: 522px;
					  display: block; margin: 0 auto"
                                />
                            </ng-container>
                        </div>
                    </div>
                </div>
            </ng-container>
        </div>
    </p-dialog>
</ng-container>

<ng-container *ngIf="modalShowImg">
    <p-dialog (onHide)="modalShowImg = false"
              (visibleChange)="modalShowImg = false"
              [closeOnEscape]="true"
              [dismissableMask]="true"
              [draggable]="false"
              [modal]="true"
              [resizable]="false"
              [visible]="(
modalShowImg
        )"
              appendTo="body"
              styleClass="modalShowImg"
    >
        <div #oldInvoice class="invoice-page">
            <ng-container
                    *ngIf="{
          currentPage: (currentInsideModalPage | async),
          pages: (fileDetails$ | async)?.pages
        } as pagesNavData"
            >
                <div class="header" style="position: relative">
                    <div *ngIf="pagesNavData.pages?.length" class="pages-navigator">
                        <label style="padding-left: 5px"><b>דף:</b></label>
                        <label class="forceLTR" style="padding-left: 7px"
                        ><b>{{ pagesNavData.currentPage }}</b
                        >/{{ pagesNavData.pages.length }}
                        </label>
                        <button
                                (click)="
                navigateToDocumentPageInsideModal(pagesNavData.currentPage + 1)
              "
                                [disabled]="pagesNavData.currentPage >= pagesNavData.pages.length"
                                mat-icon-button
                        >
                            <mat-icon>expand_more</mat-icon>
                        </button>
                        <button
                                (click)="
                navigateToDocumentPageInsideModal(pagesNavData.currentPage - 1)
              "
                                [disabled]="pagesNavData.currentPage < 2"
                                mat-icon-button
                        >
                            <mat-icon>expand_less</mat-icon>
                        </button>
                    </div>

                    <div class="btnGr">
                        <div
                                style="top: 3px; cursor: auto; position: relative; left: 100px"
                        >
                            <img
                                    src="/assets/images/doubleSuspect.png"
                                    style="height: 30px"
                            />
                        </div>
                        <!-- 						<div style="align-self: center"> -->
                        <!-- 							<mat-icon -->
                        <!-- 									(click)="prepareFiles(); mergeFiles = true" -->
                        <!-- 									pTooltip="איחוד שני המסמכים" -->
                        <!-- 									style=" -->
                        <!--                   height: 18px; -->
                        <!--                   vertical-align: middle; -->
                        <!--                   color: #022258; -->
                        <!--                   cursor: pointer; -->
                        <!--                 " -->
                        <!-- 									svgIcon="document" -->
                        <!-- 									tooltipPosition="top" -->
                        <!-- 							></mat-icon> -->
                        <!-- 						</div> -->
                        <div style="align-self: center">
                            <mat-icon
                                    (click)="
                  docFoldersShow.emit({
                    companyId:
                      userService.appData?.userData?.companySelect?.companyId,
                    fileId: _fileScanView?.fileId,
                    positionLeft:
                      oldInvoice.offsetLeft + oldInvoice.offsetWidth / 2 + 177
                  })
                "
                                    pTooltip="העברה לארכיון"
                                    style="
                  height: 18px;
                  vertical-align: middle;
                  color: #022258;
                  cursor: pointer;
                "
                                    svgIcon="bizibox_archive"
                                    tooltipPosition="top"
                            ></mat-icon>
                        </div>
                        <div style="align-self: center">
                            <mat-icon
                                    (click)="
                  positionLeftDeleteInvoiceModal =
                    oldInvoice.offsetLeft + oldInvoice.offsetWidth / 2 + 169;
                  deleteInvoiceModal = 'fileId'
                "
                                    pTooltip="מחיקת חשבונית"
                                    style="
                  height: 18px;
                  vertical-align: middle;
                  color: #022258;
                  cursor: pointer;
                "
                                    svgIcon="trash"
                                    tooltipPosition="top"
                            ></mat-icon>
                        </div>
                    </div>
                </div>
                <div
                        style="
            position: relative;
            max-height: 755px;
            height: 755px;
            background: #ffffff;
            overflow: hidden;
          "
                >
                    <div class="zoom-controls-inside zoom-mergeFiles">
                        <button
                                (click)="zoomStepInside(1, 'imageScaleOldInvoice')"
                                [ngStyle]="{ opacity: imageScaleOldInvoice >= 1.5 ? 0.4 : 1 }"
                                mat-icon-button
                        >
                            <mat-icon>add</mat-icon>
                        </button>
                        <button
                                (click)="zoomStepInside(-1, 'imageScaleOldInvoice')"
                                [ngStyle]="{ opacity: imageScaleOldInvoice <= 0.25 ? 0.4 : 1 }"
                                mat-icon-button
                        >
                            <mat-icon>remove</mat-icon>
                        </button>
                    </div>
                    <div
                            (scroll)="setPageNumInsideModal($event)"
                            class="scrollbar-dynamic scroll-chrome"
                            style="
              height: auto;
              overflow-y: auto;
              direction: rtl;
              margin-bottom: 0px;
              margin-left: 0px;
              max-height: 755px;
            "
                    >
                        <div
                            #pageContainerInsideModal
                            *ngFor="
                let page of pagesNavData.pages;
                index as i;
                last as isLast
              "
                            [id]="'page' + i"
                            class="pages"
                        >
                            <ng-container
                                    *ngIf="(cachedContent$ | async)[i] | async as imgBlob"
                            >
                                <img
                                        [src]="imgBlob"
                                        [style.zoom.%]="imageScaleOldInvoice * 100"

                                        style="height: auto; width: 522px;
					  display: block; margin: 0 auto"
                                />
                            </ng-container>
                        </div>
                    </div>
                </div>
            </ng-container>
        </div>
        <img (click)="prepareFiles(); mergeFiles = true"
             pTooltip="איחוד שני המסמכים"
             src="/assets/images/mergeFiles.png"
             style="height: auto;width: auto;position: absolute;left: 50%;margin-left: -54px;z-index: 99;cursor: pointer;top: 50%;margin-top: -54px;"
             tooltipPosition="top"/>
        <div #newInvoice class="invoice-page">
            <div class="header" style="position: relative">
                <div *ngIf="arrPagesImgInvoice.length" class="pages-navigator">
                    <label style="padding-left: 5px"><b>דף:</b></label>
                    <label class="forceLTR" style="padding-left: 7px"
                    ><b>{{ currentInsideModalPageNew.getValue() }}</b
                    >/{{ arrPagesImgInvoice.length }}
                    </label>
                    <button
                            (click)="
              navigateToDocumentPageInsideModalNew(
                currentInsideModalPageNew.getValue() + 1
              )
            "
                            [disabled]="
              currentInsideModalPageNew.getValue() >= arrPagesImgInvoice.length
            "
                            mat-icon-button
                    >
                        <mat-icon>expand_more</mat-icon>
                    </button>
                    <button
                            (click)="
              navigateToDocumentPageInsideModalNew(
                currentInsideModalPageNew.getValue() - 1
              )
            "
                            [disabled]="currentInsideModalPageNew.getValue() < 2"
                            mat-icon-button
                    >
                        <mat-icon>expand_less</mat-icon>
                    </button>
                </div>

                <ng-container
                        *ngIf="
            modalShowImg.invoice === true &&
              modalShowImg.status === 'WAIT_FOR_CONFIRM';
            else clickStatus
          "
                >
                    <p style="color: #022258; cursor: default">
                        החשבונית נמצאת בסטטוס
                        {{
                        '"' + ('file-statuses.' + modalShowImg.status | translate) + '"'
                        }}
                    </p>
                </ng-container>
                <ng-template #clickStatus>
                    <p
                            (click)="
              (modalShowImg.status !== 'TEMP_COMMAND' &&
                modalShowImg.status !== 'PERMANENT_COMMAND') ||
              modalShowImg.status === 'CREATE_JOURNAL_TRANS'
                ? returnToRow(
                    modalShowImg.invoice === true &&
                      modalShowImg.status === 'CREATE_JOURNAL_TRANS'
                  )
                : (showInvoiceHistory = true)
            ">
                        החשבונית נמצאת בסטטוס

                        {{
                        modalShowImg.invoice === true &&
                        modalShowImg.status === 'CREATE_JOURNAL_TRANS'
                            ? '"' + ('file-statuses.CREATE_HASH_BANK' | translate) + '"'
                            : '"' +
                            ('file-statuses.' + modalShowImg.status | translate) +
                            '"'
                        }}
                    </p>
                </ng-template>
                <div class="btnGr">
                    <!-- 					<div style="align-self: center"> -->
                    <!-- 						<mat-icon -->
                    <!-- 								(click)="prepareFiles(); mergeFiles = true" -->
                    <!-- 								pTooltip="איחוד שני המסמכים" -->
                    <!-- 								tooltipPosition="top" -->
                    <!-- 								style=" -->
                    <!--                 height: 18px; -->
                    <!--                 vertical-align: middle; -->
                    <!--                 color: #022258; -->
                    <!--                 cursor: pointer; -->
                    <!--               " -->
                    <!-- 								svgIcon="document" -->
                    <!-- 				 -->
                    <!-- 						></mat-icon> -->
                    <!-- 					</div> -->
                    <div
                            *ngIf="
              modalShowImg.status !== 'TEMP_COMMAND' &&
              modalShowImg.status !== 'PERMANENT_COMMAND'
            "
                            style="align-self: center"
                    >
                        <mat-icon
                                (click)="
                docFoldersShow.emit({
                  companyId:
                    userService.appData?.userData?.companySelect?.companyId,
                  fileId: modalShowImg?.suspiciousId,
                  positionLeft:
                    newInvoice.offsetLeft + newInvoice.offsetWidth / 2 + 177
                })
              "
                                pTooltip="העברה לארכיון"
                                style="
                height: 18px;
                vertical-align: middle;
                color: #022258;
                cursor: pointer;
              "
                                svgIcon="bizibox_archive"
                                tooltipPosition="top"
                        ></mat-icon>
                    </div>
                    <div
                            *ngIf="
              modalShowImg.status !== 'CREATE_JOURNAL_TRANS' &&
              modalShowImg.status !== 'TEMP_COMMAND' &&
              modalShowImg.status !== 'PERMANENT_COMMAND'
            "
                            style="align-self: center"
                    >
                        <mat-icon
                                (click)="
                positionLeftDeleteInvoiceModal =
                  newInvoice.offsetLeft + newInvoice.offsetWidth / 2 + 169;
                deleteInvoiceModal = 'suspiciousId'
              "
                                pTooltip="מחיקת חשבונית"
                                style="
                height: 18px;
                vertical-align: middle;
                color: #022258;
                cursor: pointer;
              "
                                svgIcon="trash"
                                tooltipPosition="top"
                        ></mat-icon>
                    </div>
                </div>
            </div>

            <div
                    style="
          position: relative;
          max-height: 755px;
          height: 755px;
          background: #ffffff;
          overflow: hidden;
        "
            >
                <div class="zoom-controls-inside zoom-mergeFiles">
                    <button
                            (click)="zoomStepInside(1, 'imageScaleNewInvoice')"
                            mat-icon-button
                    >
                        <mat-icon>add</mat-icon>
                    </button>
                    <button
                            (click)="zoomStepInside(-1, 'imageScaleNewInvoice')"
                            mat-icon-button
                    >
                        <mat-icon>remove</mat-icon>
                    </button>
                </div>
                <div
                        (scroll)="setPageNumInsideModalNew($event)"
                        class="scrollbar-dynamic scroll-chrome"
                        style="
            height: auto;
            overflow-y: auto;
            direction: rtl;
            margin-bottom: 0px;
            margin-left: 0px;
            max-height: 755px;
          "
                >
                    <div
                        #pageContainerInsideModalNew
                        *ngFor="let page of arrPagesImgInvoice; index as i; last as isLast"
                        [id]="'page1' + i"
                        class="pages"
                    >
                        <ng-container *ngIf="!finishedLoadedImgView">
                            <div class="loader">
                                <div class="circle"></div>
                            </div>
                        </ng-container>
                        <img
                                (load)="finishedLoadedImgView = true"
                                (loadstart)="finishedLoadedImgView = false"
                                [hidden]="!finishedLoadedImgView"
                                [src]="page.contentUrl"
                                [style.zoom.%]="imageScaleNewInvoice * 100"
                                style="height: auto; width: 522px; position: relative;
					  display: block; margin: 0 auto"
                        />
                    </div>
                </div>
            </div>
            <div *ngIf="showInvoiceHistory" class="wrapperTable">
                <div class="header">
                    {{ 'פקודה קיימת בהנה״ח' }}

                    <a (click)="showInvoiceHistory = false" href="#" role="button">
                        <mat-icon
                                style="color: #022258; height: 15px; width: 15px"
                                svgIcon="closeIcon"
                        ></mat-icon>
                    </a>
                </div>

                <div class="table">
                    <div class="header">
                        <div>תאריך</div>
                        <div class="border"></div>
                        <div>אחוז מע"מ</div>
                        <div class="border"></div>
                        <div>חובה</div>
                        <div class="border"></div>
                        <div>זכות</div>
                        <div class="border"></div>
                        <div>פרטים נוספים</div>
                    </div>
                    <div
                            [appScrollHeight]="0"
                            appendTo="parent"
                            class="scroll-chrome scrollbar-dynamic"
                    >
                        <ng-template #loader>
                            <div style="height: 84px">
                                <div class="loaderPercent">
                                    <div class="circle"></div>
                                </div>
                            </div>
                        </ng-template>
                        <ng-container *ngIf="getJournalHistory; else loader">
                            <div
                                    *ngFor="let item of getJournalHistory; let i = index"
                                    class="row"
                            >
                                <div>
                                    <div class="date flex" style="margin-bottom: 10px">
                                        <p>תאריך:</p>

                                        <div style="width: 85px">
                                            {{ item.referenceDate | date: 'dd/MM/yy' }}
                                        </div>
                                    </div>
                                </div>
                                <div class="border"></div>
                                <div>
                                    <div *ngIf="item.maamPrc; else empty">
                                        <p-dropdown
                                            #formDropdowns
                                            [(ngModel)]="item.maamPrc"
                                            [autoDisplayFirst]="false"
                                            [disabled]="true"
                                            [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                            [options]="
                        fileFieldsForm.get('21')?.get('effectiveValue')
                          .value === 1
                          ? vatOptions
                          : vatOptionsIncome
                      "
                                            [style]="{ width: '100%' }"
                                            appendTo="body"
                                            placeholder="בחירה"
                                        ></p-dropdown>
                                    </div>
                                </div>
                                <div class="border"></div>
                                <ng-container
                                        *ngTemplateOutlet="
                    fileFieldsForm.get('21')?.get('effectiveValue').value === 1
                      ? expenseTemp
                      : incomeTemp
                  "
                                >
                                </ng-container>
                                <div class="border"></div>
                                <ng-container
                                        *ngTemplateOutlet="
                    fileFieldsForm.get('21')?.get('effectiveValue').value === 1
                      ? incomeTemp
                      : expenseTemp
                  "
                                >
                                </ng-container>
                                <div class="border"></div>
                                <div style="position: relative">
                                    <div class="flex" style="margin-bottom: 10px">
                                        <p style="width: 64px">אסמכתא</p>
                                        <div style="width: 65px; margin-left: 20px">
                                            <input
                                                    [(ngModel)]="item.asmachta1"
                                                    appNumbersOnly="positive"
                                                    autocomplete="off"
                                                    class="input-show"
                                                    disabled
                                                    readonly
                                            />
                                        </div>
                                    </div>
                                    <div
                                            *ngIf="item.asmachta2"
                                            class="flex"
                                            style="margin-bottom: 10px"
                                    >
                                        <p style="width: 64px">אסמכ. 2</p>
                                        <div style="width: 65px; margin-left: 20px">
                                            <input
                                                    [(ngModel)]="item.asmachta2"
                                                    appNumbersOnly="positive"
                                                    autocomplete="off"
                                                    class="input-show"
                                                    disabled
                                                    readonly
                                            />
                                        </div>
                                    </div>
                                    <div class="flex">
                                        <p style="width: 64px">פרטים</p>
                                        <div style="max-width: 200px">
                                            <input
                                                #inputElement
                                                [(ngModel)]="item.details"
                                                [pTooltip]="item.details"
                                                [tooltipDisabled]="
                          inputElement.offsetWidth >= inputElement.scrollWidth
                        "
                                                autocomplete="off"
                                                class="input-show text-ellipsis"
                                                disabled
                                                readonly
                                                tooltipPosition="top"
                                            />
                                        </div>
                                    </div>
                                </div>
                                <ng-template #expenseTemp>
                                    <div>
                                        <div
                                                class="flex"
                                                style="
                        margin-bottom: 10px;
                        justify-content: space-between;
                      "
                                        >
                                            <div style="width: 195px; min-width: 195px">
                                                <div
                                                        *ngIf="item.custData; else empty"
                                                        class="p-dropdown"
                                                >
                                                    <label class="p-dropdown-label">
                            <span
                                #spanElement
                                [pTooltip]="item.custData.cartisName"
                                [tooltipDisabled]="
                                spanElement.offsetWidth >=
                                spanElement.scrollWidth
                              "
                                style="
                                vertical-align: middle;
                                display: block;
                                white-space: nowrap;
                                overflow: hidden;
                                text-overflow: ellipsis;
                              "
                                tooltipPosition="top"
                            >{{ item.custData.cartisName }}</span
                            >
                                                    </label>
                                                </div>
                                            </div>
                                            <div
                                                    style="align-self: stretch; width: 11px; height: auto"
                                            ></div>
                                            <div class="input disabled" style="width: 85px">
                                                <app-sum-view
                                                        *ngIf="item.totalBeforeMaam"
                                                        [sum]="item.totalBeforeMaam"
                                                        class="text-item text-ellipsis"
                                                ></app-sum-view>

                                                <p
                                                        *ngIf="!item.totalBeforeMaam"
                                                        class="text-item text-ellipsis"
                                                >
                                                    0
                                                </p>
                                            </div>
                                        </div>
                                        <div
                                                *ngIf="item.maamPrc !== 'NONE'"
                                                class="flex"
                                                style="justify-content: space-between"
                                        >
                                            <div style="width: 195px; min-width: 195px">
                                                <ng-container [ngSwitch]="item.maamPrc">
                                                    <ng-container *ngSwitchCase="'OPEN'">
                                                        <div
                                                                *ngIf="item.cartisMaam; else empty"
                                                                class="p-dropdown"
                                                        >
                                                            <label class="p-dropdown-label">
                                <span
                                    #spanElement
                                    [pTooltip]="item.cartisMaam.cartisName"
                                    [tooltipDisabled]="
                                    spanElement.offsetWidth >=
                                    spanElement.scrollWidth
                                  "
                                    style="
                                    vertical-align: middle;
                                    display: block;
                                    white-space: nowrap;
                                    overflow: hidden;
                                    text-overflow: ellipsis;
                                  "
                                    tooltipPosition="top"
                                >{{ item.cartisMaam.cartisName }}</span
                                >
                                                            </label>
                                                        </div>
                                                    </ng-container>
                                                    <ng-container *ngSwitchDefault>
                                                        <p *ngIf="item.cartisMaam; else empty">
                                                            {{
                                                            item.cartisMaam
                                                                ? item.cartisMaam.cartisName
                                                                : ''
                                                            }}
                                                        </p>
                                                    </ng-container>
                                                </ng-container>
                                            </div>

                                            <div
                                                    style="align-self: stretch; width: 11px; height: auto"
                                            ></div>
                                            <div class="input disabled" style="width: 85px">
                                                <app-sum-view
                                                        *ngIf="item.totalMaam"
                                                        [sum]="item.totalMaam"
                                                        class="text-item text-ellipsis"
                                                ></app-sum-view>

                                                <p
                                                        *ngIf="!item.totalMaam"
                                                        class="text-item text-ellipsis"
                                                >
                                                    0
                                                </p>
                                            </div>
                                        </div>
                                    </div>
                                </ng-template>
                                <ng-template #incomeTemp>
                                    <div class="flex">
                                        <div style="width: 195px; min-width: 195px">
                                            <div *ngIf="item.custId; else empty" class="p-dropdown">
                                                <label class="p-dropdown-label">
                          <span
                              #spanElement
                              [pTooltip]="item.custId.cartisName"
                              [tooltipDisabled]="
                              spanElement.offsetWidth >= spanElement.scrollWidth
                            "
                              style="
                              vertical-align: middle;
                              display: block;
                              white-space: nowrap;
                              overflow: hidden;
                              text-overflow: ellipsis;
                            "
                              tooltipPosition="top"
                          >{{ item.custId.cartisName }}</span
                          >
                                                </label>
                                            </div>
                                        </div>

                                        <div
                                                style="align-self: stretch; width: 11px; height: auto"
                                        ></div>
                                        <div class="input disabled" style="width: 85px">
                                            <app-sum-view
                                                    *ngIf="item.totalIncludeMaam"
                                                    [sum]="item.totalIncludeMaam"
                                                    class="text-item text-ellipsis"
                                            ></app-sum-view>

                                            <p
                                                    *ngIf="!item.totalIncludeMaam"
                                                    class="text-item text-ellipsis"
                                            >
                                                0
                                            </p>
                                        </div>
                                    </div>
                                </ng-template>

                                <ng-template #empty>
                                    <div>&nbsp;</div>
                                </ng-template>
                            </div>
                        </ng-container>
                    </div>
                </div>
            </div>
        </div>
    </p-dialog>
</ng-container>

<ng-container *ngIf="deleteInvoiceModal">
    <p-dialog (onHide)="deleteInvoiceModal = false"
              (visibleChange)="deleteInvoiceModal = false"
              [draggable]="false"
              [modal]="true"
              [positionLeft]="
      positionLeftDeleteInvoiceModal
        ? positionLeftDeleteInvoiceModal
        : undefined
    "
              [resizable]="false"
              [style]="{'margin-top':'250px'}"
              [visible]="(
deleteInvoiceModal
        )"
              appendTo="body"
              position="top"
              styleClass="deleteInvoiceModal"
    >
        <p-header>
            <h1>מחיקת חשבונית</h1>
        </p-header>

        <p style="padding-top: 14px; padding-bottom: 10px">
            החשבונית תימחק ללא אפשרות שחזור. האם למחוק?
        </p>

        <p-footer>
            <button (click)="deleteInvoiceModal = false" class="button-link">
                {{ 'actions.cancellation' | translate }}
            </button>
            <button (click)="deleteInvoice()" class="button-dark">
                {{ 'actions.approve' | translate }}
            </button>
        </p-footer>
    </p-dialog>
</ng-container>

<ng-container *ngIf="mergeFiles">
    <p-dialog (onHide)="mergeFiles = false"
              (visibleChange)="mergeFiles = false"
              [modal]="true"
              [resizable]="false"
              [visible]="(
mergeFiles
        )"
              appendTo="body"
              styleClass="fileViewer mergeFiles invoiceMerge"
    >
        <p-header>
            <h1>איחוד חשבוניות</h1>
        </p-header>

        <p class="text">
            <strong> החשבוניות שבחרת יאוחדו, </strong>
            ניתן לשנות את הסדר ע”י גרירת המסמך עם העכבר.
        </p>

        <div>
            <ul
                #scroll
                class="scrollbar-dynamic scroll-chrome containerList viewAsGrid"
                style="
          position: relative;
          display: flex;
          list-style-type: none;
          flex-direction: row-reverse;
          flex-wrap: wrap;
          margin-left: 15px;
          border-top: 1px solid #bebcbc;
          border-bottom: 1px solid #bebcbc;
          padding-top: 12px;
          padding-bottom: 12px;
        "
            >
                <li
                    #element
                    (click)="selectItem(file)"
                    (contextmenu)="onRightClick($event)"
                    (dragover)="allowDrop($event, i)"
                    (dragstart)="onDragStart($event, i)"
                    (drop)="onDrop($event, i)"
                    *ngFor="let file of selcetedFiles; let i = index; trackBy: trackById"
                    class="cube"
                    draggable="true"
                >
                    <div *ngIf="onDragOverIndex == i" class="drop-zone"></div>
                    <div class="date">{{ i + 1 }}</div>

                    <div class="prepareFile finishedLoaded">
                        <div class="image">
                            <button
                                    (click)="
                  showDocumentStorageDataViewAsGrid(file.fileId);
                  $event.stopPropagation()
                "
                                    class="viewPhoto"
                            >
                                <mat-icon
                                        style="
                    color: white;
                    width: 18px;
                    height: 18px;
                    display: block;
                    align-self: center;
                  "
                                        svgIcon="pictureLines"
                                ></mat-icon>
                            </button>

                            <div
                                    [style.border-width]="
                  file?.fileId == selectedItem?.fileId ? '3px' : '1px'
                "
                                    style="
                  border: 1px solid #0f2d61;
                  position: absolute;
                  z-index: 99;
                  right: 0;
                  left: 0;
                  bottom: 0;
                  top: 0;
                  width: 100%;
                  height: 100%;
                "
                            ></div>

                            <img
                                    [ngSrc]="file.urlImg"
                                    [style.visibility]="'visible'"
                                    fill style="height: 221px; width: auto; position: relative;"

                            />
                        </div>
                    </div>
                </li>
            </ul>
        </div>

        <p-footer>
            <button (click)="mergeFiles = false" class="button-link">
                {{ 'actions.cancellation' | translate }}
            </button>
            <button (click)="filesUnion()" class="button-dark">אישור</button>
        </p-footer>
    </p-dialog>
</ng-container>

<ng-container *ngIf="showErrorModal">
    <p-dialog (onHide)="showErrorModal = false"
              (visibleChange)="showErrorModal = false"
              [closeOnEscape]="false"
              [closeOut]="true"
              [draggable]="false"
              [modal]="true"
              [resizable]="false"
              [visible]="(
showErrorModal
        )"
              appendTo="body"
              styleClass="errorModal"
    >
        <p>
            <strong> אופס! </strong>

            משהו השתבש.
        </p>
        <p>
            אנא נסו לעשות

            <span (click)="reloadFromModal()"> רענון לדף </span>
        </p>
    </p-dialog>
</ng-container>

<!--<p-sidebar [visible]="showDocumentListStorageDataFired && showDocumentListStorageDataFired === 'showDocumentAtleft'"-->
<!--           (onHide)="showDocumentListStorageDataFired = false;"-->
<!--           [position]="'left'"-->
<!--           appendTo="body"-->
<!--           [modal]="true"-->
<!--           [styleClass]="'sidebar-show-imgs list-imgs'">-->
<!--    <div [appScrollHeight]="0" class="scrollbar-dynamic scroll-chrome">-->
<!--        <ng-container *ngIf="{ pages: (fileDetails$| async)?.pages } as pagesNavData">-->
<!--            <ng-container *ngFor="let page of pagesNavData.pages; index as i; last as isLast">-->
<!--                <ng-container *ngIf="((cachedContent$| async)[i]| async) as imgBlob">-->
<!--                    <img width="100%"-->
<!--                         alt="pageImage"-->
<!--                         height="auto"-->
<!--                         style="height: auto; width: auto; position: relative;" fill [ngSrc]="imgBlob">-->
<!--                </ng-container>-->
<!--            </ng-container>-->
<!--        </ng-container>-->
<!--    </div>-->
<!--</p-sidebar>-->

<p-sidebar
        (onHide)="hideDocumentStorageData()"
        [modal]="true"
        [position]="'left'"
        [styleClass]="'sidebar-show-imgs'"
        [visible]="(
showDocumentStorageDataFired
        )"
        appendTo="body"
>
    <div class="zoom-controls-inside">
        <button (click)="imageScaleNewInvoice = 1" mat-icon-button>
            <mat-icon class="rotate-90">height</mat-icon>
        </button>
        <button (click)="rotateInside(); $event.stopPropagation()" mat-icon-button>
            <mat-icon style="width: 17px; height: 17px" svgIcon="rotate"></mat-icon>
        </button>
        <button (click)="zoomStepInside(1, 'imageScaleNewInvoice')" mat-icon-button>
            <mat-icon>add</mat-icon>
        </button>
        <button
                (click)="zoomStepInside(-1, 'imageScaleNewInvoice')"
                mat-icon-button
        >
            <mat-icon>remove</mat-icon>
        </button>
    </div>
    <div
            [ngStyle]="{ height: window['innerHeight'] - 10 + 'px' }"
            class="scrollbar-dynamic scroll-chrome"
            style="overflow: auto"
    >
        <div *ngIf="!sidebarImgs" class="loader">
            <div class="circle"></div>
        </div>
        <ng-container *ngIf="sidebarImgs">
            <ng-container *ngFor="let imgLink of sidebarImgs; index as i">
                <ng-container *ngIf="!finishedLoadedImgView">
                    <div class="loader">
                        <div class="circle"></div>
                    </div>
                </ng-container>
                <img
                        (load)="finishedLoadedImgView = true"
                        (loadstart)="finishedLoadedImgView = false"
                        [hidden]="!finishedLoadedImgView"
                        [src]="imgLink"
                        [ngStyle]="{ transform: 'rotate(' + degRotateImg + 'deg)' }"
                        [style.zoom.%]="imageScaleNewInvoice * 100"
                        style="height: auto; width: 680px; position: relative;
					  display: block; margin: 0 auto"
                />
            </ng-container>
        </ng-container>
    </div>
</p-sidebar>

<ng-container *ngIf="modalDocumentApproveOldDate">
    <p-dialog (onHide)="modalDocumentApproveOldDate = false"
              (visibleChange)="modalDocumentApproveOldDate = false"
              [draggable]="false"
              [modal]="true"
              [resizable]="false"
              [visible]="(
modalDocumentApproveOldDate
        )"
              appendTo="body"
              styleClass="documentApproveSender"
    >
        <p-header>
            <h1 style="display: flex; align-items: flex-end">
                <mat-icon
                        class="warn"
                        style="
            color: #f4cb07;
            font-size: 20px;
            height: 26px;
            margin-left: 5px;
            width: auto;
          "
                >
                    report_problem
                </mat-icon>

                אישור סופי
            </h1>
        </p-header>

        <p style="padding-top: 14px; padding-bottom: 10px">
            שימו לב, תאריך החשבונית ישן. האם לאשר בכל זאת?
        </p>

        <p-footer>
            <button (click)="modalDocumentApproveOldDate = false" class="button-link">
                {{ 'actions.cancellation' | translate }}
            </button>
            <button
                    (click)="modalDocumentApproveOldDate = false; documentApproveSender()"
                    class="button-dark"
            >
                {{ 'actions.approve' | translate }}
            </button>
        </p-footer>
    </p-dialog>
</ng-container>

<ng-container *ngIf="modalDocumentApproveDouble">
    <p-dialog (onHide)="modalDocumentApproveDouble = false"
              (visibleChange)="modalDocumentApproveDouble = false"
              [draggable]="false"
              [modal]="true"
              [resizable]="false"
              [visible]="(
modalDocumentApproveDouble
        )"
              appendTo="body"
              styleClass="documentApproveSender"
    >
        <p-header>
            <h1 style="display: flex; align-items: flex-end">
                <mat-icon
                        class="warn"
                        style="
            color: #f4cb07;
            font-size: 20px;
            height: 26px;
            margin-left: 5px;
            width: auto;
          "
                >
                    report_problem
                </mat-icon>

                אישור סופי
            </h1>
        </p-header>

        <p style="padding-top: 14px; padding-bottom: 10px">
            שימו לב, החשבונית חשודה ככפולה. האם לאשר בכל זאת?
        </p>

        <p-footer>
            <button (click)="modalDocumentApproveDouble = false" class="button-link">
                {{ 'actions.cancellation' | translate }}
            </button>
            <button
                    (click)="documentApproveFromModal()"
                    [disabled]="!fileDetailsSave.approveActive"
                    class="button-dark"
            >
                {{ 'actions.approve' | translate }}
            </button>
        </p-footer>
    </p-dialog>
</ng-container>

<ng-container *ngIf="modalExpenseOnly">
    <p-dialog (onHide)="modalExpenseOnly = false"
              (visibleChange)="modalExpenseOnly = false"
              [modal]="true"
              [resizable]="false"
              [visible]="(
modalExpenseOnly
        )"
              appendTo="body"
              styleClass="modalEditCardsBeforeSend"
    >
        <p-header>
            <h1>הוצאה/ הכנסה</h1>
        </p-header>

        <p>האם לחברה זו קולטים גם חשבוניות הכנסה?</p>

        <ul style="margin-right: 35px">
            <li>
                <p-radioButton
                        [(ngModel)]="modalExpenseOnly.always"
                        [inputId]="'modalExpenseOnly1'"
                        [label]="'כן, תמיד'"
                        [value]="true"
                        name="changeOption"
                ></p-radioButton>
            </li>
            <li>
                <p-radioButton
                        [(ngModel)]="modalExpenseOnly.always"
                        [inputId]="'modalExpenseOnly2'"
                        [label]="'לא, חד פעמי'"
                        [value]="false"
                        name="changeOption"
                ></p-radioButton>
            </li>
        </ul>
        <p-footer style="justify-content: center">
            <button (click)="modalExpenseOnly = false" class="button-link">
                {{ 'actions.cancellation' | translate }}
            </button>
            <button
                    (click)="updateExpenseOnly(modalExpenseOnly.always)"
                    class="button-dark"
            >
                {{ 'actions.approve' | translate }}
            </button>
        </p-footer>
    </p-dialog>
</ng-container>

<ng-container
        *ngIf="
    modalCancel && fileDetailsSave && fileDetailsSave.userApproveFieldsType
  "
>
    <p-dialog (onHide)="modalCancel = false"
              (visibleChange)="modalCancel = false"
              [modal]="true"
              [resizable]="false"
              [visible]="(
modalCancel
        )"
              appendTo="body"
              styleClass="modalEditCardsBeforeSendAuto"
    >
        <p-header>
            <h1>
                ביטול שיוך

                <ng-container [ngSwitch]="modalCancel?.fieldId">
                    <ng-container *ngSwitchCase="2"> כרטיס ספק/לקוח</ng-container>
                    <ng-container *ngSwitchCase="6"> כרטיס נגדי</ng-container>
                    <ng-container *ngSwitchCase="30"> כרטיס קופה</ng-container>
                    <ng-container *ngSwitchCase="40"> סוג תנועה חשבונית</ng-container>
                    <ng-container *ngSwitchCase="41"> סוג תנועה קבלה</ng-container>
                    <ng-container *ngSwitchCase="21"> הוצאה/הכנסה</ng-container>
                </ng-container>
            </h1>
        </p-header>

        <p style="text-align: right; margin-right: 15px; margin-left: 15px">
            האם ברצונך לבטל את שיוך

            <ng-container [ngSwitch]="modalCancel?.fieldId">
                <ng-container *ngSwitchCase="2"> כרטיס ספק/לקוח</ng-container>
                <ng-container *ngSwitchCase="6"> כרטיס נגדי</ng-container>
                <ng-container *ngSwitchCase="30"> כרטיס קופה</ng-container>
                <ng-container *ngSwitchCase="40"> סוג תנועה חשבונית</ng-container>
                <ng-container *ngSwitchCase="41"> סוג תנועה קבלה</ng-container>
                <ng-container *ngSwitchCase="21"> הוצאה/הכנסה</ng-container>
            </ng-container>
        </p>
        <p style="text-align: right; margin-right: 15px; margin-left: 15px">
            <strong>
                {{
                modalCancel.fieldId === 2 ||
                modalCancel.fieldId === 6 ||
                modalCancel.fieldId === 30
                    ? fileFieldsForm
                        .get(modalCancel.fieldId.toString())
                        .get('effectiveValue').value.cartisName
                    : modalCancel.fieldId === 21
                        ? fileFieldsForm
                            .get(modalCancel.fieldId.toString())
                            .get('effectiveValue').value === 1
                            ? 'הוצאה'
                            : 'הכנסה'
                        : fileFieldsForm
                            .get(modalCancel.fieldId.toString())
                            .get('effectiveValue').value
                }}
            </strong>
        </p>
        <p style="text-align: right; margin-right: 15px; margin-left: 15px">
            <ng-container [ngSwitch]="fileDetailsSave.userApproveFieldsType">
                <ng-container *ngSwitchCase="'COMPANY_IDENTIFICATION'">
                    לחברה -
                    <strong>
                        {{ companyIdentificationName }}
                    </strong>
                </ng-container>
                <ng-container *ngSwitchCase="'CUSTOMER_IDENTIFICATION'">
                    לשם לקוח -
                    <strong>
                        {{ fileFieldsForm.get('28').get('effectiveValue').value }}
                    </strong>
                </ng-container>
                <ng-container *ngSwitchCase="'COMPANY_HP'">
                    לח.פ -
                    <strong>
                        {{ fileFieldsForm.get('3').get('effectiveValue').value }}
                    </strong>
                </ng-container>
            </ng-container>
        </p>
        <p-footer style="justify-content: center">
            <button (click)="modalCancel = false" class="button-link">
                {{ 'actions.cancellation' | translate }}
            </button>
            <button
                    (click)="cancelCustServer(modalCancel); modalCancel = false"
                    class="button-dark"
            >
                {{ 'actions.approve' | translate }}
            </button>
        </p-footer>
    </p-dialog>
</ng-container>

<!--<ng-container *ngIf="modalCancel">-->
<!--    <p-dialog (visibleChange)="aaa = false" [visible]="modalCancel"-->
<!--                (onHide)="modalCancel = false;"-->
<!--                appendTo="body"-->
<!--                [modal]="true"-->
<!--                [resizable]="false"-->
<!--                styleClass="modalEditCardsBeforeSendAuto">-->
<!--        <p-header>-->
<!--            <h1>-->
<!--                ביטול שיוך כרטיס-->
<!--                {{modalCancel.fieldId === 2 ? ' ספק/ לקוח' : ' נגדי'}}-->
<!--            </h1>-->
<!--        </p-header>-->

<!--        <p style="text-align: right;margin-right: 15px;margin-left: 15px;">-->
<!--            האם ברצונך לבטל את שיוך כרטיס-->

<!--            {{modalCancel.fieldId === 2 ? ' ספק/ לקוח' : ' נגדי'}}-->

<!--        </p>-->
<!--        <p style="text-align: right;margin-right: 15px;margin-left: 15px;">-->
<!--            <strong>-->
<!--                {{fileFieldsForm.get(modalCancel.fieldId.toString()).get('effectiveValue').value.cartisName}}-->
<!--            </strong>-->
<!--        </p>-->
<!--        <p *ngIf="companyIdentificationName" style="text-align: right;-->
<!--    margin-right: 15px;margin-left: 15px;">-->
<!--            לחברה-->
<!--            <strong>-->
<!--                {{companyIdentificationName}}-->
<!--            </strong>-->
<!--        </p>-->
<!--        <ng-container *ngIf="!companyIdentificationName">-->
<!--            <p style="text-align: right;-->
<!--    margin-right: 15px;margin-left: 15px;">-->
<!--                לח.פ- -->
<!--                <strong>-->
<!--                    {{fileFieldsForm.get('3').get('effectiveValue').value}}-->
<!--                </strong>-->
<!--            </p>-->
<!--            &lt;!&ndash;            <p *ngIf="modalCancel.fieldId === 6" style="text-align: right;&ndash;&gt;-->
<!--            &lt;!&ndash;    margin-right: 15px;">&ndash;&gt;-->
<!--            &lt;!&ndash;                לכרטיס נגדי&ndash;&gt;-->
<!--            &lt;!&ndash;                <strong>&ndash;&gt;-->
<!--            &lt;!&ndash;                    {{fileFieldsForm.get('6').get('effectiveValue').value.cartisName}}&ndash;&gt;-->
<!--            &lt;!&ndash;                </strong>&ndash;&gt;-->
<!--            &lt;!&ndash;            </p>&ndash;&gt;-->
<!--        </ng-container>-->

<!--        <p-footer style="justify-content: center">-->
<!--            <button class="button-link" (click)="modalCancel = false;">-->
<!--                {{'actions.cancellation'| translate}}-->
<!--            </button>-->
<!--            <button class="button-dark"-->
<!--                    (click)="cancelCustServer(modalCancel); modalCancel = false;">-->
<!--                {{'actions.approve'| translate}}-->
<!--            </button>-->
<!--        </p-footer>-->
<!--    </p-dialog>-->
<!--</ng-container>-->

<ng-container *ngIf="show_modal_report856">
    <p-dialog (visibleChange)="show_modal_report856 = false"
              [modal]="true"
              [resizable]="false"
              [visible]="(
show_modal_report856
        )"
              appendTo="body"
              styleClass="show_modal_report856"
    >
        <p-header
        >ניכוי מס במקור
            {{
            fileFieldsForm.get('21').get('effectiveValue').value === 0
                ? 'מלקוחות'
                : 'לספקים'
            }}</p-header
        >

        <div>
            <p
                    style="
          font-size: 16px;
          line-height: 26px;
          margin-top: 5px;
          margin-bottom: 15px;
        "
            >
                על מנת להמשיך, יש להגדיר את כרטיס "ניכוי מס במקור

                {{
                fileFieldsForm.get('21').get('effectiveValue').value === 0
                    ? 'מלקוחות'
                    : 'לספקים'
                }}":
                <br/>
                (ההגדרה היא חד פעמית)
            </p>

            <form [formGroup]="infoModal" novalidate style="padding-left: 5px">
                <div
                        style="
            display: flex;
            align-items: center;
            margin-bottom: 20px;
            justify-content: space-between;
          "
                >
                    <div>
                        <app-dropdown-wrap
                                #formDropdowns
                                (onFocus)="clearFilter(formDropdowns)"
                                [autoDisplayFirst]="false"
                                [dropdownIcon]="'fa fa-fw fa-caret-down'"
                                [filter]="true"
                                [options]="
                userService.appData.userData.companyCustomerDetails
                  ? fileFieldsForm.get('21').get('effectiveValue').value === 0
                    ? userService.appData.userData.companyCustomerDetails
                        .customerTaxDeductionCustIdArr
                    : userService.appData.userData.companyCustomerDetails
                        .customerTaxDeductionCustIdExpenseArr
                  : []
              "
                                [scrollHeight]="'135px'"

                                [style]="{ width: '255px' }"
                                [virtualScroll]="true"
                                [virtualScrollItemSize]="33"
                                appendTo="body"
                                dataKey="custId"
                                emptyFilterMessage="לא נמצאו תוצאות"
                                filterBy="lName,custId,hp"
                                formControlName="taxDeductionCustId"
                                name="taxDeductionCustId"

                                id="taxDeductionCustId"
                                optionLabel="custId"
                                panelStyleClass="company-customer-dropdown-panel cardsDD cardsDD40"
                                placeholder="בחירה"
                                styleClass="ddInfoCompanyForm"
                        >
                            <ng-template let-item pTemplate="selectedItem">
                <span
                    #spanElement
                    [pTooltip]="item.cartisName"
                    [tooltipDisabled]="
                    spanElement.offsetWidth >= spanElement.scrollWidth
                  "
                    style="
                    vertical-align: middle;
                    display: block;
                    white-space: nowrap;
                    overflow: hidden;
                    text-overflow: ellipsis;
                  "
                    tooltipPosition="top"
                >{{ item.custId }}</span
                >
                            </ng-template>
                            <ng-template let-item pTemplate="item">
                                <div class="p-helper-clearfix cust-item">
                                    <div>
                    <span class="text-ellipsis">{{
                        item.cartisName
                        }}</span>
                                    </div>
                                </div>
                            </ng-template>

                            <ng-template pTemplate="empty">
                                <div
                                        class="p-helper-clearfix"
                                        style="font-size: 0.95em; padding: 0.3em 1em"
                                >
                                    <div>לא מצאת את הכרטיס שחיפשת?</div>
                                    <div>צרו כרטיס חדש בהנה"ח</div>
                                    <button
                                            class="button-link"
                                            style="padding: 0; font-size: inherit"
                                    >
                                        ולחצו על רענון הנתונים
                                    </button>
                                </div>


                            </ng-template>

                            <ng-template pTemplate="emptyfilter">
                                <div
                                        class="p-helper-clearfix"
                                        style="font-size: 0.95em; padding: 0.3em 1em"
                                >
                                    <div>לא מצאת את הכרטיס שחיפשת?</div>
                                    <div>צרו כרטיס חדש בהנה"ח</div>
                                    <button
                                            class="button-link"
                                            style="padding: 0; font-size: inherit"
                                    >
                                        ולחצו על רענון הנתונים
                                    </button>
                                </div>


                            </ng-template>

                        </app-dropdown-wrap>
                    </div>
                </div>
            </form>
        </div>
        <p-footer>
            <div style="justify-content: flex-end; margin-top: 45px">
                <button
                        (click)="show_modal_report856 = false"
                        class="button-white button-link"
                >
                    {{ 'actions.cancellation' | translate }}
                </button>
                <button
                        (click)="setReport856(); show_modal_report856 = false"
                        [disabled]="infoModal.invalid"
                        class="button-dark"
                        style="width: 108px; height: 33px !important; padding: 0"
                >
                    {{ 'actions.approve' | translate }}
                </button>
            </div>
        </p-footer>
    </p-dialog>
</ng-container>

<ng-container *ngIf="currencyListTemp">
    <p-dialog (visibleChange)="currencyListTemp = false"
              [modal]="true"
              [resizable]="false"
              [visible]="(
currencyListTemp
        )"
              appendTo="body"
              styleClass="currencyListSelectModal"
    >
        <p-header>{{ 'הוספת מטבע מט"ח' }}</p-header>
        <div
                *ngIf="currencyListTempLoader"
                class="loaderPercent blueCircle"
                style="background: #e6e5e5"
        >
            <div class="circle"></div>
        </div>
        <ng-container *ngIf="!currencyListTempLoader">
            <p>בחרו את סוג המטבע שתרצו להוסיף</p>
            <div
                    class="scrollbar-dynamic scroll-chrome"
                    style="max-height: 215px; overflow: auto"
            >
                <mat-list>
                    <mat-list-item
                            (click)="selectedCurrency = item"
                            *ngFor="let item of currencyListTemp; trackBy: trackCurrency"
                            [class.active]="item.code === selectedCurrency.code"
                    >
                        <p matLine>
                            <span class="forceLTR"> {{ item.code }} - {{ item.sign }} </span>
                        </p>
                    </mat-list-item>
                </mat-list>
            </div>
        </ng-container>

        <div class="border">&nbsp;</div>
        <p-footer>
            <button (click)="currencyListTemp = false" class="button-link">
                {{ 'actions.cancellation' | translate }}
            </button>
            <button
                    (click)="
          addCurrency(
            selectedCurrency.code,
            selectedCurrency.bankIsrael,
            selectedCurrency
          )
        "
                    class="button-dark"
            >
                אישור
            </button>
        </p-footer>
    </p-dialog>
</ng-container>
<ng-container *ngIf="currencySetModal">
    <p-dialog (visibleChange)="currencySetModal = false"
              [modal]="true"
              [resizable]="false"
              [visible]="(
currencySetModal
        )"
              appendTo="body"
              styleClass="currencySetModal"
    >
        <p-header>
            שער חליפין להמרת
            {{ selectedCurrency.code }}
        </p-header>
        <p style="padding-top: 10px; padding-bottom: 10px; font-weight: 600">
            שער חליפין להמרת
            {{ selectedCurrency.name }}

            <ng-container *ngIf="selectedCurrency">
                ({{ selectedCurrency.code }})
            </ng-container>
        </p>
        <div>
            <div style="height: 30px;display: flex;align-items: center;">
                <ng-container *ngIf="selectedCurrency.bankIsrael">
                    <p-radioButton
                            [(ngModel)]="type_currencyRates_modal.type"
                            [label]="'שער יציג (בנק ישראל)'"
                            inputId="radio_modal_BANK"
                            name="radioGroup_type_currencyRates_modal"
                            value="BANK"
                    >
                    </p-radioButton>
                    <span style="padding: 0px 8px"></span>
                </ng-container>
                <p-radioButton
                        [(ngModel)]="type_currencyRates_modal.type"
                        [label]="'שער קבוע'"
                        inputId="radio_modal_FIXED"
                        name="radioGroup_type_currencyRates_modal"
                        value="FIXED"
                >
                </p-radioButton>
                <input
                        style="
    height: 20px;
    line-height: 20px;
"
                        (click)="type_currencyRates_modal.type = 'FIXED'"
                        (keyup)="setMaxDigitsAfterDecModal(type_currencyRates_modal.value)"
                        [(ngModel)]="type_currencyRates_modal.value"
                        [class.err]="
            type_currencyRates_modal.type === 'FIXED' &&
            !type_currencyRates_modal.value
          "
                        appNumbersOnly="positive"
                        type="text"
                />
            </div>
            <div style="height: 30px; margin-top: 10px">
                קוד מטבע בהנה״ח

                <input
                        [(ngModel)]="type_currencyRates_modal.hashCodeId"
                        [class.err]="
            !type_currencyRates_modal.hashCodeId ||
            type_currencyRates_modal.hashCodeId === '0'
          "
                        appNumbersOnly="regexPositiveInt"
                        type="text"
                />
            </div>
        </div>
        <p-footer>
            <button (click)="currencySetModal = false" class="button-link">
                {{ 'actions.cancellation' | translate }}
            </button>
            <button
                    (click)="
          addCurrencyModal(
            selectedCurrency.code,
            selectedCurrency.bankIsrael,
            selectedCurrency
          )
        "
                    [disabled]="
          !type_currencyRates_modal.hashCodeId ||
          type_currencyRates_modal.hashCodeId === '0' ||
          (type_currencyRates_modal.type === 'FIXED' &&
            !type_currencyRates_modal.value)
        "
                    class="button-dark"
            >
                אישור
            </button>
        </p-footer>
    </p-dialog>
</ng-container>


<ng-container *ngIf="splitContentModal">
    <p-dialog (visibleChange)="splitContentModal = false;"
              [modal]="true"
              [resizable]="false"
              [visible]="(
splitContentModal
        )"
              appendTo="body"
              styleClass="splitContentModal"
    >
        <ng-template pTemplate="header">
            הפרדת החשבוניות
        </ng-template>
        <div>
            <app-crop-multiple
                #crop
                (splitImages)="splitImagesOuput($event)"
                [imgSrc]="splitContentModal"
            ></app-crop-multiple>
        </div>
        <ng-template pTemplate="footer">
            <button (click)="splitContentModal = false; " class="button-link">
                {{ 'actions.cancellation' | translate }}
            </button>
            <button (click)="
					crop.crop();"
                    class="button-dark"
                    style="width: 120px"
            >
                אישור
            </button>
        </ng-template>
    </p-dialog>
</ng-container>

<!--<ng-container *ngIf="splitImagesOuputSrc">-->
<!--    <p-dialog (visibleChange)="splitImagesOuputSrc = false;"-->
<!--              [modal]="true"-->
<!--              [resizable]="false"-->
<!--              [visible]="(-->
<!--splitImagesOuputSrc-->
<!--        )"-->
<!--              appendTo="body"-->
<!--              styleClass="splitImagesOuputSrc"-->
<!--    >-->
<!--        <ng-template pTemplate="header">-->
<!--            חשבוניות שהפורדו - המחשה-->
<!--        </ng-template>-->

<!--        <ng-container *ngFor="let imgSrc of splitImagesOuputSrc">-->
<!--            <img [src]="imgSrc"-->
<!--                 style="max-width: 1320px;"-->
<!--                 height="auto"-->
<!--                 width="auto">-->
<!--        </ng-container>-->
<!--    </p-dialog>-->
<!--</ng-container>-->
