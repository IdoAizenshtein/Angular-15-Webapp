<div class="lineAccBankMatchAccountNav">
    <div style="display: flex">
        <div id="bankMatchAccountNav">
            <div id="groupAcc">
                <div
                        (mouseenter)="prevScroll(navBanks, true)"
                        (mouseleave)="scrollRobotStop($event)"
                        *ngIf="nav.prev"
                        id="prevScroll"
                >
                    <i class="fas fa-angle-right"></i>
                </div>
                <ul #navBanks style="overflow-x: hidden; white-space: nowrap">
                    <li
                            *ngFor="let acc of userService.appData.userData.bankMatchAccount"
                            [hidden]="router.url.includes('casflow') && acc.countNigrarot === 0"
                    >
                        <div
                                (click)="setBankAcc(acc)"
                                [class.active]="
                userService.appData.userData.bankMatchAccountAcc
                  ?.companyAccountId === acc.companyAccountId
              "
                                style="display: flex"
                        >
                            <!--<img *ngIf="acc.bankIconSrc" style="height: auto; width: auto; position: relative;" fill [ngSrc]="acc.bankIconSrc">-->
                            <img
                                    [alt]="acc.accountNickname" [ngSrc]="
                  (acc.companyAccountId | asBankAccount).bankId
                    | toIconSrc: 'bank'
                " fill
                                    style="height: auto; width: auto; position: relative;"
                            />

                            <div class="text-ellipsis">
                                {{ acc.accountNickname }} {{ acc.currency | currencySymbol }}
                            </div>
                            <i
                                    [matTooltip]="
                  'appWalk.customers.tazrim.bankmatch.opsToMatchCounter'
                    | translate
                "
                                    matTooltipPosition="below"
                            >
                                {{ acc.countNigrarot > 99 ? '99+' : acc.countNigrarot }}
                            </i>
                        </div>
                    </li>
                </ul>
                <div
                        (mouseenter)="nextScroll(navBanks, true)"
                        (mouseleave)="scrollRobotStop($event)"
                        *ngIf="nav.next"
                        id="nextScroll"
                >
                    <i class="fas fa-angle-left"></i>
                </div>
            </div>
            <!--<img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/replace.png" alt="replace" width="32" height="20" id="replace"-->
            <!--[pTooltip]="'החלפת טבלאות'" [escape]="false" tooltipPosition="bottom" (click)="replace()">-->
        </div>
        <div id="navTabs">
            <ul class="tabs">
                <li
                        [matTooltip]="'appWalk.customers.tazrim.bankmatch.opsToMatch' | translate"
                        [routerLinkActiveOptions]="{ exact: true }"
                        [title]="'תנועות להתאמה'"
                        matTooltipPosition="below"
                        queryParamsHandling="preserve"
                        routerLink="./"
                        routerLinkActive="active">
                    {{ 'תנועות להתאמה' }}
                </li>
                <li
                        (click)="sharedComponent.mixPanelEvent('matched transes');"
                        [matTooltip]="
            'appWalk.customers.tazrim.bankmatch.opsMatched' | translate
          "
                        [routerLinkActiveOptions]="{ exact: true }"
                        [title]="'תנועות שהותאמו'"
                        matTooltipPosition="below"
                        queryParamsHandling="preserve"
                        routerLink="./matched"
                        routerLinkActive="active"
                >
                    {{ 'תנועות שהותאמו' }}
                </li>
            </ul>
        </div>
    </div>
</div>
<div
        *ngIf="
    userService?.appData?.userData?.bankMatchAccountAcc?.countNigrarot > 25 &&
    !userService?.appData?.userData?.bankMatchAccountAcc?.closeAlert
  "
        class="countNigrarot"
>
    <div>
        <b> שימו לב: </b>
        הצטברו מעל 25 תנועות שהיו צפויות להתאמה לחשבון זה.
        <br/>
        תוכלו "לפתוח דף חדש" ולמחוק את הפריטים שלא הותאמו. המחיקה לא תשפיע על תנועות
        הבנק בפועל.
    </div>
    <div>
        מחיקת תנועות שלא הותאמו, עד לפני
        <input
                [(ngModel)]="daysToDelete"
                [class.err]="daysToDelete === '' || daysToDelete < 0"
                appNumbersOnly="positiveInt"
                type="text"
        />
        ימים

        <button
                (click)="openPopEdit()"
                [disabled]="daysToDelete === '' || daysToDelete < 0"
                class="button-dark"
        >
            מחיקה
        </button>
    </div>
    <img
            (click)="userService.appData.userData.bankMatchAccountAcc.closeAlert = true" alt="close" fill
            ngSrc="/assets/images/closeAlert.png"
            style="height: auto; width: auto; position: relative;"
    />
</div>

<div class="twoTables" style="position: relative">
    <div
            [class.isBorder]="banktransForMatchAll?.length"
            class="banktransForMatch"
    >
        <div [class.notUpdate]="accountSelectOneNotUpdate" class="title">
            <i
                    [matTooltip]="
          'appWalk.customers.tazrim.bankmatch.unexpectedOpsHeader' | translate
        "
                    matTooltipPosition="below"
                    style="line-height: 1em"
            >
                תנועות בנק שלא צפיתי / לא הותאמו
            </i>
            <div class="search">
                <input
                        [formControl]="filterInput"
                        autocomplete="off"
                        id="containTextFilter"
                        placeholder="{{ 'filters.search' | translate }}"
                        type="text"
                />
            </div>
        </div>
        <div *ngIf="loader" class="loader">
            <div class="circle"></div>
        </div>
        <div
                *ngIf="banktransForMatchAll?.length"
                class="searchRow"
                style="justify-content: space-between"
        >
            <ng-container
                    *ngIf="
          userService.appData.userData.bankMatchAccountAcc && hasRowOfDeleted;
          else noSelectedRows
        "
            >
        <span
                [innerHTML]="
            'expressions.markedTransactionsSummaryPtrn'
              | translate
                : {
                    sum: (hasRowOfDeleted.sum | sum),
                    currency:
                      ((
                        userService.appData.userData.bankMatchAccountAcc
                          .companyAccountId | asBankAccount
                      ).currency | currencySymbol),
                    size: hasRowOfDeleted.size
                  }
          "
        ></span>
                <!--{{('expressions.markedTransactionsSummaryPtrn'| translate:{ sum:(hasRowOfDeleted.sum| sum),-->
                <!--currency: ((userService.appData.userData.bankMatchAccountAcc.companyAccountId| asBankAccount).currency| currencySymbol),-->
                <!--size: hasRowOfDeleted.size})}}-->
                <!--{{hasRowOfDeleted| json}}-->
            </ng-container>
            <ng-template #noSelectedRows>
                {{ 'expressions.markTransactionsForMatch' | translate }}
            </ng-template>

            <div
                    *ngIf="
          userService.appData.userData.bankMatchAccountAcc &&
          accountSelectOneNotUpdate &&
          !hasRowOfDeleted
        "
                    class="accountSelectOneNotUpdate"
            >
                <app-account-outdated-view
                        [account]="
            userService.appData.userData.bankMatchAccountAcc.companyAccountId
              | asBankAccount
          "
                ></app-account-outdated-view>
                <!--<app-token-credentials-update-button-->
                <!--[balanceLastUpdatedDate]="(userService.appData.userData.bankMatchAccountAcc.companyAccountId| asBankAccount).balanceLastUpdatedDate"-->
                <!--[tokenData]="{-->
                <!--companyId: userService.appData.userData.companySelect.companyId,-->
                <!--tokenId:(userService.appData.userData.bankMatchAccountAcc.companyAccountId| asBankAccount).token-->
                <!--}">-->
                <!--</app-token-credentials-update-button>-->
            </div>
            <!--<div class="search">-->
            <!--<input id="containTextFilter"-->
            <!--type="text" autocomplete="off"-->
            <!--placeholder="{{'filters.search'|translate}}"-->
            <!--[value]="queryString"-->
            <!--[formControl]="filterInput">-->
            <!--</div>-->
            <div *ngIf="hasRowOfDeleted && !hasRowOfChecked" class="btnDelete">
                <button (click)="openPopBankMatchDelete(); sharedComponent.mixPanelEvent('delete bank');" class="button-dark">
                    למחוק
                </button>
            </div>
        </div>
        <div
                *ngIf="banktransForMatchAll?.length"
                class="bank-acc-details-table-container tableBanktransForMatch"
                style="position: relative"
        >
            <div #banktransForMatchHeader class="bank-acc-details-table-header">
                <div class="bank-acc-details-column-1">
                    <div>{{ 'titles.description' | translate }}</div>
                </div>
                <div
                        class="bank-acc-details-column-beneficiary"
                        style="overflow: visible"
                >
                    <app-tooltip-category
                            (changed)="sharedComponent.mixPanelEvent('bank - mutav filter', {value: $event.checked}); filterBeneficiaries('bank', $event)"
                            [data]="beneficiaryFilter.bank.options"
                            [filter]="true"
                            [type]="'biziboxMutavId'">
                        <img fill ngSrc="/assets/images/beneficiary-header-icon.png"
                             style="height: auto; width: auto; position: relative;"/>
                    </app-tooltip-category>
                </div>
                <div class="bank-acc-details-column-2" style="overflow: visible">
                    <div>
                        <app-tooltip-category
                                (changed)="sharedComponent.mixPanelEvent('bank - payment type filter', {value:$event.checked}); filterCategory($event)"
                                [title]="'titles.typeOfPayment' | translate"
                                [translateEnum]="sharedService.paymentTypesTranslate$"
                                [type]="'payment'"
                                [data]="paymentTypesArr"
                        ></app-tooltip-category>
                    </div>
                </div>
                <div (click)="sharedComponent.mixPanelEvent('bank - date order'); sortPipeFilter(1)" class="bank-acc-details-column-3">
                    {{ 'titles.date' | translate }}
                    <img
                            [ngSrc]="
              '/assets/images/sort-' +
              (sortPipeDirDate === 'smaller' ? 'asc' : 'desc') +
              '.png'
            " fill style="height: auto; width: auto; position: relative;margin: 0 3px -3px 0"
                    />
                </div>
                <div (click)="sharedComponent.mixPanelEvent('bank - total order'); sortPipeFilter(2)" class="bank-acc-details-column-4">
                    <div>
                        {{ 'titles.sum' | translate }}
                        <img
                                [ngSrc]="
                '/assets/images/sort-' +
                (sortPipeDir === 'smaller' ? 'asc' : 'desc') +
                '.png'
              " fill
                                style="height: auto; width: auto; position: relative;margin: 0 3px -3px 0"
                        />
                    </div>
                </div>
            </div>
            <div
                    [ngStyle]="{'height': (getPageHeightFunc(banktransForMatchHeader.getBoundingClientRect().bottom + 10)) +'px'}"
                    class="containerList scrollbar-dynamic bank-acc-details-table-body"
                    style="position: relative"
            >
                <div *ngIf="loader" class="loader">
                    <div class="circle"></div>
                </div>
                <ng-scrollbar
                    #scrollbarCompanies
                    (updated)="onScroll(scrollbarCompanies)"
                    class="custom-scrollbar"
                    thumbClass="scrollbar-thumb"
                    trackClass="scrollbar">

                    <cdk-virtual-scroll-viewport #virtualScroll itemSize="46" scrollViewport>
                        <div *cdkVirtualFor="let item of banktransForMatch; let i = index; trackBy: trackById">
                            <div
                                    [class.bank-acc-details-row-selected]="
                item.deleteRow || item?.bankTransId === tooltipElem?.transId
              "
                                    class="bank-acc-details-row"
                            >
                                <div
                                        class="bank-acc-details-column-1"
                                        style="display: flex; align-items: center"
                                >
                                    <p-checkbox (onChange)="
                    item.deleteRow = !item.deleteRow; checkDeleted(); sharedComponent.mixPanelEvent('check bank');
                  "
                                                [binary]="true"
                                                [disabled]="item.checkDisabled"
                                                [ngModel]="item.deleteRow"
                                                checkboxIcon="fa fa-check"
                                    >
                                    </p-checkbox>

                                    <div
                                            [innerHTML]="
                    item.transDescAzonly | highlight: filterInput.value
                  "
                                            [pTooltip]="item.transDescAzonly"
                                            class="text-ellipsis"
                                            style="min-width: 0; flex: 1 1 100%; -ms-flex: 1 1 100%"
                                            tooltipPosition="top"
                                    ></div>
                                </div>

                                <div class="bank-acc-details-column-beneficiary">
                                    <ng-container *ngIf="item.mutavNames?.length">
                                        <img
                                                [pTooltip]="item.mutavNames.join(', ')" fill
                                                ngSrc="/assets/images/beneficiary-row-icon.png"
                                                style="height: auto; width: auto; position: relative;"
                                                tooltipPosition="top"
                                        />
                                    </ng-container>
                                </div>

                                <div class="bank-acc-details-column-2">
                                    <div
                                            [appTransactionAdditionalTrigger]="item"
                                            [class.bank-acc-details-link]="
                    item.linkId || item.pictureLink
                  "
                                            (click)="mixPanelEventEvent(item.paymentDesc)"
                                            [innerHTML]="
                    item.paymentDescTranslate | highlight: filterInput.value
                  "
                                            class="text-ellipsis"
                                    ></div>
                                    <div
                                            [innerHTML]="item.asmachta | highlight: filterInput.value"
                                            class="text-ellipsis"
                                    ></div>
                                </div>
                                <div class="bank-acc-details-column-3">
                                    <div
                                            [innerHTML]="
                    item.transDateStr
                      | highlight: (searchInDates ? filterInput.value : '')
                  "
                                    ></div>
                                    <div>{{ item.transDate | todayRelativeHumanize: 'days' }}</div>
                                </div>
                                <div class="bank-acc-details-column-4" style="position: relative">
                                    <div
                                            [class.sum-credit]="!item.hova"
                                            [class.sum-debit]="item.hova"
                                            class="ltrNum"
                                    >
                                        <app-sum-view
                                                [highlight]="filterInput.value"
                                                [sum]="item.total"
                                                class="text-ellipsis"
                                        >
                                        </app-sum-view>
                                    </div>
                                    <div>
                                        <!--<img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/trash.png" style="width: 14px;vertical-align: middle;"-->
                                        <!--(click)="openPopBankMatchDelete(item)"/>-->
                                        <i
                                                (click)="openTooltip($event, 162, item.bankTransId, item)"
                                                *ngIf="item.isCyclic"
                                                [matTooltip]="
                      'appWalk.customers.tazrim.bankmatch.unexpectedOpActionHandler'
                        | translate
                    "
                                                class="fas fa-ellipsis-v"
                                                matTooltipPosition="before"
                                        ></i>
                                        <!--                                       (click)="openTooltip($event, 102, item.bankTransId, item);"></i>-->
                                    </div>
                                </div>
                                <!--<div class="arrow-right"-->
                                <!--*ngIf="showAdditionalItem && showAdditionalItem.bankTransId === item.bankTransId"></div>-->
                            </div>
                        </div>
                    </cdk-virtual-scroll-viewport>
                </ng-scrollbar>

                <div
                        *ngIf="
            !loader && banktransForMatchAll?.length && !banktransForMatch.length
          "
                        class="no-rows-found"
                >
                    {{ 'expressions.noDataFoundForCriteria' | translate }},
                    {{ 'expressions.changeCriteria' | translate }}
                </div>
            </div>
        </div>
        <div
                *ngIf="banktransForMatchAll && !banktransForMatchAll?.length"
                class="notData"
        >
            <p>לא קיימות תנועות בנק שלא צפיתי / לא הותאמו</p>
        </div>
    </div>

    <div [class.isBorder]="cashflowMatchAll?.length" class="banktransForMatch">
        <div class="title">
            <i
                    [matTooltip]="
          'appWalk.customers.tazrim.bankmatch.expectedNotHappenedOpsHeader'
            | translate
        "
                    matTooltipPosition="below"
                    style="line-height: 1em"
            >
                תנועות תזרים צפויות שטרם קרו / לא הותאמו
            </i>
            <div class="search">
                <input
                        [formControl]="filterInputUnadjusted"
                        autocomplete="off"
                        id="containTextFilterUnadjusted"
                        placeholder="{{ 'filters.search' | translate }}"
                        type="text"
                />
            </div>
        </div>
        <div *ngIf="loaderCash" class="loader">
            <div class="circle"></div>
        </div>
        <div *ngIf="cashflowMatchAll?.length" class="searchRow">
            <!--<div class="search" style="margin: 0;">-->
            <!--<input id="containTextFilterUnadjusted"-->
            <!--type="text" autocomplete="off"-->
            <!--placeholder="{{'filters.search'|translate}}"-->
            <!--[formControl]="filterInputUnadjusted">-->
            <!--</div>-->
            <!--{{'expressions.markTransactionsForMatch'| translate}}-->
            <ng-container
                    *ngIf="
          userService.appData.userData.bankMatchAccountAcc && hasRowOfChecked;
          else noSelectedRows
        "
            >
        <span
                [innerHTML]="
            'expressions.markedTransactionsSummaryPtrn'
              | translate
                : {
                    sum: (hasRowOfChecked.sum | sum),
                    currency:
                      ((
                        userService.appData.userData.bankMatchAccountAcc
                          .companyAccountId | asBankAccount
                      ).currency | currencySymbol),
                    size: hasRowOfChecked.size
                  }
          "
        ></span>
                <!--{{('expressions.markedTransactionsSummaryPtrn'| translate:{ sum:(hasRowOfChecked.sum| sum),-->
                <!--currency: ((userService.appData.userData.bankMatchAccountAcc.companyAccountId| asBankAccount).currency| currencySymbol),-->
                <!--size: hasRowOfChecked.size})}}-->
                <!--{{hasRowOfChecked| json}}-->
            </ng-container>
            <ng-template #noSelectedRows>
                {{ 'expressions.markTransactionsForMatch' | translate }}
            </ng-template>

            <div *ngIf="hasRowOfChecked && !hasRowOfDeleted" class="btnGroup">
                <button (click)="sharedComponent.mixPanelEvent('delay tazrim'); onMultiPostponeClick()" class="button-dark">
                    לדחות
                </button>
                <button
                        (click)="sharedComponent.mixPanelEvent('delete tazrim');rolloutDeleteOperationConfirmPrompt()"
                        class="button-dark"
                >
                    <!--<button class="button-dark" (click)="onMultiDeleteClick()">-->
                    למחוק
                </button>
            </div>

            <!--[style.pointer-events]="!(cashflowMatchReco?.length) || currentTab === 0 ? 'none' : 'auto'"-->
            <ul *ngIf="!hasRowOfChecked || hasRowOfDeleted" class="tabs">
                <li
                        (click)="checkReco()"
                        [class.active]="currentTab === 0"
                        [class.disabled]="!cashflowMatchReco?.length"
                        [matTooltipDisabled]="!cashflowMatchReco?.length"
                        [matTooltip]="
            'appWalk.customers.tazrim.bankmatch.recommendedOpsBtn' | translate
          "
                        [style.pointer-events]="!cashflowMatchReco?.length ? 'none' : 'auto'"
                        matTooltipPosition="below">
                    מומלצות
                </li>
                <li
                        (click)="currentTab = 1; filtersAllCash()"
                        [class.active]="currentTab === 1"
                        [style.pointer-events]="currentTab === 1 ? 'none' : 'auto'">
                    הכל
                </li>
            </ul>
        </div>
        <div
                *ngIf="cashflowMatchAll?.length"
                class="bank-acc-details-table-container tableBanktransForMatch"
                style="position: relative"
        >
            <div #cashflowMatchHeader class="bank-acc-details-table-header">
                <div class="bank-acc-details-column-1">
                    <div style="display: flex; align-items: center">
                        <!--<p-checkbox checkboxIcon="fa fa-check" [binary]="true"-->
                        <!--[disabled]="checkAllRowsDisabled"-->
                        <!--(onChange)="checkAllRows=!checkAllRows;checkAllRowsFunc()"-->
                        <!--[(ngModel)]="checkAllRows">-->
                        <!--</p-checkbox>-->
                        <div class="text-ellipsis">
                            {{ 'titles.description' | translate }}
                        </div>
                    </div>
                </div>
                <div
                        class="bank-acc-details-column-beneficiary"
                        style="overflow: visible"
                >
                    <app-tooltip-category
                            (changed)="sharedComponent.mixPanelEvent('tazrim - mutav filter', {value: $event.checked}); filterBeneficiaries('cashflow', $event)"
                            [filter]="true"
                            [type]="'biziboxMutavId'"
                            [data]="beneficiaryFilter.cashflow.options"
                    >
                        <img fill ngSrc="/assets/images/beneficiary-header-icon.png"
                             style="height: auto; width: auto; position: relative;"/>
                    </app-tooltip-category>
                </div>
                <div class="bank-acc-details-column-2">
                    <!--{{'titles.methodsOfPayment'|translate}}-->
                    <div>
                        <app-tooltip-category
                                (changed)="sharedComponent.mixPanelEvent('tazrim - payment type filter', {value: $event.checked}); filterCashCategory($event)"
                                [title]="'titles.typeOfPayment' | translate"
                                [translateEnum]="sharedService.paymentTypesTranslate$"
                                [type]="'payment'"
                                [data]="cashPaymentTypesArr"
                        ></app-tooltip-category>
                    </div>
                </div>
                <div (click)="sharedComponent.mixPanelEvent('tazrim - date order'); sortPipeFilterCash(1)" class="bank-acc-details-column-3">
                    {{ 'titles.expectedToDate' | translate }}
                    <img
                            [ngSrc]="
              '/assets/images/sort-' +
              (sortPipeDirCashDate === 'smaller' ? 'asc' : 'desc') +
              '.png'
            " fill style="height: auto; width: auto; position: relative;margin: 0 3px -3px 0"
                    />
                </div>
                <div (click)="sharedComponent.mixPanelEvent('tazrim - total order'); sortPipeFilterCash(2)" class="bank-acc-details-column-4">
                    <div>
                        {{ 'titles.sum' | translate }}
                        <img
                                [ngSrc]="
                '/assets/images/sort-' +
                (sortPipeDirCash === 'smaller' ? 'asc' : 'desc') +
                '.png'
              " fill
                                style="height: auto; width: auto; position: relative;margin: 0 3px -3px 0"
                        />
                    </div>
                </div>
            </div>
            <div
                    (scroll)="tooltipElem = null"
                    [appScrollHeight]="
          cashflowMatchHeader.getBoundingClientRect().bottom + 10
        "
                    class="containerList scrollbar-dynamic bank-acc-details-table-body"
                    style="position: relative"
            >
                <div *ngIf="cashflowMatch?.partialMatch?.children.length">
                    <div
                            (click)="
              cashflowMatch.partialMatch.parent.opened =
                !cashflowMatch.partialMatch.parent.opened;

            "
                            [class.opened]="cashflowMatch.partialMatch.parent.opened"
                            class="bank-acc-details-row titleRow"
                    >
                        <div>
                            <i
                                    [ngClass]="
                  cashflowMatch.partialMatch.parent.opened
                    ? 'fa-caret-up'
                    : 'fa-caret-down'
                "
                                    class="fa fa-fw"
                            ></i>
                            {{ 'expressions.partialMatch' | translate }}
                        </div>
                    </div>
                    <div *ngIf="cashflowMatch.partialMatch.parent.opened">
                        <div
                                *ngFor="
                let item of cashflowMatch.partialMatch.children;
                trackBy: trackById
              "
                        >
                            <div
                                    [class.bank-acc-details-row-selected]="
                  item.checkRow || item?.targetId === tooltipElem?.transId
                "
                                    class="bank-acc-details-row"
                            >
                                <div
                                        class="bank-acc-details-column-1"
                                        style="display: flex; align-items: center"
                                >
                                    <ng-container *ngIf="item.isMatchable; else systemAutoMatch">
                                        <p-checkbox (onChange)="
                        item.checkRow = !item.checkRow; checkChecked(item); sharedComponent.mixPanelEvent('check tazrim');
                      "
                                                    [binary]="true"
                                                    [disabled]="item.checkDisabled"
                                                    [ngModel]="item.checkRow"
                                                    checkboxIcon="fa fa-check"
                                        >
                                        </p-checkbox>
                                    </ng-container>

                                    <div
                                            [innerHTML]="
                      item.targetName | highlight: filterInputUnadjusted.value
                    "
                                            [pTooltip]="item.targetName"
                                            class="text-ellipsis"
                                            style="min-width: 0; flex: 1 1 100%; -ms-flex: 1 1 100%"
                                            tooltipPosition="top"
                                    ></div>
                                </div>

                                <div class="bank-acc-details-column-beneficiary">
                                    <ng-container *ngIf="item.mutavNames?.length">
                                        <img
                                                [pTooltip]="item.mutavNames.join(', ')" fill
                                                ngSrc="/assets/images/beneficiary-row-icon.png"
                                                style="height: auto; width: auto; position: relative;"
                                                tooltipPosition="top"
                                        />
                                    </ng-container>
                                </div>

                                <div class="bank-acc-details-column-2" style="display: flex">
                                    <div
                                            *ngIf="item.targetAsmachta; else singleRowCell"
                                            [pTooltip]="item.paymentDescTranslate"
                                            class="text-ellipsis"
                                            tooltipPosition="top"
                                    >
                                        <div
                                                [innerHTML]="
                        item.paymentDescTranslate
                          | highlight: filterInputUnadjusted.value
                      "
                                        ></div>
                                        <div
                                                [innerHTML]="
                        item.targetAsmachta
                          | highlight: filterInputUnadjusted.value
                      "
                                                style="color: #a7a3a3"
                                        ></div>
                                    </div>
                                    <ng-template #singleRowCell>
                                        <div
                                                [innerHTML]="
                        item.paymentDescTranslate
                          | highlight: filterInputUnadjusted.value
                      "
                                                [pTooltip]="item.paymentDescTranslate"
                                                class="text-ellipsis"
                                                tooltipPosition="top"
                                        ></div>
                                    </ng-template>

                                    <div
                                            [style.visibility]="
                      (item.targetTypeName | isPeriodicType)
                        ? 'visible'
                        : 'hidden'
                    "
                                            class="periodic-trans-indication"
                                    >
                                        <img fill ngSrc="/assets/images/periodic-trans.png"
                                             style="height: auto; width: auto; position: relative;"/>
                                    </div>
                                </div>
                                <div class="bank-acc-details-column-3">
                                    <div>{{ 'sumsTitles.today' | translate }}</div>
                                    <div>
                                        {{
                                        item.targetOriginalDate | todayRelativeHumanize: 'drugged'
                                        }}
                                    </div>
                                </div>
                                <div
                                        class="bank-acc-details-column-4"
                                        style="position: relative"
                                >
                                    <div
                                            [class.sum-credit]="!item.expence"
                                            [class.sum-debit]="item.expence"
                                            class="ltrNum"
                                    >
                                        <app-sum-view
                                                [highlight]="filterInputUnadjusted.value"
                                                [sum]="item.targetOriginalTotal"
                                                class="text-ellipsis"
                                        >
                                        </app-sum-view>
                                    </div>
                                    <div>
                                        <!--<img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/trash.png"-->
                                        <!--style="width: 14px;vertical-align: middle;"/>-->
                                        <i
                                                (click)="openTooltip($event, 235, item.targetId, item)"
                                                [matTooltip]="
                        'appWalk.customers.tazrim.bankmatch.expectedNotHappenedOpActionHandler'
                          | translate
                      "
                                                class="fas fa-ellipsis-v"
                                                matTooltipPosition="before"
                                        ></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div *ngIf="cashflowMatch?.nigreret?.children.length">
                    <div
                            (click)="
              cashflowMatch.nigreret.parent.opened =
                !cashflowMatch.nigreret.parent.opened;
                                sharedComponent.mixPanelEvent((cashflowMatch.nigreret.parent.opened ? 'open' : 'close') + ' nigrarot');

            "
                            [class.opened]="cashflowMatch.nigreret.parent.opened"
                            class="bank-acc-details-row titleRow"
                    >
                        <div>
                            <i
                                    [ngClass]="
                  cashflowMatch.nigreret.parent.opened
                    ? 'fa-caret-up'
                    : 'fa-caret-down'
                "
                                    class="fa fa-fw"
                            ></i>
                            {{ 'expressions.movementsOutstandingNotAdjusted' | translate }}
                        </div>
                    </div>
                    <div *ngIf="cashflowMatch.nigreret.parent.opened">
                        <div
                                *ngFor="
                let item of cashflowMatch.nigreret.children;
                trackBy: trackById
              "
                        >
                            <div
                                    [class.bank-acc-details-row-selected]="
                  item.checkRow || item?.targetId === tooltipElem?.transId
                "
                                    class="bank-acc-details-row"
                            >
                                <div
                                        class="bank-acc-details-column-1"
                                        style="display: flex; align-items: center"
                                >
                                    <ng-container *ngIf="item.isMatchable; else systemAutoMatch">
                                        <p-checkbox (onChange)="
                        item.checkRow = !item.checkRow; checkChecked(item)
                      "
                                                    [binary]="true"
                                                    [disabled]="item.checkDisabled"
                                                    [ngModel]="item.checkRow"
                                                    checkboxIcon="fa fa-check"
                                        >
                                        </p-checkbox>
                                    </ng-container>

                                    <div
                                            [innerHTML]="
                      item.targetName | highlight: filterInputUnadjusted.value
                    "
                                            [pTooltip]="item.targetName"
                                            class="text-ellipsis"
                                            style="min-width: 0; flex: 1 1 100%; -ms-flex: 1 1 100%"
                                            tooltipPosition="top"
                                    ></div>
                                </div>

                                <div class="bank-acc-details-column-beneficiary">
                                    <ng-container *ngIf="item.mutavNames?.length">
                                        <img
                                                [pTooltip]="item.mutavNames.join(', ')" fill
                                                ngSrc="/assets/images/beneficiary-row-icon.png"
                                                style="height: auto; width: auto; position: relative;"
                                                tooltipPosition="top"
                                        />
                                    </ng-container>
                                </div>

                                <div class="bank-acc-details-column-2" style="display: flex">
                                    <div
                                            *ngIf="item.targetAsmachta; else singleRowCell"
                                            [pTooltip]="item.paymentDescTranslate"
                                            class="text-ellipsis"
                                            tooltipPosition="top"
                                    >
                                        <div
                                                [innerHTML]="
                        item.paymentDescTranslate
                          | highlight: filterInputUnadjusted.value
                      "
                                        ></div>
                                        <div
                                                [innerHTML]="
                        item.targetAsmachta
                          | highlight: filterInputUnadjusted.value
                      "
                                                style="color: #a7a3a3"
                                        ></div>
                                    </div>
                                    <ng-template #singleRowCell>
                                        <div
                                                [innerHTML]="
                        item.paymentDescTranslate
                          | highlight: filterInputUnadjusted.value
                      "
                                                [pTooltip]="item.paymentDescTranslate"
                                                class="text-ellipsis"
                                                tooltipPosition="top"
                                        ></div>
                                    </ng-template>

                                    <div
                                            [style.visibility]="
                      (item.targetTypeName | isPeriodicType)
                        ? 'visible'
                        : 'hidden'
                    "
                                            class="periodic-trans-indication"
                                    >
                                        <img fill ngSrc="/assets/images/periodic-trans.png"
                                             style="height: auto; width: auto; position: relative;"/>
                                    </div>
                                </div>
                                <div class="bank-acc-details-column-3">
                                    <div>{{ 'sumsTitles.today' | translate }}</div>
                                    <div>
                                        {{
                                        item.targetOriginalDate | todayRelativeHumanize: 'drugged'
                                        }}
                                    </div>
                                </div>
                                <div
                                        class="bank-acc-details-column-4"
                                        style="position: relative"
                                >
                                    <div
                                            [class.sum-credit]="!item.expence"
                                            [class.sum-debit]="item.expence"
                                            class="ltrNum"
                                    >
                                        <app-sum-view
                                                [highlight]="filterInputUnadjusted.value"
                                                [sum]="item.targetOriginalTotal"
                                                class="text-ellipsis"
                                        >
                                        </app-sum-view>
                                    </div>
                                    <div>
                                        <!--<img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/trash.png"-->
                                        <!--style="width: 14px;vertical-align: middle;"/>-->
                                        <i
                                                (click)="openTooltip($event, 235, item.targetId, item)"
                                                [matTooltip]="
                        'appWalk.customers.tazrim.bankmatch.expectedNotHappenedOpActionHandler'
                          | translate
                      "
                                                class="fas fa-ellipsis-v"
                                                matTooltipPosition="before"
                                        ></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div *ngIf="cashflowMatch?.future?.children.length">
                    <div
                            (click)="
              cashflowMatch.future.parent.opened =
                !cashflowMatch.future.parent.opened;
                                                sharedComponent.mixPanelEvent((cashflowMatch.future.parent.opened ? 'open' : 'close') + ' future transes');

            "
                            [class.opened]="cashflowMatch.future.parent.opened"
                            class="bank-acc-details-row titleRow"
                    >
                        <div>
                            <i
                                    [ngClass]="
                  cashflowMatch.future.parent.opened
                    ? 'fa-caret-up'
                    : 'fa-caret-down'
                "
                                    class="fa fa-fw"
                            ></i>
                            {{ 'expressions.futureMovements' | translate }}
                        </div>
                    </div>
                    <div *ngIf="cashflowMatch.future.parent.opened">
                        <div
                                *ngFor="
                let item of cashflowMatch.future.children;
                trackBy: trackById
              "
                        >
                            <div
                                    [class.bank-acc-details-row-selected]="
                  item.checkRow || item?.targetId === tooltipElem?.transId
                "
                                    class="bank-acc-details-row"
                            >
                                <div
                                        class="bank-acc-details-column-1"
                                        style="display: flex; align-items: center"
                                >
                                    <ng-container *ngIf="item.isMatchable; else systemAutoMatch">
                                        <p-checkbox (onChange)="
                        item.checkRow = !item.checkRow; checkChecked(item)
                      "
                                                    [binary]="true"
                                                    [disabled]="item.checkDisabled"
                                                    [ngModel]="item.checkRow"
                                                    checkboxIcon="fa fa-check"
                                        >
                                        </p-checkbox>
                                    </ng-container>

                                    <div
                                            [innerHTML]="
                      item.targetName | highlight: filterInputUnadjusted.value
                    "
                                            [pTooltip]="item.targetName"
                                            class="text-ellipsis"
                                            style="min-width: 0; flex: 1 1 100%; -ms-flex: 1 1 100%"
                                            tooltipPosition="top"
                                    ></div>
                                </div>

                                <div class="bank-acc-details-column-beneficiary">
                                    <ng-container *ngIf="item.mutavNames?.length">
                                        <img
                                                [pTooltip]="item.mutavNames.join(', ')" fill
                                                ngSrc="/assets/images/beneficiary-row-icon.png"
                                                style="height: auto; width: auto; position: relative;"
                                                tooltipPosition="top"
                                        />
                                    </ng-container>
                                </div>

                                <div class="bank-acc-details-column-2" style="display: flex">
                                    <div
                                            *ngIf="item.targetAsmachta; else singleRowCell"
                                            [pTooltip]="item.paymentDescTranslate"
                                            class="text-ellipsis"
                                            tooltipPosition="top"
                                    >
                                        <div
                                                [innerHTML]="
                        item.paymentDescTranslate
                          | highlight: filterInputUnadjusted.value
                      "
                                        ></div>
                                        <div style="color: #a7a3a3">{{ item.targetAsmachta }}</div>
                                    </div>
                                    <ng-template #singleRowCell>
                                        <div
                                                [innerHTML]="
                        item.paymentDescTranslate
                          | highlight: filterInputUnadjusted.value
                      "
                                                [pTooltip]="item.paymentDescTranslate"
                                                class="text-ellipsis"
                                                tooltipPosition="top"
                                        ></div>
                                    </ng-template>
                                    <!--                                    <div class="text-ellipsis"-->
                                    <!--                                         [innerHTML]="item.paymentDescTranslate| highlight: filterInputUnadjusted.value">-->
                                    <!--                                    </div>-->

                                    <div
                                            [style.visibility]="
                      (item.targetTypeName | isPeriodicType)
                        ? 'visible'
                        : 'hidden'
                    "
                                            class="periodic-trans-indication"
                                    >
                                        <img fill ngSrc="/assets/images/periodic-trans.png"
                                             style="height: auto; width: auto; position: relative;"/>
                                    </div>
                                </div>
                                <div class="bank-acc-details-column-3">
                                    <div>
                                        {{ item.transDateFull | date: 'dd/MM/yy' }}
                                        <!--{{item.transDateHumanizedStr}}-->
                                    </div>
                                    <div>
                                        {{ item.transDateFull | todayRelativeHumanize: 'days' }}
                                    </div>
                                </div>
                                <div
                                        class="bank-acc-details-column-4"
                                        style="position: relative"
                                >
                                    <div
                                            [class.sum-credit]="!item.expence"
                                            [class.sum-debit]="item.expence"
                                            class="ltrNum"
                                    >
                                        <app-sum-view
                                                [highlight]="filterInputUnadjusted.value"
                                                [sum]="item.targetOriginalTotal"
                                                class="text-ellipsis"
                                        >
                                        </app-sum-view>
                                    </div>
                                    <div>
                                        <!--<img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/trash.png"-->
                                        <!--style="width: 14px;vertical-align: middle;"/>-->
                                        <i
                                                (click)="openTooltip($event, 235, item.targetId, item)"
                                                class="fas fa-ellipsis-v"
                                        ></i>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>

                <div
                        *ngIf="
            !loaderCash &&
            !cashflowMatch?.nigreret?.children.length &&
            !cashflowMatch?.partialMatch?.children.length &&
            !cashflowMatch?.future?.children.length
          "
                        class="no-rows-found"
                >
                    {{ 'expressions.noDataFoundForCriteria' | translate }},
                    {{ 'expressions.changeCriteria' | translate }}
                </div>
            </div>
        </div>

        <!--<div class="no-rows-found"-->
        <!--*ngIf="!loaderCash && cashflowMatchAll?.length && !cashflowMatch?.nigreret?.children.length && !cashflowMatch?.future?.children.length">-->
        <!--{{'expressions.noDataFoundForCriteria'| translate}}, {{'expressions.changeCriteria'| translate}}-->
        <!--</div>-->

        <div *ngIf="cashflowMatchAll && !cashflowMatchAll?.length" class="notData">
            <ng-container
                    *ngIf="
          banktransForMatchAll && banktransForMatchAll.length;
          else bothTablesEmptyMessage
        "
            >
                <p>
                    ■ כל התנועות הצפויות הותאמו אך מופיעות בבנק תנועות נוספות שלא היו
                    צפויות
                </p>
                <p>
                    ■ אם אחת או יותר מתנועות הבנק שנותרו הן מחזוריות אנא הוסיפו אותן
                    לתזרים
                </p>
                <p>■ בידקו אם קיימות תנועות שמקורן בטעות מצד הבנק</p>
                <p>■ שאר התנועות הן כנראה תנועות חד פעמיות לא צפויות</p>

                <div
                        *ngIf="
            userService?.appData?.userData?.bankMatchAccount?.length > 1 &&
            userService?.appData?.userData?.bankMatchAccountAcc
              ?.companyAccountId !==
              userService?.appData?.userData?.bankMatchAccount[
                userService?.appData?.userData?.bankMatchAccount?.length - 1
              ].companyAccountId
          "
                >
          <span (click)="moveToNextAcc()" class="link">
            מעבר לחשבון הבא >>
          </span>
                </div>
            </ng-container>
            <ng-template #bothTablesEmptyMessage>
                לא קיימות תנועות צפויות שטרם קרו / לא הותאמו
            </ng-template>
        </div>
    </div>

    <!--<div class="toast" *ngIf="hasRowOfChecked && hasRowOfDeleted && !cancelMatch && matchList">-->
    <!--<div>-->
    <!--<span (click)="bankMatch()">-->
    <!--התאמת הפריטים המסומנים-->
    <!--</span>-->
    <!--</div>-->
    <!--<div>-->
    <!--<span (click)="cancelMatch = true">-->
    <!--ביטול-->
    <!--</span>-->
    <!--</div>-->
    <!--</div>-->
    <p-dialog
        #matchApprovePrompt
        (visibleChange)="cancelMatch = true"
        *ngIf="hasRowOfChecked && hasRowOfDeleted && !cancelMatch && matchList"
        [closable]="false"
        [modal]="false"
        [resizable]="false"
        [styleClass]="'match-list-prompt'"
        [style]="{'margin-top':'76px'}"
        [visible]="true"
        appendTo="body"
        position="top"
    >
        <p-header>
            <img fill ngSrc="/assets/images/matching-big.png" style="height: auto; width: auto; position: relative;"/>
        </p-header>
        <!--{{matchList.selectedUniqueBeneficiaryKeys| json}}-->
        <p *ngIf="matchList.selectedTransTypeIds.size > 1">
            {{ 'expressions.variantCategoriesSelected' | translate }}
        </p>
        <!--        <ng-container *ngIf="matchList.selectedUniqueBeneficiaryKeys.size < 2; else variantBeneficiariesSelected">-->
        <!--            <p *ngIf="matchList.selectedTransTypeIds.size > 1">-->
        <!--                {{'expressions.variantCategoriesSelected'| translate}}-->
        <!--            </p>-->
        <!--        </ng-container>-->
        <!--        <ng-template #variantBeneficiariesSelected>-->
        <!--            <p id="variantBeneficiariesSelected">-->
        <!--                {{'expressions.variantBeneficiariesSelected'| translate}}<br/>-->
        <!--                <small><i class="fa fa-fw fa-info-circle"></i>{{'expressions.editTransactionProposal'| translate}}-->
        <!--                </small>-->
        <!--            </p>-->
        <!--        </ng-template>-->
        <!--{{matchList| json}}-->
        <!--        {{matchApprovePromptLastPosition| json}}-->
        <p-footer>
            <a
                    (click)="cancelMatch = true"
                    class="button-white button-link"
                    href="javascript:void(0)"
                    role="button"
            >
                {{ 'actions.cancellation' | translate }}
            </a>
            <button (click)="bankMatch()" class="button-dark" type="button">
                <!--{{matchList.array.length}}-->
                {{
                'expressions.matchMarkedTransactionsPtrn'
                    | translate: {length: matchList.selectedCount}
                }}
            </button>
            <!--            <ng-container *ngIf="matchList.selectedUniqueBeneficiaryKeys.size < 2">-->
            <!--                <button class="button-dark" type="button" (click)="bankMatch()">-->
            <!--                    &lt;!&ndash;{{matchList.array.length}}&ndash;&gt;-->
            <!--                    {{'expressions.matchMarkedTransactionsPtrn'| translate: ({length: matchList.selectedCount})}}-->
            <!--                </button>-->
            <!--            </ng-container>-->
        </p-footer>
    </p-dialog>

    <p-dialog (onHide)="showModalAutoMatch = false"
              (visibleChange)="showModalAutoMatch = false"

              [modal]="true"
              [resizable]="false"
              [visible]="(showModalAutoMatch)"
              appendTo="body"
              styleClass="modalEditCardsBeforeSend"
    >
        <p-header>
            <h1>התאמה אוטומטית</h1>
        </p-header>

        <p style="text-align: right">
            האם ברצונך להתאים את {{ modalAutoMatch?.transDescAzonly }}
            <br/>
            לתנועה הקבועה {{ modalAutoMatch?.targetName }} עבור -
        </p>

        <ul *ngIf="matchList && matchList.array && matchList.array.length">
            <li>
                <p-radioButton
                        [(ngModel)]="matchList.array[0].searchkeyUpdate"
                        [inputId]="'setFieldValueForFuture1'"
                        [label]="'תנועה זו בלבד'"
                        [value]="false"
                        name="changeOption"
                ></p-radioButton>
            </li>
            <li>
                <p-radioButton
                        [(ngModel)]="matchList.array[0].searchkeyUpdate"
                        [inputId]="'setFieldValueForFuture2'"
                        [label]="'תנועות עתיד (מהיום קדימה)'"
                        [value]="true"
                        name="changeOption"
                ></p-radioButton>
            </li>
        </ul>
        <p-footer>
            <button (click)="showModalAutoMatch = false" class="button-link">
                {{ 'actions.cancellation' | translate }}
            </button>
            <button (click)="showToastBeforeSendRun()" class="button-dark">
                {{ 'actions.approve' | translate }}
            </button>
        </p-footer>
    </p-dialog>

    <p-dialog (visibleChange)="cashflowMatchPopup = false"
              *ngIf="cashflowMatchPopup"

              [draggable]="false"
              [modal]="false"
              [resizable]="false"
              [style]="{width: 480 + 'px',height: 300 + 'px'}"
              [visible]="(cashflowMatchPopup)"
              appendTo="body"
              styleClass="cashflowMatchPopup"
    >
        <p-header>
            <div class="transDescAzonly">
                תנועת הבנק:
                {{ cashflowMatchPopup?.banktransRow?.transDescAzonly }} בסכום
                <span>{{ cashflowMatchPopup?.banktransRow?.total }}</span>
            </div>
            <div class="secondTitle">
                תותאם לתנועות שנבחרו ע”פ הסכום שהיה בתזרים. ניתן לשנות את הסכומים לפני
                ההתאמה
            </div>
        </p-header>

        <form [formGroup]="cashflowMatchPopup.table">
            <div class="tableSplit">
                <div class="header">
                    <div>תיאור התנועה</div>
                    <div>{{ 'titles.typeOfPayment' | translate }}</div>
                    <div>{{ 'titles.sum' | translate }}</div>
                    <div
                            *ngIf="scrollContainerInsideHasScroll"
                            style="
              flex: 0 0 0.8em;
              -ms-flex: 0 0 0.8em;
              padding: 0;
              margin-left: 0;
            "
                    >
                        &nbsp;
                    </div>
                </div>

                <ul
                    #scrollContainerInside
                    class="scroll-chrome table"
                    formArrayName="arr"
                >
                    <li
                            *ngFor="let item of arr.controls; let i = index"
                            [formGroupName]="i"
                    >
                        <div>{{ item.value.targetName }}</div>
                        <div style="overflow: visible; display: flex; flex-direction: row">
                            {{ item.value.paymentDescTranslate }}

                            <div
                                    [style.visibility]="
                  item.value.isPeriodicType ? 'visible' : 'hidden'
                "
                                    class="periodic-trans-indication"
                            >
                                <img src="/assets/images/periodic-trans.png"/>
                            </div>
                        </div>
                        <div
                                [class.validation-error]="
                arr.controls[i].get('userMatchTotal').dirty &&
                arr.controls[i].get('userMatchTotal').invalid
              "
                        >
                            <input
                                #totalFields
                                (keyup)="calcSumTotals()"
                                appNumbersOnly="numWithTwoDec"
                                formControlName="userMatchTotal"
                                required
                                type="text"
                            />
                        </div>
                    </li>
                </ul>
            </div>
        </form>

        <p-footer>
            <div
                    style="
          width: 100%;
          display: flex;
          display: -ms-flexbox;
          justify-content: flex-end;
        "
            >
                <div
                        *ngIf="
            cashflowMatchPopup?.sumTotals >
            cashflowMatchPopup?.banktransRow?.total
          "
                        class="alertSumRed"
                >
                    שימו לב, הסכום הכולל גבוה ב{{
                    cashflowMatchPopup?.sumTotals -
                    cashflowMatchPopup?.banktransRow?.total | sum
                    }}
                    <ng-container
                            *ngIf="cashflowMatchPopup.banktransRow.account.currency === 'ILS'"
                    >ש"ח
                    </ng-container
                    >
                    <br/>
                    מהסכום בבנק
                </div>
                <button
                        (click)="cashflowMatchPopup = false"
                        class="button-white button-link"
                >
                    {{ 'actions.cancellation' | translate }}
                </button>
                <button (click)="bankMatchSubmit()" class="button-dark" type="submit">
                    התאמת {{ arr.controls.length }} התנועות
                </button>
            </div>
        </p-footer>
    </p-dialog>

    <!--<div class="toast" *ngIf="showToastBeforeSend && matchList">-->
    <!--<div class="toastFlex">-->
    <!--<img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/check.png" alt="v" width="18" height="15">-->

    <!--{{matchList.array.length}}-->

    <!--<i *ngIf="matchList.array.length > 1">-->
    <!--תנועות הותאמו-->
    <!--</i>-->
    <!--<i *ngIf="matchList.array.length === 1">-->
    <!--תנועה הותאמה-->
    <!--</i>-->
    <!--</div>-->
    <!--<div>-->
    <!--<span (click)="showToastBeforeSend = false">-->
    <!--שיחזור-->
    <!--</span>-->
    <!--</div>-->
    <!--</div>-->
    <p-dialog
            (visibleChange)="showToastBeforeSend = false"
            *ngIf="showToastBeforeSend && matchList"
            [closable]="false"
            [modal]="false"
            [resizable]="false"
            [styleClass]="'match-list-prompt'"
            [style]="{'margin-top':'96px'}"
            [visible]="true"
            appendTo="body"
            position="top"
    >
        <p-header>
            <img fill ngSrc="/assets/images/matching-big.png" style="height: auto; width: auto; position: relative;"/>
        </p-header>
        <!--{{matchList| json}}-->
        <p-footer>
            <div>
                <!--{{matchList.array.length}}-->
                <img alt="v" fill ngSrc="/assets/images/check.png"
                     style="height: auto; width: auto; position: relative;"/>&nbsp;{{
                'expressions.transactionsMatchedSuccessfully' | translate
                }}
            </div>

            <a
                    (click)="showToastBeforeSend = false"
                    class="button-white button-link"
                    href="javascript:void(0)"
                    role="button"
            >
                {{ 'actions.restore' | translate }}
            </a>
        </p-footer>
    </p-dialog>

    <!--<img style="height: auto; width: auto; position: relative;" fill ngSrc="/assets/images/replace.png" alt="replace" id="replace"-->
    <!--[pTooltip]="'החלפת טבלאות'" [escape]="false" tooltipPosition="bottom" (click)="replace()">-->
</div>

<div
        *ngIf="tooltipElem"
        [ngClass]="{
    'arrow-up': tooltipElem.arrow === 'up',
    'arrow-bottom': tooltipElem.arrow === 'bottom'
  }"
        [style.height.px]="
    tooltipElem.height -
    (tooltipElem.height === 235 && tooltipElem.hidePostponeAction === true
      ? 72
      : 0)
  "
        [style.left.px]="tooltipElem.x"
        [style.top.px]="tooltipElem.y"
        class="tooltipElem"
>
    <div *ngIf="tooltipElem.height !== 235" class="content">
        <!--    <div *ngIf="tooltipElem.height === 162" class="content">-->
        <p>אין צורך בהתאמה?</p>
        <button
                (click)="openPopBankMatchDelete(tooltipElem.itemFull)"
                class="button-dark"
        >
            מחיקה מהרשימה
        </button>
        <p>תנועה קבועה?</p>
        <button
                (click)="createFromRecommendationData.visible = true"
                class="button-dark"
        >
            הוספה לתזרים
        </button>
    </div>
    <div *ngIf="tooltipElem.height === 235" class="content">
        <p *ngIf="!tooltipElem?.hidePostponeAction">צפויה לקרות בקרוב?</p>
        <button
                (click)="postponePrompt.visible = true"
                *ngIf="!tooltipElem?.hidePostponeAction"
                class="button-dark"
        >
            כן, לדחות
        </button>
        <p>לא צפויה לקרות/קרתה?</p>
        <!--<button class="button-dark" (click)="deleteConfirmationPrompt.visible = true;">-->
        <button
                (click)="rolloutDeleteOperationConfirmPrompt(tooltipElem.itemFull)"
                class="button-dark"
        >
            למחוק מהתזרים
        </button>
        <p>הפרטים לא מדוייקים?</p>
        <button (click)="editMovementShow()" class="button-dark">
            עריכת תנועה
        </button>
    </div>
    <div class="arrow"></div>
</div>

<p-dialog (onHide)="popUpDeleteMatch = false"
          (visibleChange)="popUpDeleteMatch = false"
          *ngIf="popUpDeleteMatch"

          [modal]="true"
          [styleClass]="popUpDeleteMatch.styleClass"
          [style]="{width: popUpDeleteMatch.width + 'px',height: popUpDeleteMatch.height + 'px'}"
          [visible]="(popUpDeleteMatch)"

          appendTo="body"
>
    <p-header>
        <div>
            {{
            popUpDeleteMatch.lenOfChecked === 1 || popUpDeleteMatch.isItemDirect
                ? 'מחיקת פעולה'
                : 'מחיקת פעולות'
            }}
        </div>
    </p-header>
    <div class="bodyPopUp">
        <p>
            <ng-container
                    *ngIf="
          popUpDeleteMatch.lenOfChecked === 1 || popUpDeleteMatch.isItemDirect;
          else multi
        "
            >
                התנועה
                <strong>"{{ popUpDeleteMatch.desc }}"</strong>
                תימחק מהרשימה.<br/>
                האם להמשיך? המחיקה לא תשפיע על תנועת הבנק בפועל
            </ng-container>
        </p>
        <ng-template #multi>
            התנועות שנבחרו ימחקו מהרשימה.<br/>
            האם להמשיך? המחיקה לא תשפיע על תנועת הבנק בפועל
            <!--התנועות הנבחרות יוסרו מרשימת תנועות בנק שלא צפיתי/הותאמו.-->
        </ng-template>
    </div>
    <p-footer>
        <a
                (click)="popUpDeleteMatch = false"
                class="button-white button-link"
                href="javascript:void(0)"
                role="button"
        >
            {{ 'actions.cancellation' | translate }}
        </a>

        <button (click)="bankMatchDelete()" class="button-dark" type="button">
            {{ 'actions.remove' | translate }}
        </button>
    </p-footer>
</p-dialog>

<p-dialog (onHide)="userService.appData.popUpShow = false"
          (visibleChange)="userService.appData.popUpShow = false"
          *ngIf="userService.appData.popUpShow"
          [modal]="true"
          [styleClass]="userService.appData.popUpShow.styleClass"
          [style]="{width: userService.appData.popUpShow.width + 'px',height: userService.appData.popUpShow.height + 'px'}"
          [visible]="(userService.appData.popUpShow)"

          appendTo="body"
>
    <p-header *ngIf="userService.appData.popUpShow.header">
        <div>מחיקת תנועות שלא הותאמו</div>
    </p-header>
    <div *ngIf="userService.appData.popUpShow.body" class="bodyPopUp">
        שימו לב: המערכת תמחוק תנועות צפויות
        <br/>
        שלא הותאמו, עד לפני
        <input
                [(ngModel)]="userService.appData.popUpShow.daysToDelete"
                [class.err]="
        userService.appData.popUpShow.daysToDelete === '' ||
        userService.appData.popUpShow.daysToDelete < 0
      "
                appNumbersOnly="positiveInt"
                type="text"
        />
        ימים
        <br/>
        האם להמשיך?
    </div>
    <p-footer *ngIf="userService.appData.popUpShow.footer">
        <a
                (click)="userService.appData.popUpShow = false"
                class="button-white button-link"
                href="javascript:void(0)"
                role="button"
        >
            לא, ביטול
        </a>

        <button
                (click)="bankMatchRestart($event)"
                class="button-dark"
                type="button"
        >
            כן, מחיקת תנועות
        </button>
    </p-footer>
</p-dialog>

<p-dialog
        (visibleChange)="createFromRecommendationData.visible = $event"
        [modal]="true"
        [styleClass]="'fixed-movement-edit'"
        [visible]="(createFromRecommendationData?.visible)"
        appendTo="body"
>
    <p-header>{{ createFromRecommendationData?.title }}</p-header>
    <ng-container *ngIf="createFromRecommendationData?.visible">
        <form
                (ngSubmit)="onSubmitCreateFromRecommendation()"
                *ngIf="createFromRecommendationData"
                [formGroup]="createFromRecommendationData?.form"
                novalidate
        >
            <app-fixed-movement-settings
                #createFromRecommendationEditor
                [companyId]="userService.appData?.userData?.companySelect?.companyId"
                [companyTransTypes]="companyTransTypes"
                [form]="createFromRecommendationData.form"
                [source]="createFromRecommendationData.source"
            >
            </app-fixed-movement-settings>
            <button
                    [disabled]="createFromRecommendationData.form.invalid"
                    style="display: none"
                    type="submit"
            ></button>
            <!--{{createFromRecommendationData.form.valid}}-->
        </form>
    </ng-container>
    <p-footer>
        <div
                *ngIf="createFromRecommendationData"
                style="width: 100%; display: flex; justify-content: center"
        >
            <a
                    (click)="createFromRecommendationData.visible = false"
                    class="button-white button-link"
                    href="#"
                    role="button"
            >
                {{ 'actions.cancellation' | translate }}
            </a>
            <button
                    (click)="onSubmitCreateFromRecommendation()"
                    [disabled]="createFromRecommendationData.loading"
                    class="button-dark"
            >
                <i
                        *ngIf="createFromRecommendationData.loading"
                        class="fas fa-fw fa-circle-notch fa-spin"
                ></i>
                {{ createFromRecommendationData.title }}
            </button>
        </div>
    </p-footer>
</p-dialog>

<p-dialog
        (visibleChange)="deleteConfirmationPrompt.visible = $event"

        [modal]="true"
        [style]="{width: 300 + 'px'}"
        [visible]="(deleteConfirmationPrompt?.visible)"
        appendTo="body"
        styleClass="deleteMovementDialog"
>
    <p-header>{{ deleteConfirmationPrompt?.title }}</p-header>

    <div
            [innerHTML]="
      'actions.deleteMovement.body.' +
        deleteConfirmationPrompt?.type +
        '.content' | translate: deleteConfirmationPrompt
    "
            class="mat-h3"
    >
        <!--{{('actions.deleteMovement.body.' + deleteConfirmationPrompt?.type + '.content')| translate: deleteConfirmationPrompt}}-->
    </div>
    <ul *ngIf="deleteConfirmationPrompt?.options as options">
        <li *ngFor="let opt of options; index as i">
            <p-radioButton
                    [(ngModel)]="deleteConfirmationPrompt.optionSelected"
                    [inputId]="'deleteOption' + i"
                    [label]="opt.label"
                    [value]="opt.value"
                    name="deleteOption"
            ></p-radioButton>
            <!--<p-checkbox checkboxIcon="fa fa-check" name="deleteOption" [label]="opt.label" [(ngModel)]="opt.value" [inputId]="'deleteOption'+ i"-->
            <!--[binary]="true"></p-checkbox>-->
            <!--{{opt}}-->
        </li>
    </ul>

    <p-footer>
        <div style="width: 100%; display: flex; justify-content: center">
            <button
                    (click)="deleteConfirmationPrompt.visible = false"
                    class="button-white button-link"
            >
                {{ 'actions.cancellation' | translate }}
            </button>
            <button
                    (click)="deleteConfirmationPrompt.onApprove()"
                    [disabled]="deleteConfirmationPrompt?.processing"
                    class="button-dark"
            >
                <i
                        *ngIf="deleteConfirmationPrompt?.processing"
                        class="fas fa-fw fa-circle-notch fa-spin"
                ></i>
                {{ 'actions.remove' | translate }}
            </button>
        </div>
    </p-footer>
</p-dialog>

<p-dialog
    #editMovementDataDlg

    (visibleChange)="editMovementData.visible = $event"
    [modal]="true"
    [resizable]="false"
    [styleClass]="'fixed-movement-edit'"
    [visible]="(editMovementData?.visible)"

    appendTo="body"
>
    <p-header>{{ editMovementData?.title }}</p-header>
    <form
            (ngSubmit)="onSubmitEditMovement()"
            *ngIf="editMovementData"
            [formGroup]="editMovementData?.form"
            novalidate
    >
        <app-fixed-movement-settings
            #editMovementEditor
            [companyId]="userService.appData?.userData?.companySelect?.companyId"
            [companyTransTypes]="companyTransTypes"
            [form]="editMovementData.form"
            [seriesSource]="editMovementData.seriesSource"
            [source]="editMovementData.source"
        >
        </app-fixed-movement-settings>
        <button
                [disabled]="editMovementData.form.invalid"
                style="display: none"
                type="submit"
        ></button>
        <!--{{createFromRecommendationData.form.valid}}-->
    </form>
    <p-footer>
        <div
                *ngIf="editMovementData"
                style="width: 100%; display: flex; justify-content: center"
        >
            <a
                    (click)="editMovementData.visible = false"
                    class="button-white button-link"
                    href="javascript:void(0)"
                    role="button"
            >
                {{ 'actions.cancellation' | translate }}
            </a>
            <button
                    (click)="onSubmitEditMovement()"
                    [disabled]="editMovementData.loading"
                    class="button-dark"
            >
                <i
                        *ngIf="editMovementData.loading"
                        class="fas fa-fw fa-circle-notch fa-spin"
                ></i>
                {{ 'actions.saveAndClose' | translate }}
            </button>
        </div>
    </p-footer>
</p-dialog>

<p-dialog (visibleChange)="postponePrompt.visible = false"
          [modal]="true"
          [resizable]="false"
          [visible]="(postponePrompt.visible)"
          appendTo="body"

          styleClass="postponeMovementDialog"
>
    <p-header>{{ 'דחיית תנועה צפוייה' }}</p-header>

    <div style="display: flex; justify-content: space-between">
        <button
                (click)="postponePrompt.onDateShortcutClick('nextWeek')"
                class="button-white button-link"
        >
            {{ 'לשבוע הבא' }}
        </button>
        <button
                (click)="postponePrompt.onDateShortcutClick('inTwoWeeks')"
                class="button-white button-link"
        >
            {{ 'לעוד שבועיים' }}
        </button>
        <button
                (click)="postponePrompt.onDateShortcutClick('nextMonth')"
                class="button-white button-link"
        >
            {{ 'לחודש הבא' }}
        </button>
    </div>

    <p-calendar
            [(ngModel)]="postponePrompt.selectedDate"
            [disabledDays]="[6]"
            [inline]="true"
            [locale]="'langCalendar' | translate"
            [minDate]="postponePrompt?.minDate"
            [showOtherMonths]="false"
            [style]="{ 'min-width': '320px' }"
    ></p-calendar>

    <p-footer>
        <div style="width: 100%; display: flex; justify-content: center">
            <button
                    (click)="postponePrompt.visible = false"
                    class="button-white button-link"
            >
                {{ 'actions.cancellation' | translate }}
            </button>
            <button
                    (click)="postponePrompt.onApprove()"
                    [disabled]="postponePrompt?.processing"
                    class="button-dark"
            >
                <i
                        *ngIf="postponePrompt?.processing"
                        class="fas fa-fw fa-circle-notch fa-spin"
                ></i>
                {{ 'actions.approve' | translate }}
            </button>
        </div>
    </p-footer>
</p-dialog>

<ng-template #systemAutoMatch>
    <img
            [escape]="false"
            [pTooltip]="systemAutoMatchTooltip"
            src="/assets/images/fb-logo-bizibox-32-32.png"
            style="height: auto; width: 16px; position: relative; margin: 0 !important"
            tooltipPosition="bottom"
    />
</ng-template>
